<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>SpringBootæ•´åˆJWTå®ç°å‰åç«¯TokenéªŒè¯</title>
    <url>/posts/5cd97de5.html</url>
    <content><![CDATA[<h2 id="ä¸€ã€JWTä»‹ç»">ä¸€ã€JWTä»‹ç»</h2>
<h3 id="1ã€JWTç®€ä»‹">1ã€JWTç®€ä»‹</h3>
<blockquote>
<p>Json web token (JWT), æ˜¯ä¸ºäº†åœ¨ç½‘ç»œåº”ç”¨ç¯å¢ƒé—´ä¼ é€’å£°æ˜è€Œæ‰§è¡Œçš„ä¸€ç§åŸºäºJSONçš„å¼€æ”¾æ ‡å‡†ï¼ˆ<a href="https://link.jianshu.com?t=https://tools.ietf.org/html/rfc7519" target="_blank" rel="noopener">(RFC 7519</a>).è¯¥tokenè¢«è®¾è®¡ä¸ºç´§å‡‘ä¸”å®‰å…¨çš„ï¼Œç‰¹åˆ«é€‚ç”¨äºåˆ†å¸ƒå¼ç«™ç‚¹çš„å•ç‚¹ç™»å½•ï¼ˆSSOï¼‰åœºæ™¯ã€‚JWTçš„å£°æ˜ä¸€èˆ¬è¢«ç”¨æ¥åœ¨èº«ä»½æä¾›è€…å’ŒæœåŠ¡æä¾›è€…é—´ä¼ é€’è¢«è®¤è¯çš„ç”¨æˆ·èº«ä»½ä¿¡æ¯ï¼Œä»¥ä¾¿äºä»èµ„æºæœåŠ¡å™¨è·å–èµ„æºï¼Œä¹Ÿå¯ä»¥å¢åŠ ä¸€äº›é¢å¤–çš„å…¶å®ƒä¸šåŠ¡é€»è¾‘æ‰€å¿…é¡»çš„å£°æ˜ä¿¡æ¯ï¼Œè¯¥tokenä¹Ÿå¯ç›´æ¥è¢«ç”¨äºè®¤è¯ï¼Œä¹Ÿå¯è¢«åŠ å¯†ã€‚</p>
<p>å®˜ç½‘ï¼š<a href="https://jwt.io/introduction/" target="_blank" rel="noopener">https://jwt.io/introduction/</a></p>
</blockquote>
<a id="more"></a>
<h3 id="2ã€JWTè®¤è¯å’Œsessionè®¤è¯çš„åŒºåˆ«">2ã€JWTè®¤è¯å’Œsessionè®¤è¯çš„åŒºåˆ«</h3>
<h4 id="sessionè®¤è¯">sessionè®¤è¯</h4>
<p>httpåè®®æ˜¯ä¸€ç§æ— çŠ¶æ€çš„åè®®ï¼Œè€Œè¿™å°±æ„å‘³ç€å¦‚æœç”¨æˆ·å‘æˆ‘ä»¬çš„åº”ç”¨æä¾›äº†ç”¨æˆ·åå’Œå¯†ç æ¥è¿›è¡Œç”¨æˆ·è®¤è¯ï¼Œé‚£ä¹ˆä¸‹ä¸€æ¬¡è¯·æ±‚æ—¶ï¼Œç”¨æˆ·è¿˜è¦å†ä¸€æ¬¡è¿›è¡Œç”¨æˆ·è®¤è¯æ‰è¡Œï¼Œå› ä¸ºæ ¹æ®httpåè®®ï¼Œæˆ‘ä»¬å¹¶ä¸èƒ½çŸ¥é“æ˜¯å“ªä¸ªç”¨æˆ·å‘é€çš„è¯·æ±‚ï¼Œæ‰€ä»¥ä¸ºäº†è®©æˆ‘ä»¬çš„åº”ç”¨èƒ½è¯†åˆ«æ˜¯å“ªä¸ªç”¨æˆ·å‘å‡ºçš„ï¼Œæˆ‘ä»¬åªèƒ½åœ¨æœåŠ¡å™¨å­˜å‚¨ä¸€ä»½ç”¨æˆ·ç™»é™†çš„ä¿¡æ¯ï¼Œè¿™ä»½ç™»é™†ä¿¡æ¯ä¼šåœ¨å“åº”æ—¶ä¼ é€’ç»™æµè§ˆå™¨ï¼Œå‘Šè¯‰å…¶ä¿å­˜ä¸ºcookieï¼Œä»¥ä¾¿ä¸‹æ¬¡è¯·æ±‚æ—¶å‘é€ç»™æˆ‘ä»¬çš„åº”ç”¨ï¼Œè¿™æ ·æˆ‘ä»¬çš„åº”ç”¨ä¸ªå°±èƒ½è¯†åˆ«è¯·æ±‚æ¥è‡ªå“ªä¸ªç”¨æˆ·äº†ï¼Œè¿™å°±æ˜¯ä¼ ç»Ÿçš„åŸºäºsessinoè®¤è¯ã€‚</p>
<h4 id="JWTè®¤è¯">JWTè®¤è¯</h4>
<p>åŸºäºtokençš„é‰´æƒæœºåˆ¶ç±»ä¼¼äºhttpåè®®ä¹Ÿæ˜¯æ— çŠ¶æ€çš„ï¼Œå®ƒä¸éœ€è¦åœ¨æœåŠ¡ç«¯å»ä¿ç•™ç”¨æˆ·çš„è®¤è¯ä¿¡æ¯æˆ–ä¼šè¯ä¿¡æ¯ã€‚è¿™ä¹Ÿå°±æ„å‘³ç€JWTè®¤è¯æœºåˆ¶çš„åº”ç”¨ä¸éœ€è¦å»è€ƒè™‘ç”¨æˆ·åœ¨å“ªä¸€å°æœåŠ¡å™¨ç™»å½•äº†ï¼Œè¿™å°±ä¸ºåº”ç”¨çš„æ‰©å±•æä¾›äº†ä¾¿åˆ©ã€‚</p>
<h3 id="3ã€JWTè®¤è¯è¿‡ç¨‹">3ã€JWTè®¤è¯è¿‡ç¨‹</h3>
<p><img src="https://img-blog.csdnimg.cn/20210127183348127.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xlbW9uX1RU,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<ol>
<li>ç”¨æˆ·ä½¿ç”¨è´¦å·å’Œå¯†ç å‘å‡ºpostè¯·æ±‚ï¼›</li>
<li>æœåŠ¡å™¨ä½¿ç”¨ç§é’¥åˆ›å»ºä¸€ä¸ªjwtï¼›</li>
<li>æœåŠ¡å™¨è¿”å›è¿™ä¸ªjwtç»™æµè§ˆå™¨ï¼›</li>
<li>æµè§ˆå™¨å°†è¯¥jwtä¸²åœ¨è¯·æ±‚å¤´ä¸­åƒæœåŠ¡å™¨å‘é€è¯·æ±‚ï¼›</li>
<li>æœåŠ¡å™¨éªŒè¯è¯¥jwtï¼›</li>
<li>è¿”å›å“åº”çš„èµ„æºç»™æµè§ˆå™¨</li>
</ol>
<h3 id="4ã€JWTç»“æ„">4ã€JWTç»“æ„</h3>
<p>JWTæ˜¯ç”±ä¸‰æ®µä¿¡æ¯æ„æˆçš„ï¼Œå°†è¿™ä¸‰æ®µä¿¡æ¯æ–‡æœ¬ç”¨<code>.</code>è¿æ¥ä¸€èµ·å°±æ„æˆäº†JWTå­—ç¬¦ä¸²ã€‚å°±åƒè¿™æ ·:<code>xxxxx.yyyyy.zzzzz</code>ã€‚JWTåŒ…å«äº†ä¸‰éƒ¨åˆ†ï¼š<br>
<strong>Header</strong> å¤´éƒ¨(æ ‡é¢˜åŒ…å«äº†ä»¤ç‰Œçš„å…ƒæ•°æ®ï¼Œå¹¶ä¸”åŒ…å«ç­¾åå’Œ/æˆ–åŠ å¯†ç®—æ³•çš„ç±»å‹)<br>
<strong>Payload</strong> è´Ÿè½½ (ç±»ä¼¼äºé£æœºä¸Šæ‰¿è½½çš„ç‰©å“)<br>
<strong>Signature</strong> ç­¾å/ç­¾è¯</p>
<h2 id="äºŒã€springbootå’ŒJWTæ•´åˆ">äºŒã€springbootå’ŒJWTæ•´åˆ</h2>
<p><strong>åœ¨<code>pom.xml</code>ä¸­æ·»åŠ ä¾èµ–</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.auth0<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>java-jwt<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="comment">&lt;!--æ³¨æ„ç‰ˆæœ¬--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.4.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>åˆ›å»º<code>annotation</code>è‡ªå®šä¹‰æ³¨è§£åŒ…ï¼Œåœ¨åŒ…ä¸‹åˆ›å»º<code>PassToken</code>å’Œ<code>UserLoginToken</code>ä¸¤ä¸ªæ³¨è§£</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//æ–¹æ³•ä¸Šæœ‰è¯¥æ³¨è§£å°±æ”¾è¡Œ</span></span><br><span class="line"><span class="meta">@Target</span>(&#123;ElementType.METHOD, ElementType.TYPE&#125;)</span><br><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> PassToken &#123;</span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">required</span><span class="params">()</span> <span class="keyword">default</span> <span class="keyword">true</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//è¡¨ç¤ºéœ€è¦tokenéªŒè¯</span></span><br><span class="line"><span class="meta">@Target</span>(&#123;ElementType.METHOD, ElementType.TYPE&#125;)</span><br><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> UserLoginToken &#123;</span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">required</span><span class="params">()</span> <span class="keyword">default</span> <span class="keyword">true</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>é…ç½®æ‹¦æˆªå™¨ï¼Œå®ç°ä¸€ä¸ªæ‹¦æˆªå™¨å°±éœ€è¦å®ç°<code>HandlerInterceptor</code>æ¥å£</strong></p>
<p><code>HandlerInterceptor</code>æ¥å£ä¸»è¦å®šä¹‰äº†ä¸‰ä¸ªæ–¹æ³•<br>
<strong>1.<code>boolean preHandle ()</code>ï¼š</strong><br>
é¢„å¤„ç†å›è°ƒæ–¹æ³•,å®ç°å¤„ç†å™¨çš„é¢„å¤„ç†ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°ä¸ºå“åº”çš„å¤„ç†å™¨,è‡ªå®šä¹‰<code>Controller</code>,è¿”å›å€¼ä¸º<code>true</code>è¡¨ç¤ºç»§ç»­æµç¨‹ï¼ˆå¦‚è°ƒç”¨ä¸‹ä¸€ä¸ªæ‹¦æˆªå™¨æˆ–å¤„ç†å™¨ï¼‰æˆ–è€…æ¥ç€æ‰§è¡Œ<br>
<code>postHandle()</code>å’Œ<code>afterCompletion()</code>ï¼›<code>false</code>è¡¨ç¤ºæµç¨‹ä¸­æ–­ï¼Œä¸ä¼šç»§ç»­è°ƒç”¨å…¶ä»–çš„æ‹¦æˆªå™¨æˆ–å¤„ç†å™¨ï¼Œä¸­æ–­æ‰§è¡Œã€‚</p>
<p><strong>2.<code>void postHandle()</code>ï¼š</strong><br>
åå¤„ç†å›è°ƒæ–¹æ³•ï¼Œå®ç°å¤„ç†å™¨çš„åå¤„ç†ï¼ˆ<code>DispatcherServlet</code>è¿›è¡Œè§†å›¾è¿”å›æ¸²æŸ“ä¹‹å‰è¿›è¡Œè°ƒç”¨ï¼‰ï¼Œæ­¤æ—¶æˆ‘ä»¬å¯ä»¥é€šè¿‡<code>modelAndView</code>ï¼ˆæ¨¡å‹å’Œè§†å›¾å¯¹è±¡ï¼‰å¯¹æ¨¡å‹æ•°æ®è¿›è¡Œå¤„ç†æˆ–å¯¹è§†å›¾è¿›è¡Œå¤„ç†ï¼Œ<code>modelAndView</code>ä¹Ÿå¯èƒ½ä¸º<code>null</code>ã€‚</p>
<p><strong>3.<code>void afterCompletion()</code>:</strong><br>
æ•´ä¸ªè¯·æ±‚å¤„ç†å®Œæ¯•å›è°ƒæ–¹æ³•,è¯¥æ–¹æ³•ä¹Ÿæ˜¯éœ€è¦å½“å‰å¯¹åº”çš„<code>Interceptor</code>çš„<code>preHandle()</code>çš„è¿”å›å€¼ä¸ºtrueæ—¶æ‰ä¼šæ‰§è¡Œï¼Œä¹Ÿå°±æ˜¯åœ¨<code>DispatcherServlet</code>æ¸²æŸ“äº†å¯¹åº”çš„è§†å›¾ä¹‹åæ‰§è¡Œã€‚ç”¨äºè¿›è¡Œèµ„æºæ¸…ç†ã€‚æ•´ä¸ªè¯·æ±‚å¤„ç†å®Œæ¯•å›è°ƒæ–¹æ³•ã€‚å¦‚æ€§èƒ½ç›‘æ§ä¸­æˆ‘ä»¬å¯ä»¥åœ¨æ­¤è®°å½•ç»“æŸæ—¶é—´å¹¶è¾“å‡ºæ¶ˆè€—æ—¶é—´ï¼Œè¿˜å¯ä»¥è¿›è¡Œä¸€äº›èµ„æºæ¸…ç†ï¼Œç±»ä¼¼äº<code>try-catch-finally</code>ä¸­çš„<code>finally</code>ï¼Œä½†ä»…è°ƒç”¨å¤„ç†å™¨æ‰§è¡Œé“¾ä¸­</p>
<p><strong>ä»£ç ä¸»è¦æµç¨‹:</strong></p>
<p><strong>1.ä» <code>http</code> è¯·æ±‚å¤´ä¸­å–å‡º <code>token</code>ï¼Œ<br>
2.åˆ¤æ–­æ˜¯å¦æ˜ å°„åˆ°æ–¹æ³•<br>
3.æ£€æŸ¥æ˜¯å¦æœ‰<code>passtoken</code>æ³¨é‡Šï¼Œæœ‰åˆ™è·³è¿‡è®¤è¯<br>
4.æ£€æŸ¥æœ‰æ²¡æœ‰éœ€è¦ç”¨æˆ·ç™»å½•çš„æ³¨è§£ï¼Œæœ‰åˆ™éœ€è¦å–å‡ºå¹¶éªŒè¯<br>
5.è®¤è¯é€šè¿‡åˆ™å¯ä»¥è®¿é—®ï¼Œä¸é€šè¿‡ä¼šæŠ¥ç›¸å…³é”™è¯¯ä¿¡æ¯</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyInterceptor</span> <span class="keyword">implements</span> <span class="title">HandlerInterceptor</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Logger logger = LoggerFactory.getLogger(MyInterceptor<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    IUserService userService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">preHandle</span><span class="params">(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse,</span></span></span><br><span class="line"><span class="function"><span class="params">                             Object object)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">// ä» http è¯·æ±‚å¤´ä¸­å–å‡º token</span></span><br><span class="line">        String token = httpServletRequest.getHeader(<span class="string">"token"</span>);</span><br><span class="line">        <span class="comment">// å¦‚æœä¸æ˜¯æ˜ å°„åˆ°æ–¹æ³•ç›´æ¥é€šè¿‡</span></span><br><span class="line">        <span class="keyword">if</span>(!(object <span class="keyword">instanceof</span> HandlerMethod))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        HandlerMethod handlerMethod=(HandlerMethod)object;</span><br><span class="line">        Method method=handlerMethod.getMethod();</span><br><span class="line">        <span class="comment">//æ£€æŸ¥æ˜¯å¦æœ‰passtokenæ³¨é‡Šï¼Œæœ‰åˆ™è·³è¿‡è®¤è¯</span></span><br><span class="line">        <span class="keyword">if</span> (method.isAnnotationPresent(PassToken<span class="class">.<span class="keyword">class</span>)) </span>&#123;</span><br><span class="line">            PassToken passToken = method.getAnnotation(PassToken<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">            <span class="keyword">if</span> (passToken.required()) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//æ£€æŸ¥æœ‰æ²¡æœ‰éœ€è¦ç”¨æˆ·æƒé™çš„æ³¨è§£</span></span><br><span class="line">        <span class="keyword">if</span> (method.isAnnotationPresent(UserLoginToken<span class="class">.<span class="keyword">class</span>)) </span>&#123;</span><br><span class="line">            UserLoginToken userLoginToken = method.getAnnotation(UserLoginToken<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">            <span class="keyword">if</span> (userLoginToken.required()) &#123;</span><br><span class="line">                <span class="comment">// æ‰§è¡Œè®¤è¯</span></span><br><span class="line">                <span class="keyword">if</span> (token == <span class="keyword">null</span>) &#123;</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"æ— tokenï¼Œè¯·é‡æ–°ç™»å½•"</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// è·å– token ä¸­çš„ user id</span></span><br><span class="line">                String userId;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    userId = JWT.decode(token).getAudience().get(<span class="number">0</span>);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (JWTDecodeException j) &#123;</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"401"</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">//è¿™é‡Œæ ¹æ®userIdä»æ•°æ®åº“æŸ¥æ‰¾user</span></span><br><span class="line">                User user = userService.findUserById(userId);</span><br><span class="line">                <span class="keyword">if</span> (user == <span class="keyword">null</span>) &#123;</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"ç”¨æˆ·ä¸å­˜åœ¨ï¼Œè¯·é‡æ–°ç™»å½•"</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// éªŒè¯ token</span></span><br><span class="line">                JWTVerifier jwtVerifier = JWT.require(Algorithm.HMAC256(user.getPwd())).build();</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    jwtVerifier.verify(token);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (JWTVerificationException e) &#123;</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"401"</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">postHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">// logger.info("æ‰§è¡Œå®Œæ–¹æ³•ä¹‹åè¿›æ‰§è¡Œ(Controlleræ–¹æ³•è°ƒç”¨ä¹‹å)ï¼Œä½†æ˜¯æ­¤æ—¶è¿˜æ²¡è¿›è¡Œè§†å›¾æ¸²æŸ“");</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterCompletion</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">// logger.info("æ•´ä¸ªè¯·æ±‚éƒ½å¤„ç†å®Œå’¯ï¼ŒDispatcherServletä¹Ÿæ¸²æŸ“äº†å¯¹åº”çš„è§†å›¾å’¯ï¼Œæ­¤æ—¶æˆ‘å¯ä»¥åšä¸€äº›æ¸…ç†çš„å·¥ä½œäº†");</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å…¶ä¸­æˆ‘çš„Userç±»(å·²ç®€åŒ–)</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Integer userId;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String userName;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> String pwd;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æœ€åè¿˜è¦é…ç½®æ‹¦æˆªå™¨ï¼Œé¡ºä¾¿æŠŠè·¨åŸŸé…ç½®ç»™è§£å†³äº†ï¼Œè¿™é‡Œçš„WebMvcConfigurerå¯ä»¥æ‰©å±•å…¶ä»–è‡ªå®šä¹‰åŠŸèƒ½ï¼Œè¯¦æƒ…å¯æŸ¥çœ‹<a href="https://docs.spring.io/spring-boot/docs/2.5.0-SNAPSHOT/reference/html/spring-boot-features.html#boot-features-spring-mvc-auto-configuration" target="_blank" rel="noopener">springå®˜ç½‘</a></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyInterceptorConfig</span> <span class="keyword">implements</span> <span class="title">WebMvcConfigurer</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span> String[] ORIGINS = <span class="keyword">new</span> String[] &#123; <span class="string">"GET"</span>, <span class="string">"POST"</span>, <span class="string">"PUT"</span>, <span class="string">"DELETE"</span> &#125;;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     è§£å†³è·¨åŸŸé—®é¢˜</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addCorsMappings</span><span class="params">(CorsRegistry registry)</span> </span>&#123;</span><br><span class="line"> registry.addMapping(<span class="string">"/**"</span>).allowedOrigins(<span class="string">"*"</span>).allowCredentials(<span class="keyword">true</span>).allowedMethods(ORIGINS).maxAge(<span class="number">3600</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addInterceptors</span><span class="params">(InterceptorRegistry registry)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// å®ç°WebMvcConfigurerä¸ä¼šå¯¼è‡´é™æ€èµ„æºè¢«æ‹¦æˆª</span></span><br><span class="line">        registry.addInterceptor(<span class="keyword">new</span> MyInterceptor())</span><br><span class="line">                <span class="comment">// æ‹¦æˆªæ‰€æœ‰url</span></span><br><span class="line">                .addPathPatterns(<span class="string">"/**"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>åˆ›å»º<code>TokenService</code>ç±»</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TokenService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span>  String <span class="title">getToken</span><span class="params">(User user)</span> </span>&#123;</span><br><span class="line">        Date start = <span class="keyword">new</span> Date();</span><br><span class="line">        <span class="comment">//ä¸€å°æ—¶æœ‰æ•ˆæ—¶é—´</span></span><br><span class="line">        <span class="keyword">long</span> currentTime = System.currentTimeMillis() + <span class="number">60</span>* <span class="number">60</span> * <span class="number">1000</span>;</span><br><span class="line">        Date end = <span class="keyword">new</span> Date(currentTime);</span><br><span class="line">        String token = <span class="string">""</span>;</span><br><span class="line"></span><br><span class="line">        token = JWT.create().withAudience(String.valueOf(user.getUserId())).withIssuedAt(start).withExpiresAt(end).sign(Algorithm.HMAC256(user.getPwd()));</span><br><span class="line">        <span class="keyword">return</span> token;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>æœ€ç»ˆåªéœ€è¦åœ¨ç™»å½•çš„æ—¶å€™è°ƒç”¨<code>TokenService.getToken(user)</code>å³å¯è·å¾—tokenï¼Œè¿”å›ç»™å‰ç«¯ï¼Œä¸‹æ¬¡è¯·æ±‚å…¶ä»–æ¥å£åœ¨headerå¸¦ä¸Štokenå³å¯</strong></p>
<hr>
<p>å‚è€ƒï¼š</p>
<p><a href="https://github.com/jwtk/jjwt" target="_blank" rel="noopener">https://github.com/jwtk/jjwt</a></p>
<p><a href="https://zhuanlan.zhihu.com/p/91420328" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/91420328</a></p>
<p><a href="https://www.jianshu.com/p/e88d3f8151db" target="_blank" rel="noopener">https://www.jianshu.com/p/e88d3f8151db</a></p>
]]></content>
      <categories>
        <category>Java</category>
      </categories>
      <tags>
        <tag>springboot</tag>
      </tags>
  </entry>
  <entry>
    <title>SpringBootè‡ªå®šä¹‰starter</title>
    <url>/posts/dd4c9c1d.html</url>
    <content><![CDATA[<h2 id="ä¸€ã€starterç®€ä»‹">ä¸€ã€starterç®€ä»‹</h2>
<h4 id="1ã€SpringBoot-starteræœºåˆ¶">1ã€SpringBoot starteræœºåˆ¶</h4>
<p>SpringBootä¸­çš„starteræ˜¯ä¸€ç§éå¸¸é‡è¦çš„æœºåˆ¶ï¼Œèƒ½å¤ŸæŠ›å¼ƒä»¥å‰ç¹æ‚çš„é…ç½®ï¼Œå°†å…¶ç»Ÿä¸€é›†æˆè¿›starterï¼Œåº”ç”¨è€…åªéœ€è¦åœ¨mavenä¸­å¼•å…¥starterä¾èµ–ï¼ŒSpringBootå°±èƒ½è‡ªåŠ¨æ‰«æåˆ°è¦åŠ è½½çš„ä¿¡æ¯å¹¶å¯åŠ¨ç›¸åº”çš„é»˜è®¤é…ç½®ã€‚starterè®©æˆ‘ä»¬æ‘†è„±äº†å„ç§ä¾èµ–åº“çš„å¤„ç†ï¼Œéœ€è¦é…ç½®å„ç§ä¿¡æ¯çš„å›°æ‰°ã€‚SpringBootä¼šè‡ªåŠ¨é€šè¿‡classpathè·¯å¾„ä¸‹çš„ç±»å‘ç°éœ€è¦çš„Beanï¼Œå¹¶æ³¨å†Œè¿›IOCå®¹å™¨ã€‚SpringBootæä¾›äº†é’ˆå¯¹æ—¥å¸¸ä¼ä¸šåº”ç”¨ç ”å‘å„ç§åœºæ™¯çš„spring-boot-starterä¾èµ–æ¨¡å—ã€‚æ‰€æœ‰è¿™äº›ä¾èµ–æ¨¡å—éƒ½éµå¾ªç€çº¦å®šæˆä¿—çš„é»˜è®¤é…ç½®ï¼Œå¹¶å…è®¸æˆ‘ä»¬è°ƒæ•´è¿™äº›é…ç½®ï¼Œå³éµå¾ªâ€œçº¦å®šå¤§äºé…ç½®â€çš„ç†å¿µã€‚</p>
<a id="more"></a>
<h4 id="2ã€ä¸ºä»€ä¹ˆè¦è‡ªå®šä¹‰starter">2ã€ä¸ºä»€ä¹ˆè¦è‡ªå®šä¹‰starter</h4>
<p>åœ¨æˆ‘ä»¬çš„æ—¥å¸¸å¼€å‘å·¥ä½œä¸­ï¼Œç»å¸¸ä¼šæœ‰ä¸€äº›ç‹¬ç«‹äºä¸šåŠ¡ä¹‹å¤–çš„é…ç½®æ¨¡å—ï¼Œæˆ‘ä»¬ç»å¸¸å°†å…¶æ”¾åˆ°ä¸€ä¸ªç‰¹å®šçš„åŒ…ä¸‹ï¼Œç„¶åå¦‚æœå¦ä¸€ä¸ªå·¥ç¨‹éœ€è¦å¤ç”¨è¿™å—åŠŸèƒ½çš„æ—¶å€™ï¼Œéœ€è¦å°†ä»£ç ç¡¬æ‹·è´åˆ°å¦ä¸€ä¸ªå·¥ç¨‹ï¼Œé‡æ–°é›†æˆä¸€éï¼Œéº»çƒ¦è‡³æã€‚å¦‚æœæˆ‘ä»¬å°†è¿™äº›å¯ç‹¬ç«‹äºä¸šåŠ¡ä»£ç ä¹‹å¤–çš„åŠŸé…ç½®æ¨¡å—å°è£…æˆä¸€ä¸ªä¸ªstarterï¼Œå¤ç”¨çš„æ—¶å€™åªéœ€è¦å°†å…¶åœ¨pomä¸­å¼•ç”¨ä¾èµ–å³å¯ã€‚</p>
<h4 id="3ã€è‡ªå®šä¹‰starterå‘½åè§„èŒƒ">3ã€è‡ªå®šä¹‰starterå‘½åè§„èŒƒ</h4>
<p>å®˜æ–¹å‘½åï¼š</p>
<ul>
<li>
<p>å‰ç¼€ï¼šspring-boot-starter-xxx</p>
</li>
<li>
<p>æ¯”å¦‚ï¼šspring-boot-starter-webâ€¦</p>
</li>
</ul>
<p>è‡ªå®šä¹‰å‘½åï¼š</p>
<ul>
<li>xxx-spring-boot-starter</li>
<li>æ¯”å¦‚ï¼šmybatis-spring-boot-starter</li>
</ul>
<h2 id="äºŒã€starterå®ç°">äºŒã€starterå®ç°</h2>
<h4 id="1ã€æ–°å»ºå·¥ç¨‹">1ã€æ–°å»ºå·¥ç¨‹</h4>
<p>è¿™é‡Œæˆ‘å‘½åä¸º<code>shawn-spring-boot-starter</code><br>
<img src="https://img-blog.csdnimg.cn/20210128160453197.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xlbW9uX1RU,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h4 id="2ã€æ·»åŠ pom-xmlä¾èµ–">2ã€æ·»åŠ pom.xmlä¾èµ–</h4>
<p>è¿™é‡Œéœ€è¦æ³¨æ„springç‰ˆæœ¬ï¼Œå¤ªé«˜å¯èƒ½ä¼šå¯¼è‡´installå¤±è´¥</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span>?&gt;</span><br><span class="line">&lt;project xmlns=<span class="string">"http://maven.apache.org/POM/4.0.0"</span> xmlns:xsi=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span><br><span class="line">         xsi:schemaLocation=<span class="string">"http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;</span><br><span class="line">    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;</span><br><span class="line">    &lt;parent&gt;</span><br><span class="line">        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;</span><br><span class="line">        &lt;version&gt;2.2.2.RELEASE&lt;/version&gt;</span><br><span class="line">        &lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt;</span><br><span class="line">    &lt;/parent&gt;</span><br><span class="line">    &lt;groupId&gt;com.shawn&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;shawn-spring-boot-starter&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;</span><br><span class="line">    &lt;name&gt;shawn-spring-boot-starter&lt;/name&gt;</span><br><span class="line">    &lt;description&gt;Demo project for Spring Boot&lt;/description&gt;</span><br><span class="line">    &lt;properties&gt;</span><br><span class="line">        &lt;java.version&gt;1.8&lt;/java.version&gt;</span><br><span class="line">    &lt;/properties&gt;</span><br><span class="line">    &lt;dependencies&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;spring-boot-configuration-processor&lt;/artifactId&gt;</span><br><span class="line">            &lt;optional&gt;true&lt;/optional&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;spring-boot-starter&lt;/artifactId&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/dependencies&gt;</span><br><span class="line">&lt;/project&gt;</span><br></pre></td></tr></table></figure>
<h4 id="3ã€å®šä¹‰ä¸€ä¸ªå®ä½“ç±»æ˜ å°„é…ç½®ä¿¡æ¯">3ã€å®šä¹‰ä¸€ä¸ªå®ä½“ç±»æ˜ å°„é…ç½®ä¿¡æ¯</h4>
<p><code>@ConfigurationProperties(prefix = &quot;shawn.hello&quot;) </code>å®ƒå¯ä»¥æŠŠç›¸åŒå‰ç¼€çš„é…ç½®ä¿¡æ¯é€šè¿‡é…ç½®é¡¹åç§°æ˜ å°„æˆå®ä½“ç±»ï¼Œå¯ä»¥ç›´æ¥åœ¨ymlæ–‡ä»¶è¿›è¡Œé…ç½®</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å‰ç¼€ shawn.hello</span></span><br><span class="line"><span class="meta">@ConfigurationProperties</span>(prefix = <span class="string">"shawn.hello"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ShawnProperties</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å‰ç¼€</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String prefix;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åç¼€</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String suffix;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getPrefix</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> prefix;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPrefix</span><span class="params">(String prefix)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.prefix = prefix;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getSuffix</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> suffix;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSuffix</span><span class="params">(String suffix)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.suffix = suffix;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="4ã€ç¼–å†™è‡ªå·±çš„æœåŠ¡">4ã€ç¼–å†™è‡ªå·±çš„æœåŠ¡</h4>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ShawnService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    ShawnProperties ShawnProperties;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> ShawnProperties <span class="title">getShawnProperties</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ShawnProperties;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setShawnProperties</span><span class="params">(ShawnProperties ShawnProperties)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.ShawnProperties = ShawnProperties;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">sayHello</span><span class="params">(String name)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ShawnProperties.getPrefix() + name + ShawnProperties.getSuffix();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="5ã€å®šä¹‰é…ç½®ç±»">5ã€å®šä¹‰é…ç½®ç±»</h4>
<p>è¿™é‡Œï¼Œæˆ‘ä»¬å°†ShawnServiceç±»å®šä¹‰ä¸ºä¸€ä¸ªBeanï¼Œäº¤ç»™Iocå®¹å™¨ã€‚<br>
<code>@Configuration</code> é…ç½®æ³¨è§£<br>
<code>@EnableConfigurationProperties </code>ã€‚è¯¥æ³¨è§£æ˜¯ç”¨æ¥å¼€å¯å¯¹<code>@ConfigurationProperties</code> æ³¨è§£é…ç½®Beançš„æ”¯æŒã€‚å½“ç„¶äº†ï¼Œä¹Ÿå¯ä»¥åœ¨ <code>@ConfigurationProperties</code> æ³¨è§£çš„ç±»ä¸Šæ·»åŠ  <code>@Configuration</code> æˆ–è€…  <code>@Component </code>æ³¨è§£</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@ConditionalOnWebApplication</span> <span class="comment">//webåº”ç”¨ç”Ÿæ•ˆ</span></span><br><span class="line"><span class="meta">@EnableConfigurationProperties</span>(ShawnProperties<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class"><span class="title">public</span> <span class="title">class</span> <span class="title">ShawnServiceAutoConfiguration</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    ShawnProperties shawnProperties;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ShawnService <span class="title">shawnService</span><span class="params">()</span></span>&#123;</span><br><span class="line">        ShawnService service = <span class="keyword">new</span> ShawnService();</span><br><span class="line">        service.setShawnProperties(shawnProperties);</span><br><span class="line">        <span class="keyword">return</span> service;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="6ã€åœ¨resourcesç¼–å†™ä¸€ä¸ªè‡ªå·±çš„-META-INF-spring-factories">6ã€åœ¨<code>resources</code>ç¼–å†™ä¸€ä¸ªè‡ªå·±çš„ <code>META-INF\spring.factories</code></h4>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"># Auto Configure</span><br><span class="line">org.springframework.boot.autoconfigure.EnableAutoConfiguration=\</span><br><span class="line">com.shawn.ShawnServiceAutoConfiguration</span><br></pre></td></tr></table></figure>
<h4 id="7ã€æ‰“åŒ…åˆ°Mavenä»“åº“">7ã€æ‰“åŒ…åˆ°Mavenä»“åº“</h4>
<p><img src="https://img-blog.csdnimg.cn/20210128183428374.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xlbW9uX1RU,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h2 id="ä¸‰ã€æµ‹è¯•starter">ä¸‰ã€æµ‹è¯•starter</h2>
<h4 id="1ã€æ–°å»ºé¡¹ç›®ï¼Œå¼•å…¥ä¾èµ–">1ã€æ–°å»ºé¡¹ç›®ï¼Œå¼•å…¥ä¾èµ–</h4>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.shawn<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>shawn-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="2ã€ç¼–å†™æµ‹è¯•ç±»">2ã€ç¼–å†™æµ‹è¯•ç±»</h4>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ShawnCOntroller</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    ShawnService shawnService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/hello"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">hello</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> shawnService.sayHello(<span class="string">"shawn"</span>);</span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="3ã€é…ç½®">3ã€é…ç½®</h4>
<p>åœ¨<code>application.yml</code>ä¸­è¿›è¡Œé…ç½®</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">shawn:</span></span><br><span class="line">  <span class="attr">hello:</span></span><br><span class="line">    <span class="attr">prefix:</span> <span class="string">prefix</span></span><br><span class="line">    <span class="attr">suffix:</span> <span class="string">suffix</span></span><br></pre></td></tr></table></figure>
<h4 id="4ã€æµ‹è¯•">4ã€æµ‹è¯•</h4>
<p>æˆåŠŸæ‰“å°<br>
<img src="https://img-blog.csdnimg.cn/20210128185155637.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<hr>
<p>å‚è€ƒ:<br>
<a href="https://www.cnblogs.com/hellokuangshen/p/12486631.html" target="_blank" rel="noopener">https://www.cnblogs.com/hellokuangshen/p/12486631.html</a><br>
<a href="https://www.cnblogs.com/hello-shf/p/10864977.html" target="_blank" rel="noopener">https://www.cnblogs.com/hello-shf/p/10864977.html</a></p>
]]></content>
      <categories>
        <category>Java</category>
      </categories>
      <tags>
        <tag>springboot</tag>
      </tags>
  </entry>
  <entry>
    <title>githubå®ç”¨çš„å‡ æ¬¾chromeæ’ä»¶</title>
    <url>/posts/d7585d3e.html</url>
    <content><![CDATA[<h2 id="è°·æ­Œä¸Šç½‘åŠ©æ‰‹">è°·æ­Œä¸Šç½‘åŠ©æ‰‹</h2>
<p>åœ¨chromeæµè§ˆå™¨ä¸Šå®‰è£…æ’ä»¶ï¼Œæœ€æ–¹ä¾¿çš„æ˜¯åœ¨chromeç½‘ä¸Šåº”ç”¨å•†åº—è¿›è¡Œæœç´¢ä¸‹è½½ï¼Œè¿™é‡Œå¼ºçƒˆæ¨è<strong>è°·æ­Œä¸Šç½‘åŠ©æ‰‹</strong>ï¼Œå¯ä»¥è¿›è¡Œå­¦æœ¯æ€§çš„ç§‘å­¦ä¸Šç½‘ã€‚</p>
<a id="more"></a>
<p><a href="http://googlehelper.net/" target="_blank" rel="noopener">è°·æ­Œä¸Šç½‘åŠ©æ‰‹ä¸‹è½½åœ°å€</a><br>
æ‰“å¼€æµè§ˆå™¨çš„æ‰©å±•ç¨‹åºï¼Œç›´æ¥å°†ä¸‹è½½çš„crxæ‹–è¿›å»å°±è¡Œäº†ï¼Œæ‰“å¼€æ’ä»¶ä¹‹åå°±å¯ä»¥è¿›è¡Œ<a href="https://chrome.google.com/webstore/category/extensions" target="_blank" rel="noopener">åº”ç”¨å•†åº—</a>çš„è®¿é—®äº†ã€‚<br>
<img src="https://img-blog.csdnimg.cn/20201128211605953.gif" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h2 id="1ã€Octotree-GitHub-code-tree">1ã€Octotree - GitHub code tree</h2>
<p><img src="https://img-blog.csdnimg.cn/20201128212348459.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xlbW9uX1RU,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>
ğŸ˜ƒå®ƒä¼šåœ¨githubå·¦è¾¹ä¼šç”Ÿæˆä¸€ä¸ª <code>Octotree</code> æŒ‰é’®ï¼Œç™»å½•åé¼ æ ‡æ»‘åŠ¨ä»£ç æ–‡ä»¶æ ‘ï¼Œè¿™æ ·å°±å¯ä»¥å¿«é€Ÿå®šä½æ–‡ä»¶å’ŒæŸ¥çœ‹æ–‡ä»¶äº†ã€‚ç±»ä¼¼çš„è¿˜æœ‰<code>Sourcegraph</code>æ’ä»¶<br>
<img src="https://img-blog.csdnimg.cn/20201128212757505.gif" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h2 id="2ã€Enhanced-GitHub">2ã€Enhanced GitHub</h2>
<p>ğŸ˜Šä¹‹å‰ä»githubä¸Šä¸‹è½½æ–‡ä»¶éƒ½éœ€è¦æ•´ä¸ªå·¥ç¨‹cloneï¼Œä¸‹è½½äº†è¯¥æ’ä»¶åå¯ä»¥è¿›è¡Œå•ä¸ªæ–‡ä»¶çš„ä¸‹è½½<br>
<img src="https://img-blog.csdnimg.cn/20201128214504261.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xlbW9uX1RU,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>
<img src="https://img-blog.csdnimg.cn/20201128214653377.gif" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h2 id="3ã€GitZip">3ã€GitZip</h2>
<p>ğŸ˜†å¤šä¸ªæ–‡ä»¶ä¸€èµ·ä¸‹è½½ï¼Œæˆ–è€…å•ç‹¬ä¸‹è½½ä¸€ä¸ªæ–‡ä»¶å¤¹<br>
<img src="https://img-blog.csdnimg.cn/20201128215001164.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xlbW9uX1RU,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>
<img src="https://img-blog.csdnimg.cn/20201128214949675.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xlbW9uX1RU,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h2 id="4ã€GitHubåŠ é€Ÿ">4ã€GitHubåŠ é€Ÿ</h2>
<p>ğŸ˜<code>GitHubåŠ é€Ÿ</code>æ’ä»¶èƒ½æé«˜ä¸­å›½å¼€å‘è€…è®¿é—® <code>GitHub</code> çš„é€Ÿåº¦ï¼Œæå‡<code>clone Git </code>ä»“åº“çš„é€Ÿåº¦ï¼Œæå‡ä¸‹è½½<code>release</code>åŒ…çš„ä¸‹è½½é€Ÿåº¦ã€‚<br>
<img src="https://img-blog.csdnimg.cn/20201128215348199.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xlbW9uX1RU,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h2 id="5ã€Isometric-Contributions">5ã€Isometric Contributions</h2>
<p>ğŸ˜„æ›´ç‚«é…·çš„3Dç«‹ä½“æ–¹å¼æ¸²æŸ“ GitHub è´¡çŒ®å›¾ã€‚<br>
<img src="https://img-blog.csdnimg.cn/2020112821563210.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xlbW9uX1RU,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>
<img src="https://img-blog.csdnimg.cn/20201128215705248.gif" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h2 id="6ã€Awesome-Autocomplete-for-GitHub">6ã€Awesome Autocomplete for GitHub</h2>
<p>ğŸ˜æ›´å¿«åœ°ã€å‡†ç¡®çš„githubæœç´¢æ’ä»¶<br>
<img src="https://img-blog.csdnimg.cn/20201128220119232.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xlbW9uX1RU,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>
<img src="https://img-blog.csdnimg.cn/2020112822333144.gif" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h2 id="7ã€File-Icons-for-GitHub-and-GitLab">7ã€File Icons for GitHub and GitLab</h2>
<p>ğŸ˜šä¸€ä¸ªChromeæ‰©å±•ï¼Œä¸ºGitHubã€GitLabã€giteaå’Œgogsæä¾›ä¸åŒçš„æ–‡ä»¶ç±»å‹å›¾æ ‡ã€‚<br>
<img src="https://img-blog.csdnimg.cn/20201128220746676.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xlbW9uX1RU,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>
<img src="https://img-blog.csdnimg.cn/20201128220928252.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xlbW9uX1RU,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>
æœ€ågithubç›¸å…³çš„æ’ä»¶éƒ½å¯ä»¥å»å°è¯•<br>
<img src="https://img-blog.csdnimg.cn/20201128222017952.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xlbW9uX1RU,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<hr>
<p>å‚è€ƒæ–‡ç« ï¼š<br>
<a href="https://blog.csdn.net/xinzhifu1/article/details/109309805" target="_blank" rel="noopener">https://blog.csdn.net/xinzhifu1/article/details/109309805</a><br>
<a href="https://blog.csdn.net/Mrs_chens/article/details/104500188" target="_blank" rel="noopener">https://blog.csdn.net/Mrs_chens/article/details/104500188</a></p>
]]></content>
      <categories>
        <category>git</category>
      </categories>
      <tags>
        <tag>git</tag>
      </tags>
  </entry>
  <entry>
    <title>VMware15å®‰è£…MacOS10.15</title>
    <url>/posts/cb79a5e7.html</url>
    <content><![CDATA[<h3 id="1ã€MAC-OSå®‰è£…">1ã€MAC OSå®‰è£…</h3>
<p>å…·ä½“å®‰è£…æµç¨‹ä¸‹é¢è¿™ç¯‡åšå®¢å·²ç»ååˆ†è¯¦ç»†çš„æè¿°äº†<br>
<a href="https://blog.csdn.net/SuperAE86/article/details/104653595?utm_medium=distribute.pc_relevant_t0.none-task-blog-BlogCommendFromMachineLearnPai2-1.control&amp;depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-BlogCommendFromMachineLearnPai2-1.control" target="_blank" rel="noopener">VM15proå®‰è£…MacOS10.15.1ç³»ç»Ÿ(è¶…è¯¦ç»†ï¼Œå¯ç”¨)</a></p>
<blockquote>
<p>MacOSå’Œunlockeräº‘ç›˜èµ„æ–™ï¼Œé˜²æ­¢å¤±è”<br>
é“¾æ¥ï¼š<a href="https://pan.baidu.com/s/1XXAIM8HtvtgYN-r5E4MzIQ" target="_blank" rel="noopener">https://pan.baidu.com/s/1XXAIM8HtvtgYN-r5E4MzIQ</a><br>
æå–ç ï¼šl1dd</p>
</blockquote>
<a id="more"></a>
<h3 id="2ã€ä¿®æ”¹è™šæ‹Ÿæœºçš„Macåˆ†è¾¨ç‡">2ã€ä¿®æ”¹è™šæ‹Ÿæœºçš„Macåˆ†è¾¨ç‡?</h3>
<p>ä½¿ç”¨VMå®‰è£…å¥½Macåä½ ä¼šå‘ç°ç•Œé¢å¾ˆå°ï¼Œå°±ç®—å…¨å±ä¹Ÿä¸èƒ½çœŸæ­£çš„å…¨å±ï¼Œè¿™å°±æ˜¯å› ä¸ºåˆ†è¾¨ç‡çš„å…³ç³»<br>
è§£å†³æ–¹æ³•å¦‚ä¸‹ï¼š<br>
<strong>å®‰è£…VMware Tools</strong><br>
<img src="https://img-blog.csdnimg.cn/20201124210742361.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xlbW9uX1RU,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>
å¦‚æœç‚¹å‡»åå‘ç°æ­£åœ¨ä½¿ç”¨CD/DVDï¼Œåˆ™éœ€è¦æ¨å‡ºä½ æ­£åœ¨ä½¿ç”¨çš„CD/DVDï¼ˆæ“ä½œæ–¹æ³•å³é”®é€‰æ‹©æ¨å‡ºxxxï¼‰<br>
<img src="https://img-blog.csdnimg.cn/20201124210711300.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xlbW9uX1RU,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>
å®‰è£…å¥½ä¹‹åéœ€è¦ç»™è½¯ä»¶å®‰è£…æƒé™ï¼Œå¦åˆ™åé¢çš„å‘½ä»¤ä¼šæ˜¾ç¤º<code>Unable to find the service</code>ï¼Œå¦‚æœå‡ºç°ï¼Œæ ¹æ®<strong>ç³»ç»Ÿåå¥½è®¾ç½®â€”â€”&gt;å®‰å…¨æ€§ä¸éšç§â€”â€”&gt;é€šç”¨</strong>ï¼Œè§£é”ï¼Œç‚¹å‡»å…è®¸<img src="https://img-blog.csdnimg.cn/20201124211105852.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xlbW9uX1RU,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>
é‡å¯ä¹‹åVMware Toolsåˆ™å®‰è£…å®Œæ¯•<br>
æ‰“å¼€Macç»ˆç«¯å¹¶è¾“å…¥<br>
<code>sudo /Library/Application\ Support/VMware\ Tools/vmware-resolutionSet 1920 1080 </code><br>
åé¢çš„ä¸¤ä¸ªæ•°å­—å¯ä»¥æ ¹æ®éœ€æ±‚ä¿®æ”¹ï¼Œæœ€åé‡å¯å³å¯</p>
]]></content>
      <tags>
        <tag>macos</tag>
      </tags>
  </entry>
  <entry>
    <title>IntelliJ IDEAå¥½ç”¨çš„å‡ æ¬¾æ’ä»¶</title>
    <url>/posts/5f51afa8.html</url>
    <content><![CDATA[<h4 id="1ã€CodeGlance">1ã€CodeGlance</h4>
<p>ä»£ç è¿·ä½ ç¼©æ”¾å›¾æ’ä»¶ï¼Œå¯ä»¥å¿«é€Ÿæ‹–åŠ¨ä»£ç ï¼Œå’ŒVScodeä¸€æ ·<br>
<img src="https://img-blog.csdnimg.cn/20201106233342873.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xlbW9uX1RU,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h4 id="2ã€Codota">2ã€Codota</h4>
<p>ä»£ç æç¤ºå·¥å…·ï¼Œæ‰«æä½ çš„ä»£ç åï¼Œæ ¹æ®ä½ çš„æ•²å‡»å®Œç¾æç¤ºã€‚<br>
CodotaåŸºäºæ•°ç™¾ä¸‡ä¸ªå¼€æºJavaç¨‹åºå’Œæ‚¨çš„ä¸Šä¸‹æ–‡æ¥å®Œæˆä»£ç è¡Œï¼Œä»è€Œå¸®åŠ©æ‚¨ä»¥æ›´å°‘çš„é”™è¯¯æ›´å¿«åœ°è¿›è¡Œç¼–ç ã€‚</p>
<p><img src="https://img-blog.csdnimg.cn/20201106234011347.png#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<a id="more"></a>
<h4 id="3ã€Alibaba-Java-Coding-Guidelines">3ã€Alibaba Java Coding Guidelines</h4>
<p>é˜¿é‡Œå·´å·´çš„ç¼–ç è§„çº¦æ£€æŸ¥æ’ä»¶ï¼Œæ£€æŸ¥ä½ çš„ç¼–ç ä¹ æƒ¯ï¼Œè®©ä½ æ›´è§„èŒƒ</p>
<h4 id="4ã€Alibaba-Cloud-Toolkit">4ã€Alibaba Cloud Toolkit</h4>
<p>å¿«é€Ÿéƒ¨ç½²åˆ°æœåŠ¡å™¨<br>
<img src="https://img-blog.csdnimg.cn/20201106233606633.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xlbW9uX1RU,size_16,color_FFFFFF,t_70#pic_center" alt="è¯·æ·»åŠ å›¾ç‰‡æè¿°"></p>
<h4 id="5ã€GenerateAllSetter">5ã€GenerateAllSetter</h4>
<p>å¿«é€Ÿç”Ÿæˆget set</p>
<h4 id="6ã€Lombok">6ã€Lombok</h4>
<p>ç®€åŒ–longå†—ä½™çš„javabeanä»£ç ï¼Œæé«˜æ‰§è¡Œæ•ˆç‡ã€‚åªéœ€åŠ ä¸Šæ³¨è§£ ä»€ä¹ˆget set ä»€ä¹ˆtoString ç­‰ç­‰æ–¹æ³•éƒ½ä¸éœ€è¦å†™ã€‚<br>
ç®€å•ä½¿ç”¨è¯¦è§<a href="https://blog.csdn.net/lemon_TT/article/details/109249154" target="_blank" rel="noopener">Lombokå¸¸ç”¨æ³¨è§£</a></p>
<h4 id="7ã€JUnitGenerator">7ã€JUnitGenerator</h4>
<p>è‡ªåŠ¨ç”Ÿæˆæµ‹è¯•ä»£ç ã€‚<br>
<img src="https://img-blog.csdnimg.cn/20201106233606469.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xlbW9uX1RU,size_16,color_FFFFFF,t_70#pic_center" alt="è¯·æ·»åŠ å›¾ç‰‡æè¿°"></p>
<h4 id="8ã€EasyCode">8ã€EasyCode</h4>
<p>Easycodeæ˜¯ideaçš„ä¸€ä¸ªæ’ä»¶ï¼Œå¯ä»¥ç›´æ¥å¯¹æ•°æ®çš„è¡¨ç”Ÿæˆentityï¼Œcontrollerï¼Œserviceï¼Œdaoï¼Œmapperï¼Œæ— éœ€ä»»ä½•ç¼–ç ï¼Œç®€å•è€Œå¼ºå¤§ã€‚<br>
<img src="https://img-blog.csdnimg.cn/20201106233606598.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xlbW9uX1RU,size_16,color_FFFFFF,t_70#pic_center" alt="è¯·æ·»åŠ å›¾ç‰‡æè¿°"></p>
<h4 id="9ã€Chinese-Simplified">9ã€Chinese (Simplified)</h4>
<p>æ±‰åŒ–æ’ä»¶ï¼Œçœ‹ä¸æ‡‚è‹±æ–‡å¿…å¤‡</p>
<h4 id="10ã€Free-MyBatis-plugin">10ã€Free MyBatis plugin</h4>
<p>free-idea-mybatisæ˜¯ä¸€æ¬¾å¢å¼ºideaå¯¹mybatisæ”¯æŒçš„æ’ä»¶ï¼ˆå’ŒEasyCodeåŠŸèƒ½æœ‰é‡å¤ï¼‰ï¼Œä¸»è¦åŠŸèƒ½å¦‚ä¸‹ï¼š</p>
<ul>
<li>ç”Ÿæˆmapper xmlæ–‡ä»¶</li>
<li>å¿«é€Ÿä»ä»£ç è·³è½¬åˆ°mapperåŠä»mapperè¿”å›ä»£ç </li>
<li>mybatisè‡ªåŠ¨è¡¥å…¨åŠè¯­æ³•é”™è¯¯æç¤º</li>
<li>é›†æˆmybatis generator guiç•Œé¢<br>
<img src="https://img-blog.csdnimg.cn/20201106233606676.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xlbW9uX1RU,size_16,color_FFFFFF,t_70#pic_center" alt="è¯·æ·»åŠ å›¾ç‰‡æè¿°"></li>
</ul>
<h4 id="11ã€MyBatis-Log-Plugin">11ã€MyBatis Log Plugin</h4>
<p>è¿™æ¬¾æ’ä»¶æ˜¯ç›´æ¥å°†Mybatisæ‰§è¡Œçš„sqlè„šæœ¬æ˜¾ç¤ºå‡ºæ¥ï¼ŒæŠŠ mybatis è¾“å‡ºçš„sqlæ—¥å¿—è¿˜åŸæˆå®Œæ•´çš„sqlè¯­å¥ã€‚å³å°†æ—¥å¿—è¾“å‡ºçš„sqlè¯­å¥ä¸­çš„é—®å· ? æ›¿æ¢æˆçœŸæ­£çš„å‚æ•°å€¼ï¼ˆæ”¶è´¹ï¼‰ã€‚</p>
<p><a href="https://github.com/Link-Kou/intellij-mybaitslog" target="_blank" rel="noopener">githubå®˜ç½‘</a></p>
<h4 id="12ã€MyBatisCodeHelperPro">12ã€MyBatisCodeHelperPro</h4>
<p>æ”¯æŒmapperäº’è·³ï¼Œæ–¹æ³•è‡ªåŠ¨ç”Ÿæˆï¼Œä»£ç è‡ªåŠ¨ç”Ÿæˆã€‚(å’ŒFree MyBatis pluginåŠŸèƒ½æœ‰äº›é‡å¤,ï¼Œä½†æ˜¯æ”¶è´¹)</p>
<blockquote>
<p>é“¾æ¥ï¼š<a href="https://pan.baidu.com/s/1vrxBM8ujm79jabo2D2w8mQ" target="_blank" rel="noopener">https://pan.baidu.com/s/1vrxBM8ujm79jabo2D2w8mQ</a><br>
æå–ç ï¼šjxo8</p>
<p>æ”¶è´¹ä¸¤é¡¹å¯ä»¥ä½¿ç”¨æœ¬åœ°å®‰è£…ï¼Œæ³¨æ„ç‰ˆæœ¬å¯¹åº”ï¼Œå…·ä½“å¯æŸ¥è¯¢ç™¾åº¦</p>
</blockquote>
<p><img src="https://img-blog.csdnimg.cn/20201106233606606.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xlbW9uX1RU,size_16,color_FFFFFF,t_70#pic_center" alt="è¯·æ·»åŠ å›¾ç‰‡æè¿°"></p>
<h4 id="13ã€RestfulTool">13ã€RestfulTool</h4>
<ul>
<li>æä¾›äº†ä¸€ä¸ª Services tree çš„æ˜¾ç¤ºçª—å£</li>
<li>åŒå‡» URL ç›´æ¥è·³è½¬åˆ°å¯¹åº”çš„æ–¹æ³•å®šä¹‰</li>
<li>ä¸€ä¸ªç®€å•çš„ http è¯·æ±‚å·¥å…·</li>
<li>æ”¯æŒ Spring ä½“ç³» (Spring MVC / Spring Boot)</li>
<li>æ”¯æŒ JAX-RS</li>
<li>æ”¯æŒ <code>Navigate -&gt; Request Service</code> æœç´¢ Mapping (Ctrl + Alt + /)<br>
<img src="https://img-blog.csdnimg.cn/20201106233606636.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xlbW9uX1RU,size_16,color_FFFFFF,t_70#pic_center" alt="è¯·æ·»åŠ å›¾ç‰‡æè¿°"></li>
</ul>
<h4 id="14ã€Translation">14ã€Translation</h4>
<p>ç¿»è¯‘æ’ä»¶<br>
<img src="https://img-blog.csdnimg.cn/20201106233606515.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xlbW9uX1RU,size_16,color_FFFFFF,t_70#pic_center" alt="è¯·æ·»åŠ å›¾ç‰‡æè¿°"></p>
<h4 id="15ã€WakaTime">15ã€WakaTime</h4>
<p>è¿™æ˜¯ä¸€æ¬¾ IDE æ’ä»¶ï¼Œæ”¯æŒå¸‚åœºä¸Šå¤§éƒ¨åˆ†IDEï¼Œå¯ä»¥ç»Ÿè®¡ä½ ä½¿ç”¨ IDE æ¯ä¸ªé¡¹ç›®çš„æ—¶é•¿ä»¥åŠä»£ç æ•°ï¼Œä¸€å‘¨ä¸€ç»Ÿè®¡ï¼Œå®ƒä¼šå°†ä½ æ¯å‘¨çš„æ¯ä¸ªé¡¹ç›®çš„å·¥ä½œæ—¶é•¿ç»Ÿè®¡å¥½ä¹‹åå‘åˆ°ä½ çš„é‚®ç®±ã€‚<br>
<a href="https://wakatime.com/" target="_blank" rel="noopener">åå°åœ°å€</a></p>
<h4 id="16ã€Easy-Javadoc">16ã€Easy Javadoc</h4>
<p>Easy Javadocæ˜¯IntelliJ IDEAçš„æ’ä»¶ï¼Œèƒ½å¸®åŠ©javaå¼€å‘è€…è‡ªåŠ¨ç”Ÿæˆjavadocæ–‡æ¡£æ³¨é‡Š<br>
ä½¿ç”¨ï¼šå°†å…‰æ ‡æ”¾ç½®åˆ°æƒ³è¦ç”Ÿæˆæ³¨é‡Šçš„ç±»ã€æ–¹æ³•æˆ–è€…å±æ€§ä¸Šï¼Œç„¶åæŒ‰ä¸‹å¿«æ·é”®ctrl \æˆ–è€…command \ï¼Œå³å¯ç”Ÿæˆæ³¨é‡Šï¼Œä½ çš„æ–¹æ³•åèµ·çš„è¶Šè´´åˆ‡ï¼Œæ³¨é‡Šè¶Šå¾—ä½“ã€‚</p>
<hr>
<p>å‚è€ƒæ–‡ç« :<br>
<a href="https://mp.weixin.qq.com/s/KXEPNl1Peu4n-XkdC4vFwA" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/KXEPNl1Peu4n-XkdC4vFwA</a></p>
]]></content>
      <categories>
        <category>Java</category>
      </categories>
      <tags>
        <tag>Idea</tag>
      </tags>
  </entry>
  <entry>
    <title>Androidç»„ä»¶ç‚¹å‡»äº‹ä»¶ä¸‰ç§å®ç°æ–¹æ³•</title>
    <url>/posts/49a72762.html</url>
    <content><![CDATA[<h2 id="ä¸€ã€å‡†å¤‡å·¥ä½œ">ä¸€ã€å‡†å¤‡å·¥ä½œ</h2>
<h3 id="1ã€å·¥ä½œç›®å½•">1ã€å·¥ä½œç›®å½•</h3>
<p>é¦–å…ˆåˆ›å»ºç©ºé¡¹ç›®<br>
<img src="https://img-blog.csdnimg.cn/20201028225647376.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xlbW9uX1RU,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<a id="more"></a>
<h3 id="2ã€å¸ƒå±€æ–‡ä»¶ï¼ˆactivity-main-xmlï¼‰">2ã€å¸ƒå±€æ–‡ä»¶ï¼ˆactivity_main.xmlï¼‰</h3>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">LinearLayout</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">"http://schemas.android.com/tools"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">tools:context</span>=<span class="string">".MainActivity"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:orientation</span>=<span class="string">"vertical"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">Button</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">"@+id/btn_click"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">"ç‚¹å‡»æˆ‘"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="äºŒã€ä¸‰ç§å®ç°æ–¹å¼">äºŒã€ä¸‰ç§å®ç°æ–¹å¼</h2>
<h3 id="1ã€åœ¨ä¸äº‹ä»¶ç»‘å®šæ—¶å®šä¹‰äº‹ä»¶ç›‘å¬å™¨">1ã€åœ¨ä¸äº‹ä»¶ç»‘å®šæ—¶å®šä¹‰äº‹ä»¶ç›‘å¬å™¨</h3>
<p>è¯¥æ–¹æ³•æ˜¯å½“é€šè¿‡è°ƒç”¨ç»„ä»¶çš„setXXXListener()æ–¹æ³•è®¾ç½®ç›‘å¬å™¨æ—¶ï¼Œå®šä¹‰åªèƒ½å½“å‰çš„ç»„ä»¶ä½¿ç”¨çš„äº‹ä»¶ç›‘å¬å™¨ï¼Œä»£ç å¦‚ä¸‹</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.listener;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> androidx.appcompat.app.AppCompatActivity;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.os.Bundle;</span><br><span class="line"><span class="keyword">import</span> android.view.View;</span><br><span class="line"><span class="keyword">import</span> android.widget.Button;</span><br><span class="line"><span class="keyword">import</span> android.widget.Toast;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line"></span><br><span class="line">        Button btnClick = findViewById(R.id.btn_click);</span><br><span class="line">        <span class="comment">//ä½¿ç”¨findViewByIdæ–¹æ³•å¯¹æ§ä»¶è¿›è¡Œè·å–</span></span><br><span class="line">        <span class="comment">//R.id.btn_clickå¯¹åº”å¸ƒå±€ä¸­æ·»åŠ çš„idå±æ€§</span></span><br><span class="line">        btnClick.setOnClickListener(<span class="keyword">new</span> View.OnClickListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View view)</span> </span>&#123;</span><br><span class="line">                <span class="comment">//é‡Œé¢å†™ç‚¹å‡»åæƒ³è¦å®ç°çš„æ•ˆæœ</span></span><br><span class="line">                Toast.makeText(MainActivity.<span class="keyword">this</span>,</span><br><span class="line">                        <span class="string">"æŒ‰é’®è¢«ç‚¹å‡»"</span>, Toast.LENGTH_SHORT).show();</span><br><span class="line">                <span class="comment">//è¿™é‡Œæ˜¯å¼¹å‡ºä¸€ä¸ªæ¶ˆæ¯---"æŒ‰é’®è¢«ç‚¹å‡»"</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="2ã€å½“å‰Activityç±»å®ç°ç›‘å¬å™¨æ¥å£">2ã€å½“å‰Activityç±»å®ç°ç›‘å¬å™¨æ¥å£</h3>
<p>è¯¥æ–¹æ³•ä½¿å½“å‰Activityç±»å®ç°ç›¸åº”çš„ç›‘å¬å™¨æ¥å£ï¼Œå®Œæˆç›‘å¬å™¨ä¸­çš„æŠ½è±¡æ–¹æ³•ï¼Œç»„ä»¶ç»‘å®šç›‘å¬å™¨æ—¶ï¼Œç›‘å¬å™¨å¯¹è±¡ä¸ºActivityå¯¹è±¡ï¼ˆå¸¸ç”¨ï¼‰ã€‚ä»£ç å¦‚ä¸‹</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.listener;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">import</span> androidx.appcompat.app.AppCompatActivity;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">import</span> android.os.Bundle;</span><br><span class="line">        <span class="keyword">import</span> android.view.View;</span><br><span class="line">        <span class="keyword">import</span> android.widget.Button;</span><br><span class="line">        <span class="keyword">import</span> android.widget.Toast;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> <span class="keyword">implements</span> <span class="title">View</span>.<span class="title">OnClickListener</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line"></span><br><span class="line">        Button btnClick = findViewById(R.id.btn_click);<span class="comment">//æ§ä»¶çš„è·å–</span></span><br><span class="line">        btnClick.setOnClickListener(MainActivity.<span class="keyword">this</span>);</span><br><span class="line">        <span class="comment">//éœ€è¦ä¼ å…¥æ¥å£å®ç°ç±»çš„å®ä¾‹ã€‚</span></span><br><span class="line">        <span class="comment">//æ­¤æ—¶æ¥å£å®ç°ç±»çš„å®ä¾‹ä¸ºMainActivity</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View view)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">switch</span> (view.getId())&#123;</span><br><span class="line">            <span class="keyword">case</span> R.id.btn_click:</span><br><span class="line">                <span class="comment">//é‡Œé¢å†™ç‚¹å‡»åæƒ³è¦å®ç°çš„æ•ˆæœ</span></span><br><span class="line">                Toast.makeText(MainActivity.<span class="keyword">this</span>,</span><br><span class="line">                        <span class="string">"æŒ‰é’®è¢«ç‚¹å‡»"</span>, Toast.LENGTH_SHORT).show();</span><br><span class="line">                <span class="comment">//è¿™é‡Œæ˜¯å¼¹å‡ºä¸€ä¸ªæ¶ˆæ¯---"æŒ‰é’®è¢«ç‚¹å‡»"</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="3ã€XMLå¸ƒå±€æ–‡ä»¶ä¸­è®¾ç½®å›è°ƒæ–¹æ³•">3ã€XMLå¸ƒå±€æ–‡ä»¶ä¸­è®¾ç½®å›è°ƒæ–¹æ³•</h3>
<p>è¯¥æ–¹æ³•æ˜¯åœ¨XMLå¸ƒå±€æ–‡ä»¶ä¸­è®¾ç½®å›è°ƒæ–¹æ³•ï¼Œåœ¨Javaä»£ç ä¸­å®ç°è¯¥æ–¹æ³•å³å¯ã€‚ä½†æ­¤æ–¹æ³•ä¸æ˜¯ä¸€ä¸ªé€šç”¨çš„æ–¹æ³•ï¼Œä½†å¯¹æŒ‰é’®ç­‰å¸¸ç”¨ç»„ä»¶çš„ç‚¹å‡»äº‹ä»¶å¤„ç†ç¡®å®å¾ˆæ–¹ä¾¿ã€‚å…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š<br>
1ã€<code>activity_main.xml </code>å¸ƒå±€æ–‡ä»¶ä¸­æ·»åŠ <code>onclick </code>å±æ€§ï¼Œè®¾å®šå›è°ƒæ–¹æ³•</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">LinearLayout</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">"http://schemas.android.com/tools"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">tools:context</span>=<span class="string">".MainActivity"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:orientation</span>=<span class="string">"vertical"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">Button</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">"@+id/btn_click"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">"ç‚¹å‡»æˆ‘"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:onClick</span>=<span class="string">"Click"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>2ã€åœ¨<code>MainActivity</code>ä¸­æ·»åŠ <code>Click</code>æ–¹æ³•å³å¯</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.listener;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.os.Bundle;</span><br><span class="line"><span class="keyword">import</span> android.view.View;</span><br><span class="line"><span class="keyword">import</span> android.widget.Button;</span><br><span class="line"><span class="keyword">import</span> android.widget.Toast;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> androidx.appcompat.app.AppCompatActivity;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line">        Button btnClick = findViewById(R.id.btn_click);<span class="comment">//æ§ä»¶çš„è·å–</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span>  <span class="keyword">void</span> <span class="title">Click</span><span class="params">(View view)</span></span>&#123;</span><br><span class="line">        <span class="keyword">switch</span> (view.getId())&#123;</span><br><span class="line">            <span class="keyword">case</span> R.id.btn_click:<span class="comment">//æ­¤å¤„æ˜¯å¯¹å¸ƒå±€ä¸­è®¾ç½®çš„idç›´æ¥è¿›è¡Œåˆ¤æ–­ï¼Œ</span></span><br><span class="line">                <span class="comment">// ä¸éœ€è¦å¯¹æ§ä»¶è¿›è¡Œè·å–ï¼ˆfindviewByIDï¼‰</span></span><br><span class="line">                Toast.makeText(<span class="keyword">this</span>, <span class="string">"æŒ‰é’®è¢«ç‚¹å‡»"</span>, Toast.LENGTH_SHORT).show();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<p>å‚è€ƒæ–‡ç« ï¼š<br>
<a href="https://www.cnblogs.com/xqz0618/p/click3.html" target="_blank" rel="noopener">https://www.cnblogs.com/xqz0618/p/click3.html</a></p>
]]></content>
      <tags>
        <tag>å®‰å“</tag>
      </tags>
  </entry>
  <entry>
    <title>Lombokå¸¸ç”¨æ³¨è§£</title>
    <url>/posts/a283ce74.html</url>
    <content><![CDATA[<h2 id="1ã€Lombokç®€ä»‹">1ã€Lombokç®€ä»‹</h2>
<p>Lombokæ˜¯ä¸€ä¸ªå¯ä»¥é€šè¿‡ç®€å•çš„æ³¨è§£å½¢å¼æ¥å¸®åŠ©æˆ‘ä»¬ç®€åŒ–æ¶ˆé™¤ä¸€äº›å¿…é¡»æœ‰ä½†æ˜¾å¾—å¾ˆè‡ƒè‚¿çš„Javaä»£ç çš„å·¥å…·ï¼Œé€šè¿‡ä½¿ç”¨å¯¹åº”çš„æ³¨è§£ï¼Œå¯ä»¥åœ¨ç¼–è¯‘æºç çš„æ—¶å€™ç”Ÿæˆå¯¹åº”çš„æ–¹æ³•ã€‚</p>
<blockquote>
<p>å®˜æ–¹åœ°å€ï¼š<a href="https://projectlombok.org/" target="_blank" rel="noopener">https://projectlombok.org/</a><br>
githubåœ°å€ï¼š<a href="https://github.com/rzwitserloot/lombok" target="_blank" rel="noopener">https://github.com/rzwitserloot/lombok</a></p>
</blockquote>
<a id="more"></a>
<h2 id="2ã€Mavenå¼•å…¥">2ã€Mavenå¼•å…¥</h2>
<p>é™¤äº†å¼•å…¥mavenï¼Œè¿˜éœ€è¦å®‰è£…Lombokæ’ä»¶</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.18.12<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="3ã€æ³¨è§£ä»‹ç»">3ã€æ³¨è§£ä»‹ç»</h2>
<p><img src="https://img-blog.csdnimg.cn/20201023202423444.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xlbW9uX1RU,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<ul>
<li>
<p><code>@Getter /@Setter</code><br>
ä½œç”¨åœ¨å­—æ®µä¸Šï¼Œä¼šè‡ªåŠ¨ç”Ÿæˆå­—æ®µçš„Getterï¼›ä½œç”¨åœ¨ç±»ä¸Šï¼Œä¼šè‡ªåŠ¨ç”Ÿæˆè¯¥ç±»æ‰€æœ‰éé™æ€å­—æ®µçš„Getterï¼Œè¿˜èƒ½æ§åˆ¶Getterçš„è®¿é—®çº§åˆ«</p>
</li>
<li>
<p><code>@ToString</code><br>
ç±»æ³¨è§£ï¼Œè‡ªåŠ¨ç”Ÿæˆç±»çš„toStringæ–¹æ³•ï¼Œå¯ä»¥åšä¸€äº›å®šåˆ¶ï¼Œæ¯”å¦‚ä¸ä½¿ç”¨æŸä¸ªå­—æ®µï¼Œä¸è°ƒç”¨Gettersç­‰</p>
</li>
<li>
<p><code>@EqualsAndHashCode</code><br>
è‡ªåŠ¨ç”Ÿæˆ equals(Object other) å’Œ hashcode() æ–¹æ³•ï¼ŒåŒ…æ‹¬æ‰€æœ‰éé™æ€å˜é‡å’Œé transient çš„å˜é‡ï¼Œå¦‚æœæŸäº›å˜é‡ä¸æƒ³è¦åŠ è¿›åˆ¤æ–­ï¼Œå¯ä»¥é€è¿‡ exclude æ’é™¤ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ of æŒ‡å®šæŸäº›å­—æ®µ</p>
</li>
<li>
<p><code>@NoArgsConstructor, @AllArgsConstructor, @RequiredArgsConstructor</code><br>
@NoArgsConstructor ç±»æ³¨è§£ï¼Œè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªæ— å‚æ„é€ å‡½æ•°ã€‚<br>
@AllArgsConstructor ç±»æ³¨è§£ï¼Œç”Ÿæˆä¸€ä¸ªåˆå§‹åŒ–æ‰€æœ‰å­—æ®µçš„æ„é€ å‡½æ•°(åœ¨åŠ ä¸Š @AllArgsConstructor æ—¶ï¼Œä¸€å®šè¦è¡¥ä¸Š @NoArgsConstrcutor)<br>
@RequiredArgsConstructor : ç”Ÿæˆä¸€ä¸ªåŒ…å« â€œç‰¹å®šå‚æ•°â€ çš„æ„é€ å™¨ï¼Œç‰¹å®šå‚æ•°æŒ‡çš„æ˜¯é‚£äº›æœ‰åŠ ä¸Š final ä¿®é¥°è¯çš„å˜é‡ä»¬.</p>
</li>
<li>
<p><code>@Data</code><br>
ç›¸å½“äºåŒæ—¶åº”ç”¨äº†@Getterã€@Setterã€@ToStringã€@EqualsAndHashCodeã€@RequiredArgsConstructorã€‚å¦‚æœå·²ç»å®šä¹‰äº†ä¸€ä¸ªæ„é€ æ–¹æ³•ï¼Œå°±ä¸ä¼šå†è‡ªåŠ¨ç”Ÿæˆæ„é€ æ–¹æ³•äº†ã€‚</p>
</li>
<li>
<p><code>@Value</code><br>
å’Œ@Dataç±»ä¼¼ï¼Œä½†æ˜¯ç”¨äºä¸å¯å˜ç±»å‹ã€‚ç”Ÿæˆçš„ç±»å’Œæ‰€æœ‰å­—æ®µéƒ½è®¾ç½®ä¸ºfinalï¼Œæ‰€æœ‰å­—æ®µéƒ½ä¸ºprivateï¼Œè‡ªåŠ¨ç”ŸæˆGetterä½†æ˜¯æ²¡æœ‰Setterï¼Œä¼šç”Ÿæˆåˆå§‹åŒ–æ‰€æœ‰å­—æ®µçš„æ„é€ å‡½æ•°ã€‚ç›¸å½“äºåŒæ—¶åº”ç”¨äº†final @ToStringã€ @EqualsAndHashCodeã€ @AllArgsConstructor ã€@FieldDefaults(makeFinal = true, level = AccessLevel.PRIVATE)å’Œ @Getter</p>
</li>
<li>
<p><code>@Builder</code><br>
è‡ªåŠ¨ç”Ÿæˆæµå¼ set å€¼å†™æ³•ï¼Œä»æ­¤ä¹‹åå†ä¹Ÿä¸ç”¨å†™ä¸€å † setter äº†ã€‚æ³¨æ„ï¼Œè™½ç„¶åªè¦åŠ ä¸Š @Builder æ³¨è§£ï¼Œæˆ‘ä»¬å°±èƒ½å¤Ÿç”¨æµå¼å†™æ³•å¿«é€Ÿè®¾å®šå¯¹è±¡çš„å€¼ï¼Œä½†æ˜¯ setter è¿˜æ˜¯å¿…é¡»è¦å†™ä¸èƒ½çœç•¥çš„ï¼Œå› ä¸º Spring æˆ–æ˜¯å…¶ä»–æ¡†æ¶æœ‰å¾ˆå¤šåœ°æ–¹éƒ½ä¼šç”¨åˆ°å¯¹è±¡çš„ getter/setter å¯¹ä»–ä»¬å–å€¼/èµ‹å€¼ã€‚<br>
æ‰€ä»¥é€šå¸¸æ˜¯ @Data å’Œ @Builder ä¼šä¸€èµ·ç”¨åœ¨åŒä¸ªç±»ä¸Šï¼Œæ—¢æ–¹ä¾¿æˆ‘ä»¬æµå¼å†™ä»£ç ï¼Œä¹Ÿæ–¹ä¾¿æ¡†æ¶åšäº‹</p>
</li>
<li>
<p><code>@NotNull</code><br>
ä½œç”¨åœ¨æ–¹æ³•å‚æ•°ä¸Šçš„æ³¨è§£ï¼Œç”¨äºè‡ªåŠ¨ç”Ÿæˆç©ºå€¼å‚æ•°æ£€æŸ¥ã€‚</p>
</li>
<li>
<p><code>@Slf4j</code><br>
è‡ªåŠ¨ç”Ÿæˆè¯¥ç±»çš„ log é™æ€å¸¸é‡ï¼Œè¦æ‰“æ—¥å¿—å°±å¯ä»¥ç›´æ¥æ‰“ï¼Œä¸ç”¨å†æ‰‹åŠ¨ new log é™æ€å¸¸é‡äº†</p>
</li>
</ul>
<hr>
<p>å®é™…å¼€å‘ä¸­ä¸€èˆ¬å¸¸ç”¨åˆ°çš„:<br>
@Data<br>
@NoArgsConstructor<br>
@AllArgsConstructor</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Data</span>         <span class="comment">// ç”Ÿæˆ getter/setter/equals/canEqual/hashCode/toString        </span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span>     <span class="comment">// ä¸ºç±»æä¾›ä¸€ä¸ªæ— å‚çš„æ„é€ æ–¹æ³• </span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span>    <span class="comment">// ä¸ºç±»æä¾›ä¸€ä¸ªå…¨å‚çš„æ„é€ æ–¹æ³•</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Stu</span> </span>&#123;</span><br><span class="line">    String name;</span><br><span class="line">    <span class="keyword">int</span> weigh;</span><br><span class="line">    <span class="keyword">int</span> high;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¦‚æœè¦é“¾å¼è°ƒç”¨ï¼Œå¢åŠ æ³¨è§£<code>@Accessor(chain = true)</code>åå³å¯é“¾å¼ã€‚åŒæ—¶æ³¨æ„Lombokå¯èƒ½ä¼šäº§ç”Ÿä¸€å®šé—®é¢˜</p>
<hr>
<p>å‚è€ƒæ–‡ç« ï¼š<br>
<a href="https://www.cnblogs.com/ooo0/p/12448096.html" target="_blank" rel="noopener">https://www.cnblogs.com/ooo0/p/12448096.html</a></p>
]]></content>
      <categories>
        <category>Java</category>
      </categories>
      <tags>
        <tag>Lombok</tag>
      </tags>
  </entry>
  <entry>
    <title>Javaå®ç°ç”Ÿæˆå’Œè§£æäºŒç»´ç </title>
    <url>/posts/d5aff0bc.html</url>
    <content><![CDATA[<h2 id="1ã€å»ºç«‹é¡¹ç›®">1ã€å»ºç«‹é¡¹ç›®</h2>
<p>é¦–å…ˆéœ€è¦åˆ›å»ºä¸€ä¸ªæ™®é€šçš„ Maven é¡¹ç›®ï¼Œåœ¨è¿™é‡Œæˆ‘ç”¨çš„æ˜¯ google æä¾›çš„ jaråŒ…ï¼Œpom.xml æ–‡ä»¶é…ç½®å¦‚ä¸‹ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">"http://maven.apache.org/POM/4.0.0"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.javaboy<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>QRCode<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- æ·»åŠ  google æä¾›çš„äºŒç»´ç ä¾èµ– --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.google.zxing<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.3.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>å¦‚æœmavenæ²¡æœ‰ååº”ï¼Œå»ºè®®åˆ·æ–°ä¸€ä¸‹æˆ–è€…æ›´æ¢mavenæºï¼ˆæˆ‘ç”¨çš„å°±æ˜¯é˜¿é‡Œäº‘æºï¼‰</p>
</blockquote>
<a id="more"></a>
<h2 id="2ã€åˆ›å»ºå·¥å…·ç±»">2ã€åˆ›å»ºå·¥å…·ç±»</h2>
<p>è¿™é‡Œéœ€è¦åˆ›å»ºä¸¤ä¸ªå·¥å…·ç±»<code>BufferedImageLuminanceSource</code>å’Œ<code>QRCodeUtil</code>ç±»ã€‚é¡¹ç›®ç»“æ„å¦‚ä¸‹ï¼Œæˆ‘åˆ›å»ºçš„æ˜¯springbootçš„jaråŒ…ï¼Œå½“ç„¶å…¶ä»–çš„ä¹Ÿéƒ½å¯ä»¥çš„ã€‚<br>
<img src="https://img-blog.csdnimg.cn/2020101822193848.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xlbW9uX1RU,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<ul>
<li>å·¥å…·ç±»1 (BufferedImageLuminanceSource)</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.csdn.qrcode.util;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.google.zxing.LuminanceSource;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.awt.*;</span><br><span class="line"><span class="keyword">import</span> java.awt.geom.AffineTransform;</span><br><span class="line"><span class="keyword">import</span> java.awt.image.BufferedImage;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BufferedImageLuminanceSource</span> <span class="keyword">extends</span> <span class="title">LuminanceSource</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> BufferedImage image;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> left;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> top;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">BufferedImageLuminanceSource</span><span class="params">(BufferedImage image)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>(image, <span class="number">0</span>, <span class="number">0</span>, image.getWidth(), image.getHeight());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">BufferedImageLuminanceSource</span><span class="params">(BufferedImage image, <span class="keyword">int</span> left, <span class="keyword">int</span> top, <span class="keyword">int</span> width, <span class="keyword">int</span> height)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(width, height);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> sourceWidth = image.getWidth();</span><br><span class="line">        <span class="keyword">int</span> sourceHeight = image.getHeight();</span><br><span class="line">        <span class="keyword">if</span> (left + width &gt; sourceWidth || top + height &gt; sourceHeight) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"Crop rectangle does not fit within image data."</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> y = top; y &lt; top + height; y++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> x = left; x &lt; left + width; x++) &#123;</span><br><span class="line">                <span class="keyword">if</span> ((image.getRGB(x, y) &amp; <span class="number">0xFF000000</span>) == <span class="number">0</span>) &#123;</span><br><span class="line">                    image.setRGB(x, y, <span class="number">0xFFFFFFFF</span>); <span class="comment">// = white</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">this</span>.image = <span class="keyword">new</span> BufferedImage(sourceWidth, sourceHeight, BufferedImage.TYPE_BYTE_GRAY);</span><br><span class="line">        <span class="keyword">this</span>.image.getGraphics().drawImage(image, <span class="number">0</span>, <span class="number">0</span>, <span class="keyword">null</span>);</span><br><span class="line">        <span class="keyword">this</span>.left = left;</span><br><span class="line">        <span class="keyword">this</span>.top = top;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">byte</span>[] getRow(<span class="keyword">int</span> y, <span class="keyword">byte</span>[] row) &#123;</span><br><span class="line">        <span class="keyword">if</span> (y &lt; <span class="number">0</span> || y &gt;= getHeight()) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"Requested row is outside the image: "</span> + y);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> width = getWidth();</span><br><span class="line">        <span class="keyword">if</span> (row == <span class="keyword">null</span> || row.length &lt; width) &#123;</span><br><span class="line">            row = <span class="keyword">new</span> <span class="keyword">byte</span>[width];</span><br><span class="line">        &#125;</span><br><span class="line">        image.getRaster().getDataElements(left, top + y, width, <span class="number">1</span>, row);</span><br><span class="line">        <span class="keyword">return</span> row;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">byte</span>[] getMatrix() &#123;</span><br><span class="line">        <span class="keyword">int</span> width = getWidth();</span><br><span class="line">        <span class="keyword">int</span> height = getHeight();</span><br><span class="line">        <span class="keyword">int</span> area = width * height;</span><br><span class="line">        <span class="keyword">byte</span>[] matrix = <span class="keyword">new</span> <span class="keyword">byte</span>[area];</span><br><span class="line">        image.getRaster().getDataElements(left, top, width, height, matrix);</span><br><span class="line">        <span class="keyword">return</span> matrix;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isCropSupported</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> LuminanceSource <span class="title">crop</span><span class="params">(<span class="keyword">int</span> left, <span class="keyword">int</span> top, <span class="keyword">int</span> width, <span class="keyword">int</span> height)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> BufferedImageLuminanceSource(image, <span class="keyword">this</span>.left + left, <span class="keyword">this</span>.top + top, width, height);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isRotateSupported</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> LuminanceSource <span class="title">rotateCounterClockwise</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> sourceWidth = image.getWidth();</span><br><span class="line">        <span class="keyword">int</span> sourceHeight = image.getHeight();</span><br><span class="line">        AffineTransform transform = <span class="keyword">new</span> AffineTransform(<span class="number">0.0</span>, -<span class="number">1.0</span>, <span class="number">1.0</span>, <span class="number">0.0</span>, <span class="number">0.0</span>, sourceWidth);</span><br><span class="line">        BufferedImage rotatedImage = <span class="keyword">new</span> BufferedImage(sourceHeight, sourceWidth, BufferedImage.TYPE_BYTE_GRAY);</span><br><span class="line">        Graphics2D g = rotatedImage.createGraphics();</span><br><span class="line">        g.drawImage(image, transform, <span class="keyword">null</span>);</span><br><span class="line">        g.dispose();</span><br><span class="line">        <span class="keyword">int</span> width = getWidth();</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> BufferedImageLuminanceSource(rotatedImage, top, sourceWidth - (left + width), getHeight(), width);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>å·¥å…·ç±»2 (QRCodeUtil)<br>
è¿™é‡Œé¢å¯ä»¥ä¿®æ”¹ä¸€äº›å‚æ•°ï¼Œä¾‹å¦‚äºŒç»´ç çš„å°ºå¯¸ï¼Œå®½é«˜ç­‰ç­‰ã€‚</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.csdn.qrcode.util;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.google.zxing.*;</span><br><span class="line"><span class="keyword">import</span> com.google.zxing.common.BitMatrix;</span><br><span class="line"><span class="keyword">import</span> com.google.zxing.common.HybridBinarizer;</span><br><span class="line"><span class="keyword">import</span> com.google.zxing.qrcode.decoder.ErrorCorrectionLevel;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.imageio.ImageIO;</span><br><span class="line"><span class="keyword">import</span> java.awt.*;</span><br><span class="line"><span class="keyword">import</span> java.awt.geom.RoundRectangle2D;</span><br><span class="line"><span class="keyword">import</span> java.awt.image.BufferedImage;</span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.OutputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.Hashtable;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">QRCodeUtil</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String CHARSET = <span class="string">"utf-8"</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String FORMAT_NAME = <span class="string">"JPG"</span>;</span><br><span class="line">    <span class="comment">// äºŒç»´ç å°ºå¯¸</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> QRCODE_SIZE = <span class="number">300</span>;</span><br><span class="line">    <span class="comment">// LOGOå®½åº¦</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> WIDTH = <span class="number">60</span>;</span><br><span class="line">    <span class="comment">// LOGOé«˜åº¦</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> HEIGHT = <span class="number">60</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> BufferedImage <span class="title">createImage</span><span class="params">(String content, String imgPath, <span class="keyword">boolean</span> needCompress)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        Hashtable hints = <span class="keyword">new</span> Hashtable();</span><br><span class="line">        hints.put(EncodeHintType.ERROR_CORRECTION, ErrorCorrectionLevel.H);</span><br><span class="line">        hints.put(EncodeHintType.CHARACTER_SET, CHARSET);</span><br><span class="line">        hints.put(EncodeHintType.MARGIN, <span class="number">1</span>);</span><br><span class="line">        BitMatrix bitMatrix = <span class="keyword">new</span> MultiFormatWriter().encode(content, BarcodeFormat.QR_CODE, QRCODE_SIZE, QRCODE_SIZE,</span><br><span class="line">                hints);</span><br><span class="line">        <span class="keyword">int</span> width = bitMatrix.getWidth();</span><br><span class="line">        <span class="keyword">int</span> height = bitMatrix.getHeight();</span><br><span class="line">        BufferedImage image = <span class="keyword">new</span> BufferedImage(width, height, BufferedImage.TYPE_INT_RGB);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> x = <span class="number">0</span>; x &lt; width; x++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> y = <span class="number">0</span>; y &lt; height; y++) &#123;</span><br><span class="line">                image.setRGB(x, y, bitMatrix.get(x, y) ? <span class="number">0xFF000000</span> : <span class="number">0xFFFFFFFF</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (imgPath == <span class="keyword">null</span> || <span class="string">""</span>.equals(imgPath)) &#123;</span><br><span class="line">            <span class="keyword">return</span> image;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// æ’å…¥å›¾ç‰‡</span></span><br><span class="line">        QRCodeUtil.insertImage(image, imgPath, needCompress);</span><br><span class="line">        <span class="keyword">return</span> image;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">insertImage</span><span class="params">(BufferedImage source, String imgPath, <span class="keyword">boolean</span> needCompress)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        File file = <span class="keyword">new</span> File(imgPath);</span><br><span class="line">        <span class="keyword">if</span> (!file.exists()) &#123;</span><br><span class="line">            System.err.println(<span class="string">""</span> + imgPath + <span class="string">" è¯¥æ–‡ä»¶ä¸å­˜åœ¨ï¼"</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        Image src = ImageIO.read(<span class="keyword">new</span> File(imgPath));</span><br><span class="line">        <span class="keyword">int</span> width = src.getWidth(<span class="keyword">null</span>);</span><br><span class="line">        <span class="keyword">int</span> height = src.getHeight(<span class="keyword">null</span>);</span><br><span class="line">        <span class="keyword">if</span> (needCompress) &#123; <span class="comment">// å‹ç¼©LOGO</span></span><br><span class="line">            <span class="keyword">if</span> (width &gt; WIDTH) &#123;</span><br><span class="line">                width = WIDTH;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (height &gt; HEIGHT) &#123;</span><br><span class="line">                height = HEIGHT;</span><br><span class="line">            &#125;</span><br><span class="line">            Image image = src.getScaledInstance(width, height, Image.SCALE_SMOOTH);</span><br><span class="line">            BufferedImage tag = <span class="keyword">new</span> BufferedImage(width, height, BufferedImage.TYPE_INT_RGB);</span><br><span class="line">            Graphics g = tag.getGraphics();</span><br><span class="line">            g.drawImage(image, <span class="number">0</span>, <span class="number">0</span>, <span class="keyword">null</span>); <span class="comment">// ç»˜åˆ¶ç¼©å°åçš„å›¾</span></span><br><span class="line">            g.dispose();</span><br><span class="line">            src = image;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// æ’å…¥LOGO</span></span><br><span class="line">        Graphics2D graph = source.createGraphics();</span><br><span class="line">        <span class="keyword">int</span> x = (QRCODE_SIZE - width) / <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">int</span> y = (QRCODE_SIZE - height) / <span class="number">2</span>;</span><br><span class="line">        graph.drawImage(src, x, y, width, height, <span class="keyword">null</span>);</span><br><span class="line">        Shape shape = <span class="keyword">new</span> RoundRectangle2D.Float(x, y, width, width, <span class="number">6</span>, <span class="number">6</span>);</span><br><span class="line">        graph.setStroke(<span class="keyword">new</span> BasicStroke(<span class="number">3f</span>));</span><br><span class="line">        graph.draw(shape);</span><br><span class="line">        graph.dispose();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">encode</span><span class="params">(String content, String imgPath, String destPath, <span class="keyword">boolean</span> needCompress)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        BufferedImage image = QRCodeUtil.createImage(content, imgPath, needCompress);</span><br><span class="line">        mkdirs(destPath);</span><br><span class="line">        <span class="comment">// String file = new Random().nextInt(99999999)+".jpg";</span></span><br><span class="line">        <span class="comment">// ImageIO.write(image, FORMAT_NAME, new File(destPath+"/"+file));</span></span><br><span class="line">        ImageIO.write(image, FORMAT_NAME, <span class="keyword">new</span> File(destPath));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> BufferedImage <span class="title">encode</span><span class="params">(String content, String imgPath, <span class="keyword">boolean</span> needCompress)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        BufferedImage image = QRCodeUtil.createImage(content, imgPath, needCompress);</span><br><span class="line">        <span class="keyword">return</span> image;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">mkdirs</span><span class="params">(String destPath)</span> </span>&#123;</span><br><span class="line">        File file = <span class="keyword">new</span> File(destPath);</span><br><span class="line">        <span class="comment">// å½“æ–‡ä»¶å¤¹ä¸å­˜åœ¨æ—¶ï¼Œmkdirsä¼šè‡ªåŠ¨åˆ›å»ºå¤šå±‚ç›®å½•ï¼ŒåŒºåˆ«äºmkdirï¼(mkdirå¦‚æœçˆ¶ç›®å½•ä¸å­˜åœ¨åˆ™ä¼šæŠ›å‡ºå¼‚å¸¸)</span></span><br><span class="line">        <span class="keyword">if</span> (!file.exists() &amp;&amp; !file.isDirectory()) &#123;</span><br><span class="line">            file.mkdirs();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">encode</span><span class="params">(String content, String imgPath, String destPath)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        QRCodeUtil.encode(content, imgPath, destPath, <span class="keyword">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// è¢«æ³¨é‡Šçš„æ–¹æ³•</span></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     * public static void encode(String content, String destPath, boolean</span></span><br><span class="line"><span class="comment">     * needCompress) throws Exception &#123; QRCodeUtil.encode(content, null, destPath,</span></span><br><span class="line"><span class="comment">     * needCompress); &#125;</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">encode</span><span class="params">(String content, String destPath)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        QRCodeUtil.encode(content, <span class="keyword">null</span>, destPath, <span class="keyword">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">encode</span><span class="params">(String content, String imgPath, OutputStream output, <span class="keyword">boolean</span> needCompress)</span></span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        BufferedImage image = QRCodeUtil.createImage(content, imgPath, needCompress);</span><br><span class="line">        ImageIO.write(image, FORMAT_NAME, output);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">encode</span><span class="params">(String content, OutputStream output)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        QRCodeUtil.encode(content, <span class="keyword">null</span>, output, <span class="keyword">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">decode</span><span class="params">(File file)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        BufferedImage image;</span><br><span class="line">        image = ImageIO.read(file);</span><br><span class="line">        <span class="keyword">if</span> (image == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        BufferedImageLuminanceSource source = <span class="keyword">new</span> BufferedImageLuminanceSource(image);</span><br><span class="line">        BinaryBitmap bitmap = <span class="keyword">new</span> BinaryBitmap(<span class="keyword">new</span> HybridBinarizer(source));</span><br><span class="line">        Result result;</span><br><span class="line">        Hashtable hints = <span class="keyword">new</span> Hashtable();</span><br><span class="line">        hints.put(DecodeHintType.CHARACTER_SET, CHARSET);</span><br><span class="line">        result = <span class="keyword">new</span> MultiFormatReader().decode(bitmap, hints);</span><br><span class="line">        String resultStr = result.getText();</span><br><span class="line">        <span class="keyword">return</span> resultStr;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">decode</span><span class="params">(String path)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> QRCodeUtil.decode(<span class="keyword">new</span> File(path));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="3ã€åˆ›å»ºå¯åŠ¨ç±»">3ã€åˆ›å»ºå¯åŠ¨ç±»</h2>
<p>è¿™ä¸€æ­¥å°±æ˜¯è°ƒç”¨æ–¹æ³•ï¼Œä¸€èˆ¬å¤§å®¶ä½¿ç”¨è¿™ç§åŠŸèƒ½éƒ½æ˜¯ä¸ºäº†å®ç°ä¸šåŠ¡ï¼Œä¾‹å¦‚å¸¸è§çš„æ‰«æäºŒç»´ç è·³è½¬é“¾æ¥ï¼ˆé¡µé¢ï¼‰ï¼Œæ‰«æäºŒç»´ç å‡ºç°æ–‡å­—ç­‰ç­‰ã€‚æœ‰äº›äºŒç»´ç ä¸­é—´è¿˜å¸¦æœ‰ Logo è¿™ç§å›¾ç‰‡ï¼Œå°†éœ€è¦åµŒå…¥äºŒç»´ç çš„å›¾ç‰‡è·¯å¾„å‡†å¤‡å¥½å°±æ²¡æœ‰é—®é¢˜ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.csdn.qrcode;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.csdn.qrcode.util.QRCodeUtil;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">QrcodeApplication</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">// å­˜æ”¾åœ¨äºŒç»´ç ä¸­çš„å†…å®¹</span></span><br><span class="line">        <span class="comment">// äºŒç»´ç ä¸­çš„å†…å®¹å¯ä»¥æ˜¯æ–‡å­—ï¼Œå¯ä»¥æ˜¯é“¾æ¥ç­‰</span></span><br><span class="line">        String text = <span class="string">"http://www.baidu.com"</span>;</span><br><span class="line">        <span class="comment">// åµŒå…¥äºŒç»´ç çš„å›¾ç‰‡è·¯å¾„</span></span><br><span class="line">        <span class="comment">// String imgPath = "C:\\Users\\Administrator\\Pictures\\img\\dog.jpg";</span></span><br><span class="line">        String imgPath = <span class="string">"picture/lemon.jpg"</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ç”Ÿæˆçš„äºŒç»´ç çš„è·¯å¾„åŠåç§°</span></span><br><span class="line">        String destPath = <span class="string">"picture/"</span> + System.currentTimeMillis() + <span class="string">".jpg"</span>;</span><br><span class="line">        <span class="comment">//ç”Ÿæˆä¸å¸¦logoçš„äºŒç»´ç </span></span><br><span class="line">        <span class="comment">// QRCodeUtil.encode(text, null, destPath, true);</span></span><br><span class="line">        <span class="comment">//ç”Ÿæˆå¸¦logoçš„äºŒç»´ç </span></span><br><span class="line">        QRCodeUtil.encode(text, imgPath, destPath, <span class="keyword">true</span>);</span><br><span class="line">        <span class="comment">// è§£æäºŒç»´ç </span></span><br><span class="line">        String str = QRCodeUtil.decode(destPath);</span><br><span class="line">        <span class="comment">// æ‰“å°å‡ºè§£æå‡ºçš„å†…å®¹</span></span><br><span class="line">        System.out.println(str);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç»“æœ:<br>
<img src="https://img-blog.csdnimg.cn/20201018222534856.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xlbW9uX1RU,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<hr>
<p>å‚è€ƒæ–‡ç« ï¼š<br>
<a href="https://gitee.com/jian_bo_bai/QRCode" target="_blank" rel="noopener">https://gitee.com/jian_bo_bai/QRCode</a></p>
]]></content>
      <categories>
        <category>Java</category>
      </categories>
      <tags>
        <tag>äºŒç»´ç </tag>
      </tags>
  </entry>
  <entry>
    <title>Java8 æ—¥æœŸæ—¶é—´ç±»æ•´ç†</title>
    <url>/posts/1af375c2.html</url>
    <content><![CDATA[<blockquote>
<p>å½“æˆ‘ä»¬å¼€å§‹ä½¿â½¤Javaæ“ä½œâ½‡æœŸå’Œæ—¶é—´çš„æ—¶å€™ï¼Œä¼šæœ‰â¼€äº›æ£˜â¼¿ã€‚ä½ ä¹Ÿè®¸ä¼šé€šè¿‡ System.currentTimeMillis() æ¥è¿”å›1970å¹´1â½‰1â½‡åˆ°ä»Šå¤©çš„æ¯«ç§’æ•°ã€‚æˆ–è€…ä½¿â½¤ Dateç±»æ¥æ“ä½œâ½‡æœŸï¼›å½“é‡åˆ°åŠ å‡â½‰ä»½ã€å¤©æ•°çš„æ—¶å€™ ä½ â¼œéœ€è¦â½¤åˆ°Calendarç±»ï¼› å½“éœ€è¦æ ¼å¼åŒ–â½‡æœŸçš„æ—¶å€™éœ€è¦ä½¿â½¤java.text.DateFormatç±»ã€‚</p>
</blockquote>
<a id="more"></a>
<h1>ä¸€ã€Dateç±»å‹å­˜åœ¨çš„é—®é¢˜</h1>
<ul>
<li>
<p>ç»“æ„å®šä¹‰æ··ä¹±</p>
<ul>
<li>java.util DateåŒ…å«æ—¥æœŸæ—¶é—´</li>
<li>java.sql DateåŒ…å«æ—¥æœŸ</li>
<li>java.text æ—¶é—´æ ¼å¼åŒ–</li>
</ul>
</li>
<li>
<p>APIä¸æ˜“ç”¨</p>
</li>
<li>
<p>éçº¿ç¨‹å®‰å…¨</p>
<ul>
<li>å¯å˜ï¼ŒSimpleDateFormate</li>
</ul>
</li>
<li>
<p>å›½é™…åŒ–</p>
<ul>
<li>Calendar TimeZone</li>
</ul>
<p><code>Date</code>å¦‚æœä¸æ ¼å¼åŒ–ï¼Œæ‰“å°å‡ºçš„æ—¥æœŸå¯è¯»æ€§å·®</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Tue Sep <span class="number">10</span> <span class="number">09</span>:<span class="number">34</span>:<span class="number">04</span> CST <span class="number">2020</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h1>äºŒã€Java8æ–°çš„æ—¥æœŸæ—¶é—´ç±»</h1>
<h2 id="1ã€LocalDate">1ã€LocalDate</h2>
<p>åªä¼šè·å–å¹´æœˆæ—¥</p>
<ul>
<li>åˆ›å»º<code>LocalDate</code></li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//è·å–å½“å‰å¹´æœˆæ—¥  </span></span><br><span class="line">LocalDate localDate = LocalDate.now();  </span><br><span class="line"><span class="comment">//æ„é€ æŒ‡å®šçš„å¹´æœˆæ—¥  </span></span><br><span class="line">LocalDate localDate1 = LocalDate.of(<span class="number">2020</span>, <span class="number">10</span>, <span class="number">10</span>);</span><br></pre></td></tr></table></figure>
<ul>
<li>è·å–å¹´ã€æœˆã€æ—¥ã€æ˜ŸæœŸå‡ </li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//è·å–å¹´</span></span><br><span class="line"><span class="keyword">int</span> year = localDate.getYear();  </span><br><span class="line"><span class="keyword">int</span> year1 = localDate.get(ChronoField.YEAR);  </span><br><span class="line"><span class="comment">//è·å–æœˆä»½</span></span><br><span class="line">Month month = localDate.getMonth();  </span><br><span class="line"><span class="keyword">int</span> month1 = localDate.get(ChronoField.MONTH_OF_YEAR);  </span><br><span class="line"><span class="comment">//è·å–å¤©</span></span><br><span class="line"><span class="keyword">int</span> day = localDate.getDayOfMonth();  </span><br><span class="line"><span class="keyword">int</span> day1 = localDate.get(ChronoField.DAY_OF_MONTH);  </span><br><span class="line"><span class="comment">//è·å–æ˜ŸæœŸå‡ </span></span><br><span class="line">DayOfWeek dayOfWeek = localDate.getDayOfWeek();  </span><br><span class="line"><span class="keyword">int</span> dayOfWeek1 = localDate.get(ChronoField.DAY_OF_WEEK);</span><br></pre></td></tr></table></figure>
<h2 id="2ã€LocalTime">2ã€LocalTime</h2>
<p>åªä¼šè·å–å‡ ç‚¹å‡ åˆ†å‡ ç§’</p>
<ul>
<li>åˆ›å»º<code>LocalTime</code></li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">LocalTime localTime = LocalTime.of(<span class="number">13</span>, <span class="number">51</span>, <span class="number">10</span>);  </span><br><span class="line">LocalTime localTime1 = LocalTime.now();</span><br></pre></td></tr></table></figure>
<ul>
<li>è·å–æ—¶åˆ†ç§’</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//è·å–å°æ—¶  </span></span><br><span class="line"><span class="keyword">int</span> hour = localTime.getHour();  </span><br><span class="line"><span class="keyword">int</span> hour1 = localTime.get(ChronoField.HOUR_OF_DAY);  </span><br><span class="line"><span class="comment">//è·å–åˆ†  </span></span><br><span class="line"><span class="keyword">int</span> minute = localTime.getMinute();  </span><br><span class="line"><span class="keyword">int</span> minute1 = localTime.get(ChronoField.MINUTE_OF_HOUR);  </span><br><span class="line"><span class="comment">//è·å–ç§’  </span></span><br><span class="line"><span class="keyword">int</span> second = localTime.getSecond();  </span><br><span class="line"><span class="keyword">int</span> second1 = localTime.get(ChronoField.SECOND_OF_MINUTE);</span><br></pre></td></tr></table></figure>
<h2 id="3ã€LocalDateTime">3ã€LocalDateTime</h2>
<p>è·å–å¹´æœˆæ—¥æ—¶åˆ†ç§’ï¼Œç­‰äºLocalDate+LocalTime</p>
<ul>
<li>åˆ›å»º<code>LocalDateTime</code></li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">LocalDateTime localDateTime = LocalDateTime.now();  </span><br><span class="line">LocalDateTime localDateTime1 = LocalDateTime.of(<span class="number">2020</span>, Month.SEPTEMBER, <span class="number">10</span>, <span class="number">14</span>, <span class="number">46</span>, <span class="number">56</span>);  </span><br><span class="line">LocalDateTime localDateTime2 = LocalDateTime.of(localDate, localTime);  </span><br><span class="line">LocalDateTime localDateTime3 = localDate.atTime(localTime);  </span><br><span class="line">LocalDateTime localDateTime4 = localTime.atDate(localDate);</span><br></pre></td></tr></table></figure>
<ul>
<li>è·å–<code>LocalDate</code></li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">LocalDate localDate2 = localDateTime.toLocalDate();</span><br></pre></td></tr></table></figure>
<ul>
<li>è·å–<code>LocalTime</code></li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">LocalTime localTime2 = localDateTime.toLocalTime();</span><br></pre></td></tr></table></figure>
<h2 id="4ã€Instant">4ã€Instant</h2>
<p>è·å–ç§’æ•°</p>
<ul>
<li>åˆ›å»º<code>Instant</code>å¯¹è±¡</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Instant instant = Instant.now();</span><br></pre></td></tr></table></figure>
<ul>
<li>è·å–ç§’æ•°</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">long</span> currentSecond = instant.getEpochSecond();</span><br></pre></td></tr></table></figure>
<ul>
<li>è·å–æ¯«ç§’æ•°</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">long</span> currentMilli = instant.toEpochMilli();</span><br></pre></td></tr></table></figure>
<blockquote>
<p>å¦‚æœåªæ˜¯ä¸ºäº†è·å–ç§’æ•°æˆ–è€…æ¯«ç§’æ•°ï¼Œä½¿ç”¨<code>System.currentTimeMillis()</code>æ¥å¾—æ›´ä¸ºæ–¹ä¾¿</p>
</blockquote>
<h1>ä¸‰ã€æ—¥æœŸæ—¶é—´çš„ä¿®æ”¹ä¸è®¡ç®—</h1>
<p><strong><code>LocalDate</code>ã€<code>LocalTime</code>ã€<code>LocalDateTime</code>ã€<code>Instant</code>ä¸º</strong>ä¸å¯å˜å¯¹è±¡**ï¼Œä¿®æ”¹è¿™äº›å¯¹è±¡å¯¹è±¡ä¼š**è¿”å›ä¸€ä¸ªå‰¯æœ¬****</p>
<h2 id="1ã€æ—¶é—´ä¿®æ”¹">1ã€æ—¶é—´ä¿®æ”¹</h2>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">LocalDateTime localDateTime = LocalDateTime.of(<span class="number">2020</span>, Month.SEPTEMBER, <span class="number">10</span>,  </span><br><span class="line">              <span class="number">14</span>, <span class="number">46</span>, <span class="number">56</span>);  </span><br><span class="line"><span class="comment">//å¢åŠ ä¸€å¹´  </span></span><br><span class="line">localDateTime = localDateTime.plusYears(<span class="number">1</span>);  </span><br><span class="line">localDateTime = localDateTime.plus(<span class="number">1</span>, ChronoUnit.YEARS);  </span><br><span class="line"><span class="comment">//å‡å°‘ä¸€ä¸ªæœˆ  </span></span><br><span class="line">localDateTime = localDateTime.minusMonths(<span class="number">1</span>);  </span><br><span class="line">localDateTime = localDateTime.minus(<span class="number">1</span>, ChronoUnit.MONTHS);  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//ä½¿ç”¨withè¿›è¡Œä¿®æ”¹</span></span><br><span class="line"><span class="comment">//ä¿®æ”¹å¹´ä¸º2020</span></span><br><span class="line">localDateTime = localDateTime.withYear(<span class="number">2020</span>);  </span><br><span class="line"><span class="comment">//ä¿®æ”¹ä¸º2022  </span></span><br><span class="line">localDateTime = localDateTime.with(ChronoField.YEAR, <span class="number">2022</span>);</span><br></pre></td></tr></table></figure>
<p>å¦å¤–æ¯”å¦‚æœ‰äº›æ—¶å€™æƒ³çŸ¥é“è¿™ä¸ªæœˆçš„æœ€åä¸€å¤©æ˜¯å‡ å·ã€ä¸‹ä¸ªå‘¨æœ«æ˜¯å‡ å·ï¼Œé€šè¿‡æä¾›çš„æ—¶é—´å’Œæ—¥æœŸAPIå¯ä»¥å¾ˆå¿«å¾—åˆ°ç­”æ¡ˆï¼Œæ¯”å¦‚é€šè¿‡<code>firstDayOfYear()</code>è¿”å›äº†å½“å‰æ—¥æœŸçš„ç¬¬ä¸€å¤©æ—¥æœŸ</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">LocalDate localDate = LocalDate.now();  </span><br><span class="line">LocalDate localDate1 = localDate.with(firstDayOfYear());</span><br></pre></td></tr></table></figure>
<h2 id="2ã€æ ¼å¼åŒ–æ—¥æœŸ-å¸¸ç”¨">2ã€æ ¼å¼åŒ–æ—¥æœŸ(å¸¸ç”¨)</h2>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">LocalDate localDate = LocalDate.of(<span class="number">2020</span>, <span class="number">10</span>, <span class="number">10</span>);  </span><br><span class="line">String s1 = localDate.format(DateTimeFormatter.BASIC_ISO_DATE);  </span><br><span class="line">String s2 = localDate.format(DateTimeFormatter.ISO_LOCAL_DATE);  </span><br><span class="line"><span class="comment">//è‡ªå®šä¹‰æ ¼å¼åŒ–  </span></span><br><span class="line">DateTimeFormatter dateTimeFormatter =   DateTimeFormatter.ofPattern(<span class="string">"dd/MM/yyyy"</span>);  </span><br><span class="line">String s3 = localDate.format(dateTimeFormatter);</span><br></pre></td></tr></table></figure>
<p><code>DateTimeFormatter</code>é»˜è®¤æä¾›äº†å¤šç§æ ¼å¼åŒ–æ–¹å¼ï¼Œå¦‚æœé»˜è®¤æä¾›çš„ä¸èƒ½æ»¡è¶³è¦æ±‚ï¼Œå¯ä»¥é€šè¿‡<code>DateTimeFormatter</code>çš„<code>ofPattern</code>æ–¹æ³•åˆ›å»ºè‡ªå®šä¹‰æ ¼å¼åŒ–æ–¹å¼</p>
<h4 id="è§£ææ—¶é—´">è§£ææ—¶é—´</h4>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">LocalDate localDate1 = LocalDate.parse(<span class="string">"20201010"</span>, DateTimeFormatter.BASIC_ISO_DATE);  </span><br><span class="line">LocalDate localDate2 = LocalDate.parse(<span class="string">"2020-10-10"</span>, DateTimeFormatter.ISO_LOCAL_DATE);</span><br></pre></td></tr></table></figure>
<p>å’Œ<code>SimpleDateFormat</code>ç›¸æ¯”ï¼Œ<code>DateTimeFormatter</code>æ˜¯çº¿ç¨‹å®‰å…¨çš„</p>
<h1>å››ã€LocalDateTimeåœ¨SpringBootä¸­çš„åº”ç”¨</h1>
<h2 id="1ã€å°†LocalDateTimeå­—æ®µä»¥æ—¶é—´æˆ³çš„æ–¹å¼è¿”å›ç»™å‰ç«¯-æ·»åŠ æ—¥æœŸè½¬åŒ–ç±»">1ã€å°†LocalDateTimeå­—æ®µä»¥æ—¶é—´æˆ³çš„æ–¹å¼è¿”å›ç»™å‰ç«¯ æ·»åŠ æ—¥æœŸè½¬åŒ–ç±»</h2>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LocalDateTimeConverter</span> <span class="keyword">extends</span> <span class="title">JsonSerializer</span>&lt;<span class="title">LocalDateTime</span>&gt; </span>&#123;  </span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span>  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">serialize</span><span class="params">(LocalDateTime value, JsonGenerator gen, SerializerProvider serializers)</span> <span class="keyword">throws</span> IOException </span>&#123;  </span><br><span class="line">    gen.writeNumber(value.toInstant(ZoneOffset.of(<span class="string">"+8"</span>)).toEpochMilli());  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¹¶åœ¨<code>LocalDateTime </code> å­—æ®µä¸Šæ·»åŠ <code>@JsonSerialize(using = LocalDateTimeConverter.class) </code> æ³¨è§£ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@JsonSerialize</span>(using = LocalDateTimeConverter<span class="class">.<span class="keyword">class</span>)  </span></span><br><span class="line"><span class="class"><span class="title">protected</span> <span class="title">LocalDateTime</span> <span class="title">gmtModified</span></span>;</span><br></pre></td></tr></table></figure>
<h2 id="2ã€å°†LocalDateTimeå­—æ®µä»¥æŒ‡å®šæ ¼å¼åŒ–æ—¥æœŸçš„æ–¹å¼è¿”å›ç»™å‰ç«¯">2ã€å°†LocalDateTimeå­—æ®µä»¥æŒ‡å®šæ ¼å¼åŒ–æ—¥æœŸçš„æ–¹å¼è¿”å›ç»™å‰ç«¯</h2>
<p>åœ¨<code>LocalDateTime </code>å­—æ®µä¸Šæ·»åŠ <code>@JsonFormat(shape=JsonFormat.Shape.STRING, pattern=&quot;yyyy-MM-dd HH:mm:ss&quot;) </code>æ³¨è§£å³å¯ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@JsonFormat</span>(shape=JsonFormat.Shape.STRING, pattern=<span class="string">"yyyy-MM-dd HH:mm:ss"</span>)  </span><br><span class="line"><span class="keyword">protected</span> LocalDateTime gmtModified;</span><br></pre></td></tr></table></figure>
<h2 id="3ã€å¯¹å‰ç«¯ä¼ å…¥çš„æ—¥æœŸè¿›è¡Œæ ¼å¼åŒ–">3ã€å¯¹å‰ç«¯ä¼ å…¥çš„æ—¥æœŸè¿›è¡Œæ ¼å¼åŒ–</h2>
<p>åœ¨<code>LocalDateTime</code>å­—æ®µä¸Šæ·»åŠ <code>@DateTimeFormat(pattern = &quot;yyyy-MM-dd HH:mm:ss&quot;) </code>æ³¨è§£å³å¯ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@DateTimeFormat</span>(pattern = <span class="string">"yyyy-MM-dd HH:mm:ss"</span>)  </span><br><span class="line"><span class="keyword">protected</span> LocalDateTime gmtModified;</span><br></pre></td></tr></table></figure>
<h2 id="4ã€å‰åç«¯æ—¥æœŸæ—¶é—´è½¬åŒ–é—®é¢˜">4ã€å‰åç«¯æ—¥æœŸæ—¶é—´è½¬åŒ–é—®é¢˜</h2>
<ul>
<li><strong>æ–¹å¼ä¸€</strong></li>
</ul>
<p>åœ¨å®ä½“ç±»ä¸ŠåŠ <code>@DatetimeFormat</code>ä¸<code>@JsonFormat</code>æ³¨è§£</p>
<p><code>@DatetimeFormat</code>å°†å‰å°æ—¥æœŸå­—ç¬¦ä¸²è½¬æ¢æˆDateæ ¼å¼ <code>@DateTimeFormat(pattern=&quot;yyyy-MM-dd&quot;)</code></p>
<p><code>@JsonFormat</code>å°†æœåŠ¡å™¨ç«¯Dateæ—¥æœŸè½¬æ¢æˆæŒ‡å®šå­—ç¬¦ä¸²æ ¼å¼<code> @JsonFormat(pattern=&quot;yyyy-MM-dd&quot;,timezone=&quot;GMT+8&quot;)</code></p>
<p><strong>ä¸¤ä¸ªéœ€è¦åŒæ—¶åŠ ï¼Œå¦åˆ™ä¼šæœ‰æ—¶åŒºçš„é—®é¢˜</strong></p>
<ul>
<li><strong>æ–¹å¼äºŒ</strong></li>
</ul>
<p>åœ¨applicition.propertiesä¸­æ·»åŠ å¦‚ä¸‹é…ç½®</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">#æ—¶é—´æˆ³ç»Ÿä¸€è½¬æ¢</span><br><span class="line">spring.jackson.date-format=yyyy-MM-dd HH:mm:ss</span><br><span class="line">spring.jackson.time-zone=GMT+8</span><br></pre></td></tr></table></figure>
<p>æˆ–è€…åœ¨application.ymlä¸­æ·»åŠ å¦‚ä¸‹é…ç½®</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">#æ—¶é—´æˆ³ç»Ÿä¸€è½¬æ¢</span><br><span class="line">spring:</span><br><span class="line">  jackson:</span><br><span class="line">    date-format: yyyy-MM-dd HH:mm:ss</span><br><span class="line">    time-zone: GMT+<span class="number">8</span></span><br></pre></td></tr></table></figure>
<hr>
<p>å‚è€ƒæ–‡ç« ï¼š</p>
<p><a href="https://www.cnblogs.com/w-essay/p/11453943.html" target="_blank" rel="noopener">https://www.cnblogs.com/w-essay/p/11453943.html</a></p>
<p><a href="https://mp.weixin.qq.com/s/7LzRjG_uGjXq5yIwiSnV2w" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/7LzRjG_uGjXq5yIwiSnV2w</a></p>
]]></content>
      <categories>
        <category>Java</category>
      </categories>
      <tags>
        <tag>springboot</tag>
      </tags>
  </entry>
  <entry>
    <title>gitå‘½ä»¤æ¸…å•</title>
    <url>/posts/2163f62e.html</url>
    <content><![CDATA[<p>ä¸€èˆ¬æ¥è¯´ï¼Œæ—¥å¸¸ä½¿ç”¨åªè¦è®°ä½ä¸‹å›¾6ä¸ªå‘½ä»¤ï¼Œå°±å¯ä»¥äº†ã€‚ä½†æ˜¯ç†Ÿç»ƒä½¿ç”¨ï¼Œææ€•è¦è®°ä½60ï½100ä¸ªå‘½ä»¤ã€‚<br>
<img src="https://img-blog.csdnimg.cn/20201016212956605.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xlbW9uX1RU,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<ul>
<li>Workspaceï¼šå·¥ä½œåŒº</li>
<li>Index / Stageï¼šæš‚å­˜åŒº</li>
<li>Repositoryï¼šä»“åº“åŒºï¼ˆæˆ–æœ¬åœ°ä»“åº“ï¼‰</li>
<li>Remoteï¼šè¿œç¨‹ä»“åº“</li>
</ul>
<hr>
<a id="more"></a>
<h2 id="ä¸€ã€æ–°å»ºä»£ç åº“">ä¸€ã€æ–°å»ºä»£ç åº“</h2>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># åœ¨å½“å‰ç›®å½•æ–°å»ºä¸€ä¸ªGitä»£ç åº“</span><br><span class="line">$ git init</span><br><span class="line"></span><br><span class="line"># æ–°å»ºä¸€ä¸ªç›®å½•ï¼Œå°†å…¶åˆå§‹åŒ–ä¸ºGitä»£ç åº“</span><br><span class="line">$ git init [project-name]</span><br><span class="line"></span><br><span class="line"># ä¸‹è½½ä¸€ä¸ªé¡¹ç›®å’Œå®ƒçš„æ•´ä¸ªä»£ç å†å²</span><br><span class="line">$ git clone [url]</span><br></pre></td></tr></table></figure>
<h2 id="äºŒã€é…ç½®">äºŒã€é…ç½®</h2>
<p>Gitçš„è®¾ç½®æ–‡ä»¶ä¸º.gitconfigï¼Œå®ƒå¯ä»¥åœ¨ç”¨æˆ·ä¸»ç›®å½•ä¸‹ï¼ˆå…¨å±€é…ç½®ï¼‰ï¼Œä¹Ÿå¯ä»¥åœ¨é¡¹ç›®ç›®å½•ä¸‹ï¼ˆé¡¹ç›®é…ç½®ï¼‰ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># åœ¨å½“å‰ç›®å½•æ–°å»ºä¸€ä¸ªGitä»£ç åº“</span><br><span class="line">$ git init</span><br><span class="line"></span><br><span class="line"># æ–°å»ºä¸€ä¸ªç›®å½•ï¼Œå°†å…¶åˆå§‹åŒ–ä¸ºGitä»£ç åº“</span><br><span class="line">$ git init [project-name]</span><br><span class="line"></span><br><span class="line"># ä¸‹è½½ä¸€ä¸ªé¡¹ç›®å’Œå®ƒçš„æ•´ä¸ªä»£ç å†å²</span><br><span class="line">$ git clone [url]</span><br></pre></td></tr></table></figure>
<h2 id="ä¸‰ã€å¢åŠ -åˆ é™¤æ–‡ä»¶">ä¸‰ã€å¢åŠ /åˆ é™¤æ–‡ä»¶</h2>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># æ·»åŠ æŒ‡å®šæ–‡ä»¶åˆ°æš‚å­˜åŒº</span><br><span class="line">$ git add [file1] [file2] ...</span><br><span class="line"></span><br><span class="line"># æ·»åŠ æŒ‡å®šç›®å½•åˆ°æš‚å­˜åŒºï¼ŒåŒ…æ‹¬å­ç›®å½•</span><br><span class="line">$ git add [dir]</span><br><span class="line"></span><br><span class="line"># æ·»åŠ å½“å‰ç›®å½•çš„æ‰€æœ‰æ–‡ä»¶åˆ°æš‚å­˜åŒº</span><br><span class="line">$ git add .</span><br><span class="line"></span><br><span class="line"># æ·»åŠ æ¯ä¸ªå˜åŒ–å‰ï¼Œéƒ½ä¼šè¦æ±‚ç¡®è®¤</span><br><span class="line"># å¯¹äºåŒä¸€ä¸ªæ–‡ä»¶çš„å¤šå¤„å˜åŒ–ï¼Œå¯ä»¥å®ç°åˆ†æ¬¡æäº¤</span><br><span class="line">$ git add -p</span><br><span class="line"></span><br><span class="line"># åˆ é™¤å·¥ä½œåŒºæ–‡ä»¶ï¼Œå¹¶ä¸”å°†è¿™æ¬¡åˆ é™¤æ”¾å…¥æš‚å­˜åŒº</span><br><span class="line">$ git rm [file1] [file2] ...</span><br><span class="line"></span><br><span class="line"># åœæ­¢è¿½è¸ªæŒ‡å®šæ–‡ä»¶ï¼Œä½†è¯¥æ–‡ä»¶ä¼šä¿ç•™åœ¨å·¥ä½œåŒº</span><br><span class="line">$ git rm --cached [file]</span><br><span class="line"></span><br><span class="line"># æ”¹åæ–‡ä»¶ï¼Œå¹¶ä¸”å°†è¿™ä¸ªæ”¹åæ”¾å…¥æš‚å­˜åŒº</span><br><span class="line">$ git mv [file-original] [file-renamed]</span><br></pre></td></tr></table></figure>
<h2 id="å››ã€ä»£ç æäº¤">å››ã€ä»£ç æäº¤</h2>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># æäº¤æš‚å­˜åŒºåˆ°ä»“åº“åŒº</span><br><span class="line">$ git commit -m [message]</span><br><span class="line"></span><br><span class="line"># æäº¤æš‚å­˜åŒºçš„æŒ‡å®šæ–‡ä»¶åˆ°ä»“åº“åŒº</span><br><span class="line">$ git commit [file1] [file2] ... -m [message]</span><br><span class="line"></span><br><span class="line"># æäº¤å·¥ä½œåŒºè‡ªä¸Šæ¬¡commitä¹‹åçš„å˜åŒ–ï¼Œç›´æ¥åˆ°ä»“åº“åŒº</span><br><span class="line">$ git commit -a</span><br><span class="line"></span><br><span class="line"># æäº¤æ—¶æ˜¾ç¤ºæ‰€æœ‰diffä¿¡æ¯</span><br><span class="line">$ git commit -v</span><br><span class="line"></span><br><span class="line"># ä½¿ç”¨ä¸€æ¬¡æ–°çš„commitï¼Œæ›¿ä»£ä¸Šä¸€æ¬¡æäº¤</span><br><span class="line"># å¦‚æœä»£ç æ²¡æœ‰ä»»ä½•æ–°å˜åŒ–ï¼Œåˆ™ç”¨æ¥æ”¹å†™ä¸Šä¸€æ¬¡commitçš„æäº¤ä¿¡æ¯</span><br><span class="line">$ git commit --amend -m [message]</span><br><span class="line"></span><br><span class="line"># é‡åšä¸Šä¸€æ¬¡commitï¼Œå¹¶åŒ…æ‹¬æŒ‡å®šæ–‡ä»¶çš„æ–°å˜åŒ–</span><br><span class="line">$ git commit --amend [file1] [file2] ...</span><br></pre></td></tr></table></figure>
<h2 id="äº”ã€åˆ†æ”¯">äº”ã€åˆ†æ”¯</h2>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># åˆ—å‡ºæ‰€æœ‰æœ¬åœ°åˆ†æ”¯</span><br><span class="line">$ git branch</span><br><span class="line"></span><br><span class="line"># åˆ—å‡ºæ‰€æœ‰è¿œç¨‹åˆ†æ”¯</span><br><span class="line">$ git branch -r</span><br><span class="line"></span><br><span class="line"># åˆ—å‡ºæ‰€æœ‰æœ¬åœ°åˆ†æ”¯å’Œè¿œç¨‹åˆ†æ”¯</span><br><span class="line">$ git branch -a</span><br><span class="line"></span><br><span class="line"># æ–°å»ºä¸€ä¸ªåˆ†æ”¯ï¼Œä½†ä¾ç„¶åœç•™åœ¨å½“å‰åˆ†æ”¯</span><br><span class="line">$ git branch [branch-name]</span><br><span class="line"></span><br><span class="line"># æ–°å»ºä¸€ä¸ªåˆ†æ”¯ï¼Œå¹¶åˆ‡æ¢åˆ°è¯¥åˆ†æ”¯</span><br><span class="line">$ git checkout -b [branch]</span><br><span class="line"></span><br><span class="line"># æ–°å»ºä¸€ä¸ªåˆ†æ”¯ï¼ŒæŒ‡å‘æŒ‡å®šcommit</span><br><span class="line">$ git branch [branch] [commit]</span><br><span class="line"></span><br><span class="line"># æ–°å»ºä¸€ä¸ªåˆ†æ”¯ï¼Œä¸æŒ‡å®šçš„è¿œç¨‹åˆ†æ”¯å»ºç«‹è¿½è¸ªå…³ç³»</span><br><span class="line">$ git branch --track [branch] [remote-branch]</span><br><span class="line"></span><br><span class="line"># åˆ‡æ¢åˆ°æŒ‡å®šåˆ†æ”¯ï¼Œå¹¶æ›´æ–°å·¥ä½œåŒº</span><br><span class="line">$ git checkout [branch-name]</span><br><span class="line"></span><br><span class="line"># åˆ‡æ¢åˆ°ä¸Šä¸€ä¸ªåˆ†æ”¯</span><br><span class="line">$ git checkout -</span><br><span class="line"></span><br><span class="line"># å»ºç«‹è¿½è¸ªå…³ç³»ï¼Œåœ¨ç°æœ‰åˆ†æ”¯ä¸æŒ‡å®šçš„è¿œç¨‹åˆ†æ”¯ä¹‹é—´</span><br><span class="line">$ git branch --set-upstream [branch] [remote-branch]</span><br><span class="line"></span><br><span class="line"># åˆå¹¶æŒ‡å®šåˆ†æ”¯åˆ°å½“å‰åˆ†æ”¯</span><br><span class="line">$ git merge [branch]</span><br><span class="line"></span><br><span class="line"># é€‰æ‹©ä¸€ä¸ªcommitï¼Œåˆå¹¶è¿›å½“å‰åˆ†æ”¯</span><br><span class="line">$ git cherry-pick [commit]</span><br><span class="line"></span><br><span class="line"># åˆ é™¤åˆ†æ”¯</span><br><span class="line">$ git branch -d [branch-name]</span><br><span class="line"></span><br><span class="line"># åˆ é™¤è¿œç¨‹åˆ†æ”¯</span><br><span class="line">$ git push origin --delete [branch-name]</span><br><span class="line">$ git branch -dr [remote&#x2F;branch]</span><br></pre></td></tr></table></figure>
<h2 id="å…­ã€æ ‡ç­¾">å…­ã€æ ‡ç­¾</h2>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># åˆ—å‡ºæ‰€æœ‰tag</span><br><span class="line">$ git tag</span><br><span class="line"></span><br><span class="line"># æ–°å»ºä¸€ä¸ªtagåœ¨å½“å‰commit</span><br><span class="line">$ git tag [tag]</span><br><span class="line"></span><br><span class="line"># æ–°å»ºä¸€ä¸ªtagåœ¨æŒ‡å®šcommit</span><br><span class="line">$ git tag [tag] [commit]</span><br><span class="line"></span><br><span class="line"># åˆ é™¤æœ¬åœ°tag</span><br><span class="line">$ git tag -d [tag]</span><br><span class="line"></span><br><span class="line"># åˆ é™¤è¿œç¨‹tag</span><br><span class="line">$ git push origin :refs&#x2F;tags&#x2F;[tagName]</span><br><span class="line"></span><br><span class="line"># æŸ¥çœ‹tagä¿¡æ¯</span><br><span class="line">$ git show [tag]</span><br><span class="line"></span><br><span class="line"># æäº¤æŒ‡å®štag</span><br><span class="line">$ git push [remote] [tag]</span><br><span class="line"></span><br><span class="line"># æäº¤æ‰€æœ‰tag</span><br><span class="line">$ git push [remote] --tags</span><br><span class="line"></span><br><span class="line"># æ–°å»ºä¸€ä¸ªåˆ†æ”¯ï¼ŒæŒ‡å‘æŸä¸ªtag</span><br><span class="line">$ git checkout -b [branch] [tag]</span><br></pre></td></tr></table></figure>
<h2 id="ä¸ƒã€æŸ¥çœ‹ä¿¡æ¯">ä¸ƒã€æŸ¥çœ‹ä¿¡æ¯</h2>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># æ˜¾ç¤ºæœ‰å˜æ›´çš„æ–‡ä»¶</span><br><span class="line">$ git status</span><br><span class="line"></span><br><span class="line"># æ˜¾ç¤ºå½“å‰åˆ†æ”¯çš„ç‰ˆæœ¬å†å²</span><br><span class="line">$ git log</span><br><span class="line"></span><br><span class="line"># æ˜¾ç¤ºcommitå†å²ï¼Œä»¥åŠæ¯æ¬¡commitå‘ç”Ÿå˜æ›´çš„æ–‡ä»¶</span><br><span class="line">$ git log --stat</span><br><span class="line"></span><br><span class="line"># æœç´¢æäº¤å†å²ï¼Œæ ¹æ®å…³é”®è¯</span><br><span class="line">$ git log -S [keyword]</span><br><span class="line"></span><br><span class="line"># æ˜¾ç¤ºæŸä¸ªcommitä¹‹åçš„æ‰€æœ‰å˜åŠ¨ï¼Œæ¯ä¸ªcommitå æ®ä¸€è¡Œ</span><br><span class="line">$ git log [tag] HEAD --pretty&#x3D;format:%s</span><br><span class="line"></span><br><span class="line"># æ˜¾ç¤ºæŸä¸ªcommitä¹‹åçš„æ‰€æœ‰å˜åŠ¨ï¼Œå…¶&quot;æäº¤è¯´æ˜&quot;å¿…é¡»ç¬¦åˆæœç´¢æ¡ä»¶</span><br><span class="line">$ git log [tag] HEAD --grep feature</span><br><span class="line"></span><br><span class="line"># æ˜¾ç¤ºæŸä¸ªæ–‡ä»¶çš„ç‰ˆæœ¬å†å²ï¼ŒåŒ…æ‹¬æ–‡ä»¶æ”¹å</span><br><span class="line">$ git log --follow [file]</span><br><span class="line">$ git whatchanged [file]</span><br><span class="line"></span><br><span class="line"># æ˜¾ç¤ºæŒ‡å®šæ–‡ä»¶ç›¸å…³çš„æ¯ä¸€æ¬¡diff</span><br><span class="line">$ git log -p [file]</span><br><span class="line"></span><br><span class="line"># æ˜¾ç¤ºè¿‡å»5æ¬¡æäº¤</span><br><span class="line">$ git log -5 --pretty --oneline</span><br><span class="line"></span><br><span class="line"># æ˜¾ç¤ºæ‰€æœ‰æäº¤è¿‡çš„ç”¨æˆ·ï¼ŒæŒ‰æäº¤æ¬¡æ•°æ’åº</span><br><span class="line">$ git shortlog -sn</span><br><span class="line"></span><br><span class="line"># æ˜¾ç¤ºæŒ‡å®šæ–‡ä»¶æ˜¯ä»€ä¹ˆäººåœ¨ä»€ä¹ˆæ—¶é—´ä¿®æ”¹è¿‡</span><br><span class="line">$ git blame [file]</span><br><span class="line"></span><br><span class="line"># æ˜¾ç¤ºæš‚å­˜åŒºå’Œå·¥ä½œåŒºçš„å·®å¼‚</span><br><span class="line">$ git diff</span><br><span class="line"></span><br><span class="line"># æ˜¾ç¤ºæš‚å­˜åŒºå’Œä¸Šä¸€ä¸ªcommitçš„å·®å¼‚</span><br><span class="line">$ git diff --cached [file]</span><br><span class="line"></span><br><span class="line"># æ˜¾ç¤ºå·¥ä½œåŒºä¸å½“å‰åˆ†æ”¯æœ€æ–°commitä¹‹é—´çš„å·®å¼‚</span><br><span class="line">$ git diff HEAD</span><br><span class="line"></span><br><span class="line"># æ˜¾ç¤ºä¸¤æ¬¡æäº¤ä¹‹é—´çš„å·®å¼‚</span><br><span class="line">$ git diff [first-branch]...[second-branch]</span><br><span class="line"></span><br><span class="line"># æ˜¾ç¤ºä»Šå¤©ä½ å†™äº†å¤šå°‘è¡Œä»£ç </span><br><span class="line">$ git diff --shortstat &quot;@&#123;0 day ago&#125;&quot;</span><br><span class="line"></span><br><span class="line"># æ˜¾ç¤ºæŸæ¬¡æäº¤çš„å…ƒæ•°æ®å’Œå†…å®¹å˜åŒ–</span><br><span class="line">$ git show [commit]</span><br><span class="line"></span><br><span class="line"># æ˜¾ç¤ºæŸæ¬¡æäº¤å‘ç”Ÿå˜åŒ–çš„æ–‡ä»¶</span><br><span class="line">$ git show --name-only [commit]</span><br><span class="line"></span><br><span class="line"># æ˜¾ç¤ºæŸæ¬¡æäº¤æ—¶ï¼ŒæŸä¸ªæ–‡ä»¶çš„å†…å®¹</span><br><span class="line">$ git show [commit]:[filename]</span><br><span class="line"></span><br><span class="line"># æ˜¾ç¤ºå½“å‰åˆ†æ”¯çš„æœ€è¿‘å‡ æ¬¡æäº¤</span><br><span class="line">$ git reflog</span><br></pre></td></tr></table></figure>
<h2 id="å…«ã€è¿œç¨‹åŒæ­¥">å…«ã€è¿œç¨‹åŒæ­¥</h2>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># ä¸‹è½½è¿œç¨‹ä»“åº“çš„æ‰€æœ‰å˜åŠ¨</span><br><span class="line">$ git fetch [remote]</span><br><span class="line"></span><br><span class="line"># æ˜¾ç¤ºæ‰€æœ‰è¿œç¨‹ä»“åº“</span><br><span class="line">$ git remote -v</span><br><span class="line"></span><br><span class="line"># æ˜¾ç¤ºæŸä¸ªè¿œç¨‹ä»“åº“çš„ä¿¡æ¯</span><br><span class="line">$ git remote show [remote]</span><br><span class="line"></span><br><span class="line"># å¢åŠ ä¸€ä¸ªæ–°çš„è¿œç¨‹ä»“åº“ï¼Œå¹¶å‘½å</span><br><span class="line">$ git remote add [shortname] [url]</span><br><span class="line"></span><br><span class="line"># å–å›è¿œç¨‹ä»“åº“çš„å˜åŒ–ï¼Œå¹¶ä¸æœ¬åœ°åˆ†æ”¯åˆå¹¶</span><br><span class="line">$ git pull [remote] [branch]</span><br><span class="line"></span><br><span class="line"># ä¸Šä¼ æœ¬åœ°æŒ‡å®šåˆ†æ”¯åˆ°è¿œç¨‹ä»“åº“</span><br><span class="line">$ git push [remote] [branch]</span><br><span class="line"></span><br><span class="line"># å¼ºè¡Œæ¨é€å½“å‰åˆ†æ”¯åˆ°è¿œç¨‹ä»“åº“ï¼Œå³ä½¿æœ‰å†²çª</span><br><span class="line">$ git push [remote] --force</span><br><span class="line"></span><br><span class="line"># æ¨é€æ‰€æœ‰åˆ†æ”¯åˆ°è¿œç¨‹ä»“åº“</span><br><span class="line">$ git push [remote] --all</span><br></pre></td></tr></table></figure>
<h2 id="ä¹ã€æ’¤é”€">ä¹ã€æ’¤é”€</h2>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># æ¢å¤æš‚å­˜åŒºçš„æŒ‡å®šæ–‡ä»¶åˆ°å·¥ä½œåŒº</span><br><span class="line">$ git checkout [file]</span><br><span class="line"></span><br><span class="line"># æ¢å¤æŸä¸ªcommitçš„æŒ‡å®šæ–‡ä»¶åˆ°æš‚å­˜åŒºå’Œå·¥ä½œåŒº</span><br><span class="line">$ git checkout [commit] [file]</span><br><span class="line"></span><br><span class="line"># æ¢å¤æš‚å­˜åŒºçš„æ‰€æœ‰æ–‡ä»¶åˆ°å·¥ä½œåŒº</span><br><span class="line">$ git checkout .</span><br><span class="line"></span><br><span class="line"># é‡ç½®æš‚å­˜åŒºçš„æŒ‡å®šæ–‡ä»¶ï¼Œä¸ä¸Šä¸€æ¬¡commitä¿æŒä¸€è‡´ï¼Œä½†å·¥ä½œåŒºä¸å˜</span><br><span class="line">$ git reset [file]</span><br><span class="line"></span><br><span class="line"># é‡ç½®æš‚å­˜åŒºä¸å·¥ä½œåŒºï¼Œä¸ä¸Šä¸€æ¬¡commitä¿æŒä¸€è‡´</span><br><span class="line">$ git reset --hard</span><br><span class="line"></span><br><span class="line"># é‡ç½®å½“å‰åˆ†æ”¯çš„æŒ‡é’ˆä¸ºæŒ‡å®šcommitï¼ŒåŒæ—¶é‡ç½®æš‚å­˜åŒºï¼Œä½†å·¥ä½œåŒºä¸å˜</span><br><span class="line">$ git reset [commit]</span><br><span class="line"></span><br><span class="line"># é‡ç½®å½“å‰åˆ†æ”¯çš„HEADä¸ºæŒ‡å®šcommitï¼ŒåŒæ—¶é‡ç½®æš‚å­˜åŒºå’Œå·¥ä½œåŒºï¼Œä¸æŒ‡å®šcommitä¸€è‡´</span><br><span class="line">$ git reset --hard [commit]</span><br><span class="line"></span><br><span class="line"># é‡ç½®å½“å‰HEADä¸ºæŒ‡å®šcommitï¼Œä½†ä¿æŒæš‚å­˜åŒºå’Œå·¥ä½œåŒºä¸å˜</span><br><span class="line">$ git reset --keep [commit]</span><br><span class="line"></span><br><span class="line"># æ–°å»ºä¸€ä¸ªcommitï¼Œç”¨æ¥æ’¤é”€æŒ‡å®šcommit</span><br><span class="line"># åè€…çš„æ‰€æœ‰å˜åŒ–éƒ½å°†è¢«å‰è€…æŠµæ¶ˆï¼Œå¹¶ä¸”åº”ç”¨åˆ°å½“å‰åˆ†æ”¯</span><br><span class="line">$ git revert [commit]</span><br><span class="line"></span><br><span class="line"># æš‚æ—¶å°†æœªæäº¤çš„å˜åŒ–ç§»é™¤ï¼Œç¨åå†ç§»å…¥</span><br><span class="line">$ git stash</span><br><span class="line">$ git stash pop</span><br></pre></td></tr></table></figure>
<h2 id="åã€å…¶ä»–">åã€å…¶ä»–</h2>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># ç”Ÿæˆä¸€ä¸ªå¯ä¾›å‘å¸ƒçš„å‹ç¼©åŒ…</span><br><span class="line">$ git archive</span><br></pre></td></tr></table></figure>
<hr>
<p>å‚è€ƒè½¬è½½ï¼š<br>
<a href="http://www.ruanyifeng.com/blog/2015/12/git-cheat-sheet.html" target="_blank" rel="noopener">http://www.ruanyifeng.com/blog/2015/12/git-cheat-sheet.html</a><br>
<a href="https://gitee.com/all-about-git" target="_blank" rel="noopener">https://gitee.com/all-about-git</a></p>
]]></content>
      <categories>
        <category>git</category>
      </categories>
      <tags>
        <tag>git</tag>
      </tags>
  </entry>
  <entry>
    <title>Android Studioå…¥é—¨é…ç½®</title>
    <url>/posts/50ca3841.html</url>
    <content><![CDATA[<h1>ä¸€ã€JDKçš„ä¸‹è½½ä¸å®‰è£…é…ç½®</h1>
<h2 id="1ã€ä¸‹è½½åˆé€‚ç‰ˆæœ¬å¹¶å®‰è£…JDK-è®°ä½è‡ªå·±çš„å®‰è£…è·¯å¾„">1ã€ä¸‹è½½åˆé€‚ç‰ˆæœ¬å¹¶å®‰è£…JDK(è®°ä½è‡ªå·±çš„å®‰è£…è·¯å¾„)</h2>
<p>ä¸‹è½½è·¯å¾„ï¼š<br>
<a href="1%E3%80%81%09%E4%B8%8B%E8%BD%BD%E5%90%88%E9%80%82%E7%89%88%E6%9C%AC%E5%B9%B6%E5%AE%89%E8%A3%85JDK%28%E8%AE%B0%E4%BD%8F%E8%87%AA%E5%B7%B1%E7%9A%84%E5%AE%89%E8%A3%85%E8%B7%AF%E5%BE%84%29%20%E5%AE%89%E8%A3%85%E8%B7%AF%E5%BE%84%EF%BC%9A%20https://www.oracle.com/java/technologies/javase-jdk13-downloads.html">JDK13ä¸‹è½½ç½‘å€</a><br>
ä¸‹è½½å®Œæˆåè¿›è¡Œè§£å‹å®‰è£…ï¼Œè¿™é‡Œä¸æå€¡å®‰è£…åœ¨cç›˜<br>
å¦å¤–å¦‚æœå‘ç°å®‰è£…å¥½åæ²¡æœ‰jreæ–‡ä»¶å¤¹ï¼Œåˆ™éœ€è¦è‡ªå·±ç”Ÿæˆjreæ–‡ä»¶ï¼Œåœ¨ç›®æ ‡è·¯å¾„ä¸‹ï¼ˆè‡ªå·±å®‰è£…çš„JDKè·¯å¾„ä¸­è¿è¡Œcmdï¼‰è¿è¡Œå‘½ä»¤è¡Œå³å¯ã€‚<br>
<code>	bin\jlink.exe --module-path jmods --add-modules java.desktop --output jre</code></p>
<a id="more"></a>
<h2 id="2ã€ç³»ç»Ÿç¯å¢ƒé…ç½®">2ã€ç³»ç»Ÿç¯å¢ƒé…ç½®</h2>
<ul>
<li>
<p>åœ¨â€œç³»ç»Ÿå˜é‡â€æ–°å»ºä¸€ä¸ªå˜é‡åä¸ºJAVA13_HOMEçš„å˜é‡ï¼Œå˜é‡å€¼ä¸ºä½ æœ¬åœ°JDKçš„å®‰è£…ç›®å½•ï¼Œå½“ç„¶è¿™é‡Œçš„å˜é‡åå¯ä»¥æ ¹æ®è‡ªå·±éœ€æ±‚ä¿®æ”¹ã€‚<br>
<img src="https://img-blog.csdnimg.cn/20201013201858433.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xlbW9uX1RU,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
</li>
<li>
<p>åŒæ ·çš„å†æ–°å»ºä¸€ä¸ªPathå˜é‡ï¼ŒPathå¤§å°å†™éšæ„ï¼Œå˜é‡çš„å€¼ä¸º<code>%JAVA13_HOME%\bin</code>ï¼Œå½“ç„¶ç›´æ¥ç”¨è·¯å¾„ä¹Ÿå¯ä»¥ã€‚<br>
<img src="https://img-blog.csdnimg.cn/20201013202001642.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xlbW9uX1RU,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
</li>
<li>
<p>æœ€åä¸€æ­¥æ–°å»ºä¸€ä¸ªCLASSPATHå˜é‡ï¼Œè¿™é‡Œè®¾ç½®CLASSPATHçš„å€¼æ˜¯<code>.;%JAVA_HOME%\lib\dt.jar;%JAVA_HOME%\lib\tools.jar; </code>æå®šã€‚æ³¨æ„å‰é¢çš„.<br>
<img src="https://img-blog.csdnimg.cn/20201013202231575.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xlbW9uX1RU,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
</li>
<li>
<p>æ‰“å¼€cmdå‘½ä»¤è¡Œï¼Œè¿è¡Œ<code>java -version</code>å¯ä»¥æŸ¥çœ‹æ˜¯å¦é…ç½®æˆåŠŸ</p>
</li>
</ul>
<h1>äºŒã€Android Studioä¸‹è½½å®‰è£…</h1>
<p><a href="https://www.androiddevtools.cn/" target="_blank" rel="noopener">Android Studio 4.0 ä¸‹è½½åœ°å€</a><br>
ä¸‹è½½å®Œæˆåè¿›è¡Œè½¯ä»¶å’ŒSDKçš„å®‰è£…ï¼ˆè¿™é‡Œå‚»ç“œå¼å®‰è£…ï¼Œä¸è¿‡æ³¨æ„å®‰è£…è·¯å¾„ä¸è¦å‡ºç°ä¸­æ–‡ï¼Œå¦å¤–å»ºè®®ä¸è¦å®‰è£…åœ¨ç³»ç»Ÿç›˜ï¼‰</p>
<ul>
<li>Android studioç¨‹åºå®‰è£…å®Œæ¯•ï¼Œä½†æ˜¯è¿˜éœ€è¦ç»§ç»­å¯¹å…¶è¿›è¡Œé…ç½®ï¼›å¯åŠ¨Android studioï¼Œå‡ºç°ä¸‹å›¾,é¦–æ¬¡å®‰è£…Android studioçš„æƒ…å†µä¸‹ï¼Œé€‰æ‹©ä¸å¯¼å…¥ä¹‹å‰ç‰ˆæœ¬çš„é…ç½®å³é€‰æ‹©ç¬¬äºŒé¡¹ï¼Œç„¶åç‚¹å‡»ok<br>
<img src="https://img-blog.csdnimg.cn/20201013203438389.jpg#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></li>
<li>é¦–æ¬¡å®‰è£…Android studioéœ€è¦ä¸‹è½½SDKï¼Œè¿™é‡Œç‚¹å‡»cancelï¼Œä¹‹åæ ¹æ®è‡ªå·±éœ€æ±‚è¿›è¡Œå®‰è£…ä¸‹è½½SDK.<br>
<img src="https://img-blog.csdnimg.cn/20201013203441592.jpg#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></li>
</ul>
<h1>ä¸‰ã€ç¬¬ä¸€ä¸ªDemoå·¥ç¨‹</h1>
<h2 id="1ã€å·¥ç¨‹åˆ›å»º">1ã€å·¥ç¨‹åˆ›å»º</h2>
<ul>
<li>æ‰“å¼€è½¯ä»¶ï¼Œé€‰æ‹©Empty Activityå·¥ç¨‹ï¼Œé€‰æ‹©next<br>
<img src="https://img-blog.csdnimg.cn/20201013203852237.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xlbW9uX1RU,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></li>
<li>æ ¹æ®è‡ªå·±éœ€æ±‚é€‰æ‹©é¡¹ç›®åã€è¯­è¨€å’Œå®‰è£…è·¯å¾„ç­‰ï¼Œé€‰æ‹©å®Œæˆåç‚¹å‡»finish<br>
<img src="https://img-blog.csdnimg.cn/20201013203930157.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xlbW9uX1RU,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>
ç¬¬ä¸€æ¬¡å»ºç«‹å·¥ç¨‹æœ‰ç‚¹æ…¢ï¼Œæ˜¯å› ä¸ºä»ç½‘ä¸Šä¸‹è½½gradleæ„å»ºå·¥å…·ï¼Œç”±äºä»å›½å¤–ç«™ç‚¹ä¸‹è½½ï¼Œæ¯”è¾ƒæ…¢ï¼Œä¸€èˆ¬æƒ…å†µéœ€è¦æŒ‚æ¢¯å­ï¼Œæœ€åç­‰å¾…å·¦ä¸‹è§’å‡ºç° Gradle bulid successfuly å°±è¯´æ˜æ„å»ºå®Œæˆäº†</li>
</ul>
<hr>
<p>å¦‚æœæ— æ³•ä¸‹è½½å¯ä»¥æœ‰ä¸¤ç§æ–¹æ³•ï¼Œç¬¬ä¸€ç§è¿›è¡Œæ¢æºï¼Œè¿™é‡Œå°±ä¸å¤šä»‹ç»äº†ï¼Œç¬¬äºŒç§å°±æ˜¯è¿›è¡Œæ‰‹åŠ¨ä¸‹è½½ï¼Œè¿™é‡Œä»‹ç»ç¬¬äºŒç§æ–¹æ³•ã€‚<br>
1ã€æ‰¾åˆ°å¯¹åº”çš„ç‰ˆæœ¬å·ï¼Œæˆ‘è¿™é‡Œæ˜¯6.1.1ç‰ˆæœ¬ï¼Œç„¶åå»<a href="https://services.gradle.org/distributions/" target="_blank" rel="noopener">Gradleä¸‹è½½åœ°å€</a>ä¸‹è½½å¯¹äºç‰ˆæœ¬çš„å‹ç¼©åŒ…ï¼Œ<br>
<img src="https://img-blog.csdnimg.cn/20201013204641699.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xlbW9uX1RU,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°">2ã€æ‰“å¼€ç”µè„‘Cç›˜ï¼Œè¿›å…¥ç”¨æˆ·æ–‡ä»¶ï¼Œæ‰¾åˆ°<code>.gradle</code>æ–‡ä»¶å¤¹ï¼Œå¦‚å›¾è·¯å¾„ä¸€å±‚å±‚æ‰“å¼€ï¼Œæ‰¾åˆ°å¦‚å›¾ä½ç½®ï¼Œåˆ é™¤ä¸‹è½½å¤±è´¥çš„æ–‡ä»¶ï¼Œå°†æ‰‹åŠ¨ä¸‹è½½çš„å‹ç¼©åŒ…æ”¾å…¥ï¼Œé‡å¯Android Studioå³å¯ã€‚<br>
<img src="https://img-blog.csdnimg.cn/20201013205302816.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xlbW9uX1RU,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<hr>
<h2 id="2ã€è™šæ‹Ÿæœºåˆ›å»ºå’Œå¯åŠ¨">2ã€è™šæ‹Ÿæœºåˆ›å»ºå’Œå¯åŠ¨</h2>
<ul>
<li>é€‰æ‹©åˆé€‚çš„è™šæ‹Ÿæœºè¿›è¡Œåˆ›å»ºï¼Œæ¨èä½¿ç”¨é»˜è®¤çš„<br>
<img src="https://img-blog.csdnimg.cn/20201013205425981.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xlbW9uX1RU,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></li>
<li>å¦‚æœéœ€è¦ä¿®æ”¹ä½¿ç”¨JDKçš„å¯ä»¥è¿›è¡Œä¿®æ”¹ï¼ˆandroidå†…ç½®æœ‰jreï¼‰ï¼Œè¿™é‡Œæˆ‘ä½¿ç”¨äº†è‡ªå·±ä¸‹è½½çš„JDK<br>
<img src="https://img-blog.csdnimg.cn/2020101321000439.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xlbW9uX1RU,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>
<img src="https://img-blog.csdnimg.cn/20201013210141639.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xlbW9uX1RU,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></li>
<li>å¯åŠ¨é¡¹ç›®ï¼Œå³å¯æˆåŠŸæ˜¾ç¤º<br>
<img src="https://img-blog.csdnimg.cn/20201013205729125.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xlbW9uX1RU,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></li>
</ul>
<h1>å››ã€é¡¹ç›®ç®€å•ä»‹ç»</h1>
<h2 id="1ã€ç›®å½•ç»“æ„ä»‹ç»">1ã€ç›®å½•ç»“æ„ä»‹ç»</h2>
<p><img src="https://img-blog.csdnimg.cn/20201013210215919.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xlbW9uX1RU,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">.idea <span class="comment">//ç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆçš„å…³äºASçš„é…ç½®ç›®å½•ï¼ˆç‰ˆæƒï¼ŒjaråŒ…ç­‰ï¼‰</span></span><br><span class="line">gradle <span class="comment">//Gradleç›®å½•ï¼ˆé¡¹ç›®æ„å»ºå·¥å…·ï¼‰</span></span><br><span class="line">app <span class="comment">//ASåˆ›å»ºå·¥ç¨‹ä¸­çš„ä¸€ä¸ªModule</span></span><br><span class="line">External Libraries <span class="comment">//ä¾èµ–æ–‡ä»¶ï¼ˆç‰ˆæœ¬å·ï¼ŒSDKç­‰ï¼‰</span></span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/20201013210318735.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xlbW9uX1RU,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">buildï¼š<span class="comment">//æ„å»ºç›®å½•ï¼Œç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆçš„ç¼–è¯‘ç›®å½•</span></span><br><span class="line">libsï¼š<span class="comment">//ä¾èµ–åŒ…å­˜æ”¾ç›®å½•</span></span><br><span class="line">srcï¼š<span class="comment">//æºç ï¼Œèµ„æºç›®å½•</span></span><br><span class="line">androidTest: <span class="comment">//ç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆçš„ç”¨äºæµ‹è¯•çš„ç›®å½•</span></span><br><span class="line">mainï¼š<span class="comment">//ä¸»ç›®å½• </span></span><br><span class="line">javaï¼š<span class="comment">//Javaä»£ç ç›®å½•</span></span><br><span class="line">resï¼š<span class="comment">//èµ„æºæ–‡ä»¶</span></span><br><span class="line">drawableï¼š <span class="comment">//å­˜æ”¾å„ç§ä½å›¾æ–‡ä»¶ï¼ˆpngï¼Œjpgç­‰ï¼‰</span></span><br><span class="line">layoutï¼š<span class="comment">//Appå¸ƒå±€æ–‡ä»¶ </span></span><br><span class="line">valuesï¼š<span class="comment">//å‚¨å­˜ä¸€äº›å¼•ç”¨æ–‡ä»¶ï¼ˆå¯ä»¥å®šä¹‰å°ºå¯¸ï¼Œå­—ç¬¦ä¸²ï¼Œæ ·å¼ï¼Œé¢œè‰²ç­‰ç­‰ï¼‰</span></span><br><span class="line">AndroidManifest.xmlï¼š<span class="comment">//AppåŸºæœ¬ä¿¡æ¯ï¼ˆAndroidé…ç½®æ–‡ä»¶ï¼‰ </span></span><br><span class="line">.gitgnore: <span class="comment">//é¡¹ç›®ç©ºé—´çš„åŒæ­¥å¿½ç•¥æ–‡ä»¶</span></span><br><span class="line">build.gradleï¼š<span class="comment">//Moduleçš„Gradleç¼–è¯‘æ–‡ä»¶</span></span><br></pre></td></tr></table></figure>
<h2 id="2ã€å®‰å“ç”Ÿå‘½å‘¨æœŸ">2ã€å®‰å“ç”Ÿå‘½å‘¨æœŸ</h2>
<p><img src="https://img-blog.csdnimg.cn/20201013210519202.gif#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<ul>
<li>æ‰“å¼€ç¨‹åºï¼Œæ‰§è¡Œé¡ºåºä¸ºonCreateã€onStartã€onResume</li>
<li>æŒ‰ä¸‹backé”®ï¼Œæ‰§è¡Œé¡ºåºä¸ºonPauseã€onStopã€onDestoryï¼›</li>
<li>å†å¯åŠ¨HelloWorldï¼Œæ‰§è¡Œé¡ºåºä¸ºonRestartã€onStartã€onResumeï¼›</li>
<li>æŒ‰ä¸‹homeé”®ï¼Œæ‰§è¡Œé¡ºåºä¸ºonPauseã€onStopï¼›</li>
</ul>
<hr>
<p>å‚è€ƒæ–‡ç« <br>
<a href="https://blog.csdn.net/qq_43078852/article/details/104381548" target="_blank" rel="noopener">https://blog.csdn.net/qq_43078852/article/details/104381548</a><br>
<a href="https://www.jianshu.com/p/8d1d765a1a6c" target="_blank" rel="noopener">https://www.jianshu.com/p/8d1d765a1a6c</a></p>
]]></content>
      <tags>
        <tag>å®‰å“</tag>
      </tags>
  </entry>
  <entry>
    <title>SpringBootåç«¯æ¥å£è§„èŒƒ</title>
    <url>/posts/557d179e.html</url>
    <content><![CDATA[<h1>ä¸€ã€å‰è¨€</h1>
<p>â€ƒä¸€ä¸ªåç«¯æ¥å£å¤§è‡´åˆ†ä¸ºå››ä¸ªéƒ¨åˆ†ç»„æˆï¼šæ¥å£åœ°å€ï¼ˆurlï¼‰ã€æ¥å£è¯·æ±‚æ–¹å¼ï¼ˆgetã€postç­‰ï¼‰ã€è¯·æ±‚æ•°æ®ï¼ˆrequestï¼‰ã€å“åº”æ•°æ®ï¼ˆresponseï¼‰ã€‚è™½ç„¶è¯´åç«¯æ¥å£çš„ç¼–å†™å¹¶æ²¡æœ‰ç»Ÿä¸€è§„èŒƒè¦æ±‚ï¼Œè€Œä¸”å¦‚ä½•æ„å»ºè¿™å‡ ä¸ªéƒ¨åˆ†æ¯ä¸ªå…¬å¸è¦æ±‚éƒ½ä¸åŒï¼Œæ²¡æœ‰ä»€ä¹ˆâ€œä¸€å®šæ˜¯æœ€å¥½çš„â€æ ‡å‡†ï¼Œä½†å…¶ä¸­æœ€é‡è¦çš„å…³é”®ç‚¹å°±æ˜¯çœ‹æ˜¯å¦è§„èŒƒã€‚</p>
<a id="more"></a>
<h1>äºŒã€ç¯å¢ƒè¯´æ˜</h1>
<p>â€ƒå› ä¸ºè®²è§£çš„é‡ç‚¹æ˜¯åç«¯æ¥å£ï¼Œæ‰€ä»¥éœ€è¦å¯¼å…¥ä¸€ä¸ªspring-boot-starter-webåŒ…ï¼Œè€Œlombokä½œç”¨æ˜¯ç®€åŒ–ç±»ï¼Œå‰ç«¯æ˜¾ç¤ºåˆ™ä½¿ç”¨äº†knife4jï¼Œå…·ä½“ä½¿ç”¨åœ¨<a href="https://blog.csdn.net/lemon_TT/article/details/108158631" target="_blank" rel="noopener">Spring Bootæ•´åˆknife4jå®ç°Apiæ–‡æ¡£</a>å·²å†™æ˜</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">			<span class="comment">&lt;!--æ–°ç‰ˆæ¡†æ¶æ²¡æœ‰è‡ªåŠ¨å¼•å…¥éœ€è¦æ‰‹åŠ¨å¼•å…¥--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-validation<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.github.xiaoymin<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>knife4j-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--åœ¨å¼•ç”¨æ—¶è¯·åœ¨mavenä¸­å¤®ä»“åº“æœç´¢æœ€æ–°ç‰ˆæœ¬å·--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h1>ä¸‰ã€å‚æ•°æ ¡éªŒ</h1>
<p>â€ƒä¸€ä¸ªæ¥å£ä¸€èˆ¬å¯¹å‚æ•°ï¼ˆè¯·æ±‚æ•°æ®ï¼‰éƒ½ä¼šè¿›è¡Œå®‰å…¨æ ¡éªŒï¼Œå‚æ•°æ ¡éªŒçš„é‡è¦æ€§è‡ªç„¶ä¸å¿…å¤šè¯´ï¼Œé‚£ä¹ˆå¦‚ä½•å¯¹å‚æ•°è¿›è¡Œæ ¡éªŒå°±æœ‰è®²ç©¶äº†ã€‚ä¸€èˆ¬æ¥è¯´æœ‰ä¸‰ç§å¸¸è§çš„æ ¡éªŒæ–¹å¼ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†æœ€ç®€æ´çš„ç¬¬ä¸‰ç§æ–¹æ³•</p>
<ul>
<li>ä¸šåŠ¡å±‚æ ¡éªŒ</li>
<li>Validator + BindResultæ ¡éªŒ</li>
<li><strong>Validator + è‡ªåŠ¨æŠ›å‡ºå¼‚å¸¸</strong></li>
</ul>
<p>â€ƒä¸šåŠ¡å±‚æ ¡éªŒæ— éœ€å¤šè¯´ï¼Œå³æ‰‹åŠ¨åœ¨javaçš„Serviceå±‚è¿›è¡Œæ•°æ®æ ¡éªŒåˆ¤æ–­ã€‚ä¸è¿‡è¿™æ ·å¤ªç¹çäº†ï¼Œå…‰æ ¡éªŒä»£ç å°±ä¼šæœ‰å¾ˆå¤šã€‚<br>
â€ƒè€Œä½¿ç”¨Validator+ BindingResultå·²ç»æ˜¯éå¸¸æ–¹ä¾¿å®ç”¨çš„å‚æ•°æ ¡éªŒæ–¹å¼äº†ï¼Œåœ¨å®é™…å¼€å‘ä¸­ä¹Ÿæœ‰å¾ˆå¤šé¡¹ç›®å°±æ˜¯è¿™ä¹ˆåšçš„ï¼Œä¸è¿‡è¿™æ ·è¿˜æ˜¯ä¸å¤ªæ–¹ä¾¿ï¼Œå› ä¸ºä½ æ¯å†™ä¸€ä¸ªæ¥å£éƒ½è¦æ·»åŠ ä¸€ä¸ªBindingResultå‚æ•°ï¼Œç„¶åå†æå–é”™è¯¯ä¿¡æ¯è¿”å›ç»™å‰ç«¯ï¼ˆç®€å•çœ‹ä¸€ä¸‹ï¼‰ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"> <span class="meta">@PostMapping</span>(<span class="string">"/addUser"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">addUser</span><span class="params">(@RequestBody @Valid User user, BindingResult bindingResult)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// å¦‚æœæœ‰å‚æ•°æ ¡éªŒå¤±è´¥ï¼Œä¼šå°†é”™è¯¯ä¿¡æ¯å°è£…æˆå¯¹è±¡ç»„è£…åœ¨BindingResulté‡Œ</span></span><br><span class="line">        <span class="keyword">for</span> (ObjectError error : bindingResult.getAllErrors()) &#123;</span><br><span class="line">            <span class="keyword">return</span> error.getDefaultMessage();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> validationService.addUser(user);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Validator-è‡ªåŠ¨æŠ›å‡ºå¼‚å¸¸ï¼ˆä½¿ç”¨ï¼‰">Validator + è‡ªåŠ¨æŠ›å‡ºå¼‚å¸¸ï¼ˆä½¿ç”¨ï¼‰</h2>
<p>â€ƒé¦–å…ˆValidatorå¯ä»¥éå¸¸æ–¹ä¾¿çš„åˆ¶å®šæ ¡éªŒè§„åˆ™ï¼Œå¹¶è‡ªåŠ¨å¸®ä½ å®Œæˆæ ¡éªŒã€‚é¦–å…ˆåœ¨å…¥å‚é‡Œéœ€è¦æ ¡éªŒçš„å­—æ®µåŠ ä¸Šæ³¨è§£,æ¯ä¸ªæ³¨è§£å¯¹åº”ä¸åŒçš„æ ¡éªŒè§„åˆ™ï¼Œå¹¶å¯åˆ¶å®šæ ¡éªŒå¤±è´¥åçš„ä¿¡æ¯ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="meta">@NotNull</span>(message = <span class="string">"ç”¨æˆ·idä¸èƒ½ä¸ºç©º"</span>)</span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@NotNull</span>(message = <span class="string">"ç”¨æˆ·è´¦å·ä¸èƒ½ä¸ºç©º"</span>)</span><br><span class="line">    <span class="meta">@Size</span>(min = <span class="number">6</span>, max = <span class="number">11</span>, message = <span class="string">"è´¦å·é•¿åº¦å¿…é¡»æ˜¯6-11ä¸ªå­—ç¬¦"</span>)</span><br><span class="line">    <span class="keyword">private</span> String account;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@NotNull</span>(message = <span class="string">"ç”¨æˆ·å¯†ç ä¸èƒ½ä¸ºç©º"</span>)</span><br><span class="line">    <span class="meta">@Size</span>(min = <span class="number">6</span>, max = <span class="number">11</span>, message = <span class="string">"å¯†ç é•¿åº¦å¿…é¡»æ˜¯6-16ä¸ªå­—ç¬¦"</span>)</span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@NotNull</span>(message = <span class="string">"ç”¨æˆ·é‚®ç®±ä¸èƒ½ä¸ºç©º"</span>)</span><br><span class="line">    <span class="meta">@Email</span>(message = <span class="string">"é‚®ç®±æ ¼å¼ä¸æ­£ç¡®"</span>)</span><br><span class="line">    <span class="keyword">private</span> String email;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>â€ƒæ ¡éªŒè§„åˆ™å’Œé”™è¯¯æç¤ºä¿¡æ¯é…ç½®å®Œæ¯•åï¼Œæ¥ä¸‹æ¥åªéœ€è¦åœ¨æ¥å£ä»…éœ€è¦åœ¨æ ¡éªŒçš„å‚æ•°ä¸ŠåŠ ä¸Š@Validæ³¨è§£(å»æ‰BindingResultåä¼šè‡ªåŠ¨å¼•å‘å¼‚å¸¸ï¼Œå¼‚å¸¸å‘ç”Ÿäº†è‡ªç„¶è€Œç„¶å°±ä¸ä¼šæ‰§è¡Œä¸šåŠ¡é€»è¾‘)ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"user"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ValidationController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> ValidationService validationService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@PostMapping</span>(<span class="string">"/addUser"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">addUser</span><span class="params">(@RequestBody @Valid User user)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> validationService.addUser(user);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>â€ƒç°åœ¨æˆ‘ä»¬è¿›è¡Œæµ‹è¯•ï¼Œæ‰“å¼€knife4jæ–‡æ¡£åœ°å€ï¼Œå½“è¾“å…¥çš„è¯·æ±‚æ•°æ®ä¸ºç©ºæ—¶ï¼ŒValidatorä¼šå°†æ‰€æœ‰çš„æŠ¥é”™ä¿¡æ¯å…¨éƒ¨è¿›è¡Œè¿”å›ï¼Œæ‰€ä»¥éœ€è¦ä¸å…¨å±€å¼‚å¸¸å¤„ç†ä¸€èµ·ä½¿ç”¨ã€‚<br>
<img src="https://img-blog.csdnimg.cn/20200830203443712.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xlbW9uX1RU,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h1>å››ã€å…¨å±€å¼‚å¸¸å¤„ç†</h1>
<p>â€ƒå‚æ•°æ ¡éªŒå¤±è´¥ä¼šè‡ªåŠ¨å¼•å‘å¼‚å¸¸ï¼Œæˆ‘ä»¬å½“ç„¶ä¸å¯èƒ½å†å»æ‰‹åŠ¨æ•æ‰å¼‚å¸¸è¿›è¡Œå¤„ç†ã€‚ä½†æˆ‘ä»¬åˆä¸æƒ³æ‰‹åŠ¨æ•æ‰è¿™ä¸ªå¼‚å¸¸ï¼Œåˆè¦å¯¹è¿™ä¸ªå¼‚å¸¸è¿›è¡Œå¤„ç†ï¼Œé‚£æ­£å¥½ä½¿ç”¨SpringBootå…¨å±€å¼‚å¸¸å¤„ç†æ¥è¾¾åˆ°ä¸€åŠ³æ°¸é€¸çš„æ•ˆæœï¼</p>
<h2 id="åŸºæœ¬ä½¿ç”¨">åŸºæœ¬ä½¿ç”¨</h2>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦æ–°å»ºä¸€ä¸ªç±»ï¼Œåœ¨è¿™ä¸ªç±»ä¸ŠåŠ ä¸Š<code>@ControllerAdvice</code>æˆ–<code>@RestControllerAdvice</code>æ³¨è§£ï¼Œè¿™ä¸ªç±»å°±é…ç½®æˆå…¨å±€å¤„ç†ç±»äº†ã€‚ï¼ˆè¿™ä¸ªæ ¹æ®ä½ çš„Controllerå±‚ç”¨çš„æ˜¯<code>@Controller</code>è¿˜æ˜¯<code>@RestController</code>æ¥å†³å®šï¼‰ ç„¶ååœ¨ç±»ä¸­æ–°å»ºæ–¹æ³•ï¼Œåœ¨æ–¹æ³•ä¸ŠåŠ ä¸Š<code>@ExceptionHandler</code>æ³¨è§£å¹¶æŒ‡å®šä½ æƒ³å¤„ç†çš„å¼‚å¸¸ç±»å‹ï¼Œæ¥ç€åœ¨æ–¹æ³•å†…ç¼–å†™å¯¹è¯¥å¼‚å¸¸çš„æ“ä½œé€»è¾‘ï¼Œå°±å®Œæˆäº†å¯¹è¯¥å¼‚å¸¸çš„å…¨å±€å¤„ç†ï¼æˆ‘ä»¬ç°åœ¨å°±æ¥æ¼”ç¤ºä¸€ä¸‹å¯¹å‚æ•°æ ¡éªŒå¤±è´¥æŠ›å‡ºçš„<code>MethodArgumentNotValidException</code>å…¨å±€å¤„ç†ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.csdn.demo1.global;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.validation.ObjectError;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.MethodArgumentNotValidException;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.ExceptionHandler;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestControllerAdvice;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RestControllerAdvice</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ExceptionControllerAdvice</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ExceptionHandler</span>(MethodArgumentNotValidException<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class">    @<span class="title">ResponseStatus</span>(<span class="title">HttpStatus</span>.<span class="title">BAD_REQUEST</span>)</span></span><br><span class="line"><span class="class">    <span class="title">public</span> <span class="title">String</span> <span class="title">MethodArgumentNotValidExceptionHandler</span>(<span class="title">MethodArgumentNotValidException</span> <span class="title">e</span>) </span>&#123;</span><br><span class="line">        <span class="comment">// ä»å¼‚å¸¸å¯¹è±¡ä¸­æ‹¿åˆ°ObjectErrorå¯¹è±¡</span></span><br><span class="line">        ObjectError objectError = e.getBindingResult().getAllErrors().get(<span class="number">0</span>);</span><br><span class="line">        <span class="comment">// ç„¶åæå–é”™è¯¯æç¤ºä¿¡æ¯è¿›è¡Œè¿”å›</span></span><br><span class="line">        <span class="keyword">return</span> objectError.getDefaultMessage();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>â€ƒæˆ‘ä»¬å†æ¬¡è¿›è¡Œæµ‹è¯•ï¼Œè¿™æ¬¡è¿”å›çš„å°±æ˜¯æˆ‘ä»¬åˆ¶å®šçš„é”™è¯¯æç¤ºä¿¡æ¯ï¼æˆ‘ä»¬é€šè¿‡å…¨å±€å¼‚å¸¸å¤„ç†ä¼˜é›…çš„å®ç°äº†æˆ‘ä»¬æƒ³è¦çš„åŠŸèƒ½ï¼ä»¥åæˆ‘ä»¬å†æƒ³å†™æ¥å£å‚æ•°æ ¡éªŒï¼Œå°±åªéœ€è¦åœ¨å…¥å‚çš„æˆå‘˜å˜é‡ä¸ŠåŠ ä¸ŠValidatoræ ¡éªŒè§„åˆ™æ³¨è§£ï¼Œç„¶ååœ¨å‚æ•°ä¸ŠåŠ ä¸Š@Validæ³¨è§£å³å¯å®Œæˆæ ¡éªŒï¼Œæ ¡éªŒå¤±è´¥ä¼šè‡ªåŠ¨è¿”å›é”™è¯¯æç¤ºä¿¡æ¯ï¼Œæ— éœ€ä»»ä½•å…¶ä»–ä»£ç ï¼<br>
<img src="https://img-blog.csdnimg.cn/20200830204830239.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xlbW9uX1RU,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h2 id="è‡ªå®šä¹‰å¼‚å¸¸">è‡ªå®šä¹‰å¼‚å¸¸</h2>
<p>â€ƒåœ¨å¾ˆå¤šæƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éœ€è¦æ‰‹åŠ¨æŠ›å‡ºå¼‚å¸¸ï¼Œæ¯”å¦‚åœ¨ä¸šåŠ¡å±‚å½“æœ‰äº›æ¡ä»¶å¹¶ä¸ç¬¦åˆä¸šåŠ¡é€»è¾‘ï¼Œè€Œä½¿ç”¨è‡ªå®šä¹‰å¼‚å¸¸æœ‰è¯¸å¤šä¼˜ç‚¹ï¼š</p>
<ul>
<li>è‡ªå®šä¹‰å¼‚å¸¸å¯ä»¥æºå¸¦æ›´å¤šçš„ä¿¡æ¯ï¼Œä¸åƒè¿™æ ·åªèƒ½æºå¸¦ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚</li>
<li>é¡¹ç›®å¼€å‘ä¸­ç»å¸¸æ˜¯å¾ˆå¤šäººè´Ÿè´£ä¸åŒçš„æ¨¡å—ï¼Œä½¿ç”¨è‡ªå®šä¹‰å¼‚å¸¸å¯ä»¥ç»Ÿä¸€äº†å¯¹å¤–å¼‚å¸¸å±•ç¤ºçš„æ–¹å¼ã€‚</li>
<li>è‡ªå®šä¹‰å¼‚å¸¸è¯­ä¹‰æ›´åŠ æ¸…æ™°æ˜äº†ï¼Œä¸€çœ‹å°±çŸ¥é“æ˜¯é¡¹ç›®ä¸­æ‰‹åŠ¨æŠ›å‡ºçš„å¼‚å¸¸ã€‚<br>
â€ƒæˆ‘ä»¬ç°åœ¨å°±æ¥å¼€å§‹å†™ä¸€ä¸ªè‡ªå®šä¹‰å¼‚å¸¸ï¼š</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.csdn.demo1.global;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.Getter;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Getter</span> <span class="comment">//åªè¦getteræ–¹æ³•ï¼Œæ— éœ€setter</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">APIException</span> <span class="keyword">extends</span> <span class="title">RuntimeException</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> code;</span><br><span class="line">    <span class="keyword">private</span> String msg;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">APIException</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>(<span class="number">1001</span>, <span class="string">"æ¥å£é”™è¯¯"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">APIException</span><span class="params">(String msg)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>(<span class="number">1001</span>, msg);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">APIException</span><span class="params">(<span class="keyword">int</span> code, String msg)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(msg);</span><br><span class="line">        <span class="keyword">this</span>.code = code;</span><br><span class="line">        <span class="keyword">this</span>.msg = msg;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>â€ƒç„¶ååœ¨åˆšæ‰çš„å…¨å±€å¼‚å¸¸ç±»ä¸­åŠ å…¥å¦‚ä¸‹:</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//è‡ªå®šä¹‰çš„å…¨å±€å¼‚å¸¸</span></span><br><span class="line">   <span class="meta">@ExceptionHandler</span>(APIException<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class">   <span class="title">public</span> <span class="title">String</span> <span class="title">APIExceptionHandler</span>(<span class="title">APIException</span> <span class="title">e</span>) </span>&#123;</span><br><span class="line">       <span class="keyword">return</span> e.getMsg();</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<p>â€ƒè¿™æ ·å°±å¯¹å¼‚å¸¸çš„å¤„ç†å°±æ¯”è¾ƒè§„èŒƒäº†ï¼Œå½“ç„¶è¿˜å¯ä»¥æ·»åŠ å¯¹Exceptionçš„å¤„ç†ï¼Œè¿™æ ·æ— è®ºå‘ç”Ÿä»€ä¹ˆå¼‚å¸¸æˆ‘ä»¬éƒ½èƒ½å±è”½æ‰ç„¶åå“åº”æ•°æ®ç»™å‰ç«¯ï¼Œä¸è¿‡å»ºè®®æœ€åé¡¹ç›®ä¸Šçº¿æ—¶è¿™æ ·åšï¼Œèƒ½å¤Ÿå±è”½æ‰é”™è¯¯ä¿¡æ¯æš´éœ²ç»™å‰ç«¯ï¼Œåœ¨å¼€å‘ä¸­ä¸ºäº†æ–¹ä¾¿è°ƒè¯•è¿˜æ˜¯ä¸è¦è¿™æ ·åšã€‚å¦å¤–ï¼Œå½“æˆ‘ä»¬æŠ›å‡ºè‡ªå®šä¹‰å¼‚å¸¸çš„æ—¶å€™å…¨å±€å¼‚å¸¸å¤„ç†åªå“åº”äº†å¼‚å¸¸ä¸­çš„é”™è¯¯ä¿¡æ¯msgç»™å‰ç«¯ï¼Œå¹¶æ²¡æœ‰å°†é”™è¯¯ä»£ç codeè¿”å›ã€‚è¿™è¿˜éœ€è¦é…åˆæ•°æ®ç»Ÿä¸€å“åº”ã€‚</p>
<h1>äº”ã€æ•°æ®ç»Ÿä¸€å“åº”</h1>
<p>â€ƒç»Ÿä¸€æ•°æ®å“åº”æ˜¯æˆ‘ä»¬è‡ªå·±è‡ªå®šä¹‰ä¸€ä¸ªå“åº”ä½“ç±»ï¼Œæ— è®ºåå°æ˜¯è¿è¡Œæ­£å¸¸è¿˜æ˜¯å‘ç”Ÿå¼‚å¸¸ï¼Œå“åº”ç»™å‰ç«¯çš„æ•°æ®æ ¼å¼æ˜¯ä¸å˜çš„ï¼è¿™é‡Œæˆ‘åŒ…æ‹¬äº†å“åº”ä¿¡æ¯ä»£ç codeå’Œå“åº”ä¿¡æ¯è¯´æ˜msgï¼Œé¦–å…ˆå¯ä»¥è®¾ç½®ä¸€ä¸ªæšä¸¾è§„èŒƒå“åº”ä½“ä¸­çš„å“åº”ç å’Œå“åº”ä¿¡æ¯ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Getter</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> ResultCode &#123;</span><br><span class="line">    SUCCESS(<span class="number">1000</span>, <span class="string">"æ“ä½œæˆåŠŸ"</span>),</span><br><span class="line">    FAILED(<span class="number">1001</span>, <span class="string">"å“åº”å¤±è´¥"</span>),</span><br><span class="line">    VALIDATE_FAILED(<span class="number">1002</span>, <span class="string">"å‚æ•°æ ¡éªŒå¤±è´¥"</span>),</span><br><span class="line">    ERROR(<span class="number">5000</span>, <span class="string">"æœªçŸ¥é”™è¯¯"</span>);</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> code;</span><br><span class="line">    <span class="keyword">private</span> String msg;</span><br><span class="line">    ResultCode(<span class="keyword">int</span> code, String msg) &#123;</span><br><span class="line">        <span class="keyword">this</span>.code = code;</span><br><span class="line">        <span class="keyword">this</span>.msg = msg;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>â€ƒè‡ªå®šä¹‰å“åº”ä½“</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.csdn.demo1.global;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.Getter;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Getter</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ResultVO</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * çŠ¶æ€ç ï¼Œæ¯”å¦‚1000ä»£è¡¨å“åº”æˆåŠŸ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> code;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å“åº”ä¿¡æ¯ï¼Œç”¨æ¥è¯´æ˜å“åº”æƒ…å†µ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String msg;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å“åº”çš„å…·ä½“æ•°æ®</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> T data;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ResultVO</span><span class="params">(T data)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>(ResultCode.SUCCESS, data);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ResultVO</span><span class="params">(ResultCode resultCode, T data)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.code = resultCode.getCode();</span><br><span class="line">        <span class="keyword">this</span>.msg = resultCode.getMsg();</span><br><span class="line">        <span class="keyword">this</span>.data = data;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>â€ƒæœ€åéœ€è¦ä¿®æ”¹å…¨å±€å¼‚å¸¸å¤„ç†ç±»çš„è¿”å›ç±»å‹</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestControllerAdvice</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ExceptionControllerAdvice</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ExceptionHandler</span>(APIException<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class">    <span class="title">public</span> <span class="title">ResultVO</span>&lt;<span class="title">String</span>&gt; <span class="title">APIExceptionHandler</span>(<span class="title">APIException</span> <span class="title">e</span>) </span>&#123;</span><br><span class="line">        <span class="comment">// æ³¨æ„å“¦ï¼Œè¿™é‡Œä¼ é€’çš„å“åº”ç æšä¸¾</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ResultVO&lt;&gt;(ResultCode.FAILED, e.getMsg());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ExceptionHandler</span>(MethodArgumentNotValidException<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class">    <span class="title">public</span> <span class="title">ResultVO</span>&lt;<span class="title">String</span>&gt; <span class="title">MethodArgumentNotValidExceptionHandler</span>(<span class="title">MethodArgumentNotValidException</span> <span class="title">e</span>) </span>&#123;</span><br><span class="line">        ObjectError objectError = e.getBindingResult().getAllErrors().get(<span class="number">0</span>);</span><br><span class="line">        <span class="comment">// æ³¨æ„å“¦ï¼Œè¿™é‡Œä¼ é€’çš„å“åº”ç æšä¸¾</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ResultVO&lt;&gt;(ResultCode.VALIDATE_FAILED, objectError.getDefaultMessage());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>â€ƒæœ€ååœ¨controllerå±‚è¿›è¡Œæ¥å£ä¿¡æ¯æ•°æ®çš„è¿”å›</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@GetMapping</span>(<span class="string">"/getUser"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ResultVO&lt;User&gt; <span class="title">getUser</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        User user = <span class="keyword">new</span> User();</span><br><span class="line">        user.setId(<span class="number">1L</span>);</span><br><span class="line">        user.setAccount(<span class="string">"12345678"</span>);</span><br><span class="line">        user.setPassword(<span class="string">"12345678"</span>);</span><br><span class="line">        user.setEmail(<span class="string">"123@qq.com"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ResultVO&lt;&gt;(user);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>â€ƒç»è¿‡æµ‹è¯•ï¼Œè¿™æ ·å“åº”ç å’Œå“åº”ä¿¡æ¯åªèƒ½æ˜¯æšä¸¾è§„å®šçš„é‚£å‡ ä¸ªï¼Œå°±çœŸæ­£åšåˆ°äº†å“åº”æ•°æ®æ ¼å¼ã€å“åº”ç å’Œå“åº”ä¿¡æ¯è§„èŒƒåŒ–ã€ç»Ÿä¸€åŒ–ï¼<br>
<img src="https://img-blog.csdnimg.cn/20200830211916735.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xlbW9uX1RU,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h1>å…­ã€å…¨å±€å¤„ç†å“åº”æ•°æ®(å¯é€‰æ‹©)</h1>
<p>â€ƒæ¥å£è¿”å›ç»Ÿä¸€å“åº”ä½“ + å¼‚å¸¸ä¹Ÿè¿”å›ç»Ÿä¸€å“åº”ä½“ï¼Œå…¶å®è¿™æ ·å·²ç»å¾ˆå¥½äº†ï¼Œä½†è¿˜æ˜¯æœ‰å¯ä»¥ä¼˜åŒ–çš„åœ°æ–¹ã€‚è¦çŸ¥é“ä¸€ä¸ªé¡¹ç›®ä¸‹æ¥å®šä¹‰çš„æ¥å£æä¸ªå‡ ç™¾ä¸ªå¤ªæ­£å¸¸ä¸è¿‡äº†ï¼Œè¦æ˜¯æ¯ä¸€ä¸ªæ¥å£è¿”å›æ•°æ®æ—¶éƒ½è¦ç”¨å“åº”ä½“æ¥åŒ…è£…ä¸€ä¸‹å¥½åƒæœ‰ç‚¹éº»çƒ¦ï¼Œæœ‰æ²¡æœ‰åŠæ³•çœå»è¿™ä¸ªåŒ…è£…è¿‡ç¨‹å‘¢ï¼Ÿå½“ç„¶æ˜¯æœ‰çš„ï¼Œè¿˜æ˜¯è¦ç”¨åˆ°å…¨å±€å¤„ç†ã€‚ä½†æ˜¯ä¸ºäº†æ‰©å±•æ€§ï¼Œå°±æ˜¯å…è®¸ç»•è¿‡æ•°æ®ç»Ÿä¸€å“åº”ï¼ˆè¿™æ ·å°±å¯ä»¥æä¾›å¤šæ–¹ä½¿ç”¨ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰æ³¨è§£ï¼Œåˆ©ç”¨æ³¨è§£æ¥é€‰æ‹©æ˜¯å¦è¿›è¡Œå…¨å±€å“åº”åŒ…è£…ã€‚<br>
â€ƒé¦–å…ˆåˆ›å»ºè‡ªå®šä¹‰æ³¨è§£ï¼Œä½œç”¨ç›¸å½“äºå…¨å±€å¤„ç†ç±»å¼€å…³ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class="line"><span class="meta">@Target</span>(&#123;ElementType.METHOD&#125;) <span class="comment">// è¡¨æ˜è¯¥æ³¨è§£åªèƒ½æ”¾åœ¨æ–¹æ³•ä¸Š</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> NotResponseBody &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>â€ƒå…¶æ¬¡åˆ›å»ºä¸€ä¸ªç±»å¹¶åŠ ä¸Šæ³¨è§£ä½¿å…¶æˆä¸ºå…¨å±€å¤„ç†ç±»ã€‚ç„¶åç»§æ‰¿<code>ResponseBodyAdvice</code>æ¥å£é‡å†™å…¶ä¸­çš„æ–¹æ³•ï¼Œå³å¯å¯¹æˆ‘ä»¬çš„controllerè¿›è¡Œå¢å¼ºæ“ä½œï¼Œå…·ä½“çœ‹ä»£ç å’Œæ³¨é‡Šï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.csdn.demo1.global;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.core.JsonProcessingException;</span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.databind.ObjectMapper;</span><br><span class="line"><span class="keyword">import</span> org.springframework.core.MethodParameter;</span><br><span class="line"><span class="keyword">import</span> org.springframework.http.MediaType;</span><br><span class="line"><span class="keyword">import</span> org.springframework.http.converter.HttpMessageConverter;</span><br><span class="line"><span class="keyword">import</span> org.springframework.http.server.ServerHttpRequest;</span><br><span class="line"><span class="keyword">import</span> org.springframework.http.server.ServerHttpResponse;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestControllerAdvice;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.mvc.method.annotation.ResponseBodyAdvice;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RestControllerAdvice</span>(basePackages = &#123;<span class="string">"com.scdn.demo1.controller"</span>&#125;) <span class="comment">// æ³¨æ„å“¦ï¼Œè¿™é‡Œè¦åŠ ä¸Šéœ€è¦æ‰«æçš„åŒ…</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ResponseControllerAdvice</span> <span class="keyword">implements</span> <span class="title">ResponseBodyAdvice</span>&lt;<span class="title">Object</span>&gt; </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">supports</span><span class="params">(MethodParameter returnType, Class&lt;? extends HttpMessageConverter&lt;?&gt;&gt; aClass)</span> </span>&#123;</span><br><span class="line">       <span class="comment">// å¦‚æœæ¥å£è¿”å›çš„ç±»å‹æœ¬èº«å°±æ˜¯ResultVOé‚£å°±æ²¡æœ‰å¿…è¦è¿›è¡Œé¢å¤–çš„æ“ä½œï¼Œè¿”å›false</span></span><br><span class="line">        <span class="comment">// å¦‚æœæ–¹æ³•ä¸ŠåŠ äº†æˆ‘ä»¬çš„è‡ªå®šä¹‰æ³¨è§£ä¹Ÿæ²¡æœ‰å¿…è¦è¿›è¡Œé¢å¤–çš„æ“ä½œ</span></span><br><span class="line">        <span class="keyword">return</span> !(returnType.getParameterType().equals(ResultVO<span class="class">.<span class="keyword">class</span>) || <span class="title">returnType</span>.<span class="title">hasMethodAnnotation</span>(<span class="title">NotResponseBody</span>.<span class="title">class</span>))</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">beforeBodyWrite</span><span class="params">(Object data, MethodParameter returnType, MediaType mediaType, Class&lt;? extends HttpMessageConverter&lt;?&gt;&gt; aClass, ServerHttpRequest request, ServerHttpResponse response)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// Stringç±»å‹ä¸èƒ½ç›´æ¥åŒ…è£…ï¼Œæ‰€ä»¥è¦è¿›è¡Œäº›ç‰¹åˆ«çš„å¤„ç†</span></span><br><span class="line">        <span class="keyword">if</span> (returnType.getGenericParameterType().equals(String<span class="class">.<span class="keyword">class</span>)) </span>&#123;</span><br><span class="line">            ObjectMapper objectMapper = <span class="keyword">new</span> ObjectMapper();</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="comment">// å°†æ•°æ®åŒ…è£…åœ¨ResultVOé‡Œåï¼Œå†è½¬æ¢ä¸ºjsonå­—ç¬¦ä¸²å“åº”ç»™å‰ç«¯</span></span><br><span class="line">                <span class="keyword">return</span> objectMapper.writeValueAsString(<span class="keyword">new</span> ResultVO&lt;&gt;(data));</span><br><span class="line">            &#125; <span class="keyword">catch</span> (JsonProcessingException e) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> APIException(<span class="string">"è¿”å›Stringç±»å‹é”™è¯¯"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// å°†åŸæœ¬çš„æ•°æ®åŒ…è£…åœ¨ResultVOé‡Œ</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ResultVO&lt;&gt;(data);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>â€ƒé‡å†™çš„è¿™ä¸¤ä¸ªæ–¹æ³•æ˜¯ç”¨æ¥åœ¨<code>controller</code>å°†æ•°æ®è¿›è¡Œè¿”å›å‰è¿›è¡Œå¢å¼ºæ“ä½œï¼Œ<code>supports</code>æ–¹æ³•è¦è¿”å›ä¸ºtrueæ‰ä¼šæ‰§è¡Œ<code>beforeBodyWrite</code>æ–¹æ³•ï¼Œæ‰€ä»¥å¦‚æœæœ‰äº›æƒ…å†µä¸éœ€è¦è¿›è¡Œå¢å¼ºæ“ä½œå¯ä»¥åœ¨<code>supports</code>æ–¹æ³•é‡Œè¿›è¡Œåˆ¤æ–­ã€‚å¯¹è¿”å›æ•°æ®è¿›è¡ŒçœŸæ­£çš„æ“ä½œè¿˜æ˜¯åœ¨<code>beforeBodyWrite</code>æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨è¯¥æ–¹æ³•é‡ŒåŒ…è£…æ•°æ®ï¼Œè¿™æ ·å°±ä¸éœ€è¦æ¯ä¸ªæ¥å£éƒ½è¿›è¡Œæ•°æ®åŒ…è£…äº†ï¼Œçœå»äº†å¾ˆå¤šéº»çƒ¦ã€‚æ­¤æ—¶controlleråªéœ€è¿™æ ·å†™å°±è¡Œäº†ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@GetMapping</span>(<span class="string">"/getUser"</span>)</span><br><span class="line"><span class="comment">//@NotResponseBody  //æ˜¯å¦ç»•è¿‡æ•°æ®ç»Ÿä¸€å“åº”å¼€å…³</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> User <span class="title">getUser</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    User user = <span class="keyword">new</span> User();</span><br><span class="line">    user.setId(<span class="number">1L</span>);</span><br><span class="line">    user.setAccount(<span class="string">"12345678"</span>);</span><br><span class="line">    user.setPassword(<span class="string">"12345678"</span>);</span><br><span class="line">    user.setEmail(<span class="string">"123@qq.com"</span>);</span><br><span class="line">    <span class="comment">// æ³¨æ„å“¦ï¼Œè¿™é‡Œæ˜¯ç›´æ¥è¿”å›çš„Userç±»å‹ï¼Œå¹¶æ²¡æœ‰ç”¨ResultVOè¿›è¡ŒåŒ…è£…</span></span><br><span class="line">    <span class="keyword">return</span> user;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1>ä¸ƒã€æ€»ç»“</h1>
<p>è‡ªæ­¤æ•´ä¸ªåç«¯æ¥å£åŸºæœ¬ä½“ç³»å°±æ„å»ºå®Œæ¯•äº†</p>
<ul>
<li>é€šè¿‡Validator + è‡ªåŠ¨æŠ›å‡ºå¼‚å¸¸æ¥å®Œæˆäº†æ–¹ä¾¿çš„å‚æ•°æ ¡éªŒ</li>
<li>é€šè¿‡å…¨å±€å¼‚å¸¸å¤„ç† + è‡ªå®šä¹‰å¼‚å¸¸å®Œæˆäº†å¼‚å¸¸æ“ä½œçš„è§„èŒƒ</li>
<li>é€šè¿‡æ•°æ®ç»Ÿä¸€å“åº”å®Œæˆäº†å“åº”æ•°æ®çš„è§„èŒƒ</li>
<li>å¤šä¸ªæ–¹é¢ç»„è£…éå¸¸ä¼˜é›…çš„å®Œæˆäº†åç«¯æ¥å£çš„åè°ƒï¼Œè®©å¼€å‘äººå‘˜æœ‰æ›´å¤šçš„ç»å†æ³¨é‡ä¸šåŠ¡é€»è¾‘ä»£ç ï¼Œè½»æ¾æ„å»ºåç«¯æ¥å£</li>
</ul>
<hr>
<p><a href="https://github.com/RudeCrab/rude-java/blob/master/project-practice/validation-and-exception-handler/validation-and-exception-handler.md" target="_blank" rel="noopener">å‚è€ƒæ–‡ç« </a></p>
]]></content>
      <categories>
        <category>Java</category>
      </categories>
      <tags>
        <tag>springboot</tag>
      </tags>
  </entry>
  <entry>
    <title>Spring Bootæ•´åˆknife4jå®ç°Apiæ–‡æ¡£</title>
    <url>/posts/db133795.html</url>
    <content><![CDATA[<h1>ä¸€ã€ç®€ä»‹</h1>
<blockquote>
<p>â€ƒknife4jæ˜¯ä¸ºJava MVCæ¡†æ¶é›†æˆSwaggerç”ŸæˆApiæ–‡æ¡£çš„å¢å¼ºè§£å†³æ–¹æ¡ˆ,å‰èº«æ˜¯swagger-bootstrap-ui,å–åkni4jæ˜¯å¸Œæœ›å¥¹èƒ½åƒä¸€æŠŠåŒ•é¦–ä¸€æ ·å°å·§,è½»é‡,å¹¶ä¸”åŠŸèƒ½å¼ºæ‚!<br>
ã€€knife4jçš„å‰èº«æ˜¯swagger-bootstrap-uiï¼Œä¸ºäº†å¥‘åˆå¾®æœåŠ¡çš„æ¶æ„å‘å±•,ç”±äºåŸæ¥swagger-bootstrap-uié‡‡ç”¨çš„æ˜¯åç«¯Javaä»£ç +å‰ç«¯Uiæ··åˆæ‰“åŒ…çš„æ–¹å¼,åœ¨å¾®æœåŠ¡æ¶æ„ä¸‹æ˜¾çš„å¾ˆè‡ƒè‚¿,å› æ­¤é¡¹ç›®æ­£å¼æ›´åä¸ºknife4j</p>
</blockquote>
<p><a href="https://doc.xiaominfo.com/knife4j/" target="_blank" rel="noopener">knife4jå®˜æ–¹æ–‡æ¡£</a><br>
<a href="https://gitee.com/xiaoym/knife4j" target="_blank" rel="noopener">ç äº‘ä»“åº“åœ°å€</a></p>
<a id="more"></a>
<h1>äºŒã€é¡¹ç›®æ­å»º</h1>
<h2 id="1ã€mavenå¼•å…¥">1ã€mavenå¼•å…¥</h2>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.github.xiaoymin<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>knife4j-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--åœ¨å¼•ç”¨æ—¶è¯·åœ¨mavenä¸­å¤®ä»“åº“æœç´¢æœ€æ–°ç‰ˆæœ¬å·--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><a href="https://mvnrepository.com/artifact/com.github.xiaoymin/knife4j-spring-boot-starter" target="_blank" rel="noopener">knife4jä»“åº“åœ°å€</a></p>
<h2 id="2ã€åˆ›å»ºSwaggeré…ç½®æ–‡ä»¶">2ã€åˆ›å»ºSwaggeré…ç½®æ–‡ä»¶</h2>
<p>é¦–å…ˆåˆ›å»º<code>application-dev.yml</code>å’Œ<code>application-prod.yml</code>å¼€å‘å’Œç”Ÿäº§ç¯å¢ƒï¼Œæœ€ååœ¨<code>application.yml</code>ä¸­é…ç½®å½“å‰ç¯å¢ƒï¼Œè¿™æ ·å°±å¯ä»¥åœ¨ç”Ÿäº§ç¯å¢ƒä¸­å…³é—­åœ¨çº¿æ¥å£æ–‡æ¡£äº†ã€‚å¦å¤–ä¹Ÿå¯ä»¥ä½¿ç”¨æ³¨è§£<code>@Profile</code>è®¾ç½®ç¯å¢ƒ</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">profiles:</span></span><br><span class="line">    <span class="attr">active:</span> <span class="string">dev</span></span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.csdn.demo1.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.github.xiaoymin.knife4j.spring.annotations.EnableKnife4j;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Import;</span><br><span class="line"><span class="keyword">import</span> springfox.bean.validators.configuration.BeanValidatorPluginsConfiguration;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.builders.ApiInfoBuilder;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.builders.PathSelectors;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.builders.RequestHandlerSelectors;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.service.ApiInfo;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.spi.DocumentationType;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.spring.web.plugins.Docket;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.swagger2.annotations.EnableSwagger2;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@EnableSwagger</span>2</span><br><span class="line"><span class="meta">@EnableKnife</span>4j</span><br><span class="line"><span class="meta">@Import</span>(BeanValidatorPluginsConfiguration<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class"><span class="title">public</span> <span class="title">class</span> <span class="title">SwaggerConfiguration</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å¦‚æœè¦è®¾ç½®å¤šä¸ªç”¨æˆ·ç»„ï¼Œåªéœ€è¦åœ¨å®šä¹‰ä¸€ä¸ªDocketå¹¶æ‰“ä¸Š@Beanè¿”å›å³å¯</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Docket <span class="title">docket</span><span class="params">(Environment environment)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è®¾ç½®è¦æ˜¾ç¤ºçš„åœ¨çº¿æ¥å£æ–‡æ¡£ç¯å¢ƒ</span></span><br><span class="line">        Profiles profiles = Profiles.of(<span class="string">"dev"</span>,<span class="string">"test"</span>);</span><br><span class="line">        <span class="comment">//é€šè¿‡environment.acceptsProfilesåˆ¤æ–­æ˜¯å¦å¤„äºå½“å‰è‡ªå·±è®¾å®šçš„ç¯å¢ƒä¸­</span></span><br><span class="line">        <span class="keyword">boolean</span> flag = environment.acceptsProfiles(profiles);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Docket(DocumentationType.SWAGGER_2)</span><br><span class="line">                .apiInfo(apiInfo())</span><br><span class="line">            	<span class="comment">//æ˜¯å¦åœ¨æµè§ˆå™¨æ˜¾ç¤º,å¦‚æœä¸€ç›´è¦æ˜¾ç¤ºå¼€å¯ï¼Œå°±é€‰æ‹©true</span></span><br><span class="line">                .enable(flag)</span><br><span class="line">             	<span class="comment">//.enable(true)</span></span><br><span class="line">                <span class="comment">//åˆ†ç»„åç§°</span></span><br><span class="line">                .groupName(<span class="string">"1.0ç‰ˆæœ¬"</span>)</span><br><span class="line">                .select()</span><br><span class="line">                <span class="comment">//è¿™é‡ŒæŒ‡å®šControlleræ‰«æåŒ…è·¯å¾„(é¡¹ç›®è·¯å¾„ä¹Ÿè¡Œ)</span></span><br><span class="line">                .apis(RequestHandlerSelectors.basePackage(<span class="string">"com.csdn.demo1.controller"</span>))</span><br><span class="line">                .paths(PathSelectors.any())</span><br><span class="line">                .build();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">private</span> ApiInfo <span class="title">apiInfo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ApiInfoBuilder()</span><br><span class="line">                .title(<span class="string">"æ¥å£è¯´æ˜"</span>)</span><br><span class="line">                .description(<span class="string">"DEMOæœåŠ¡æ¥å£è¯´æ˜"</span>)</span><br><span class="line">                .termsOfServiceUrl(<span class="string">"http://localhost:8888/"</span>)</span><br><span class="line">                .version(<span class="string">"1.0"</span>)</span><br><span class="line">                .build();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/20200822223403412.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xlbW9uX1RU,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h1>ä¸‰ã€knifeé¡¹ç›®ä½¿ç”¨</h1>
<h2 id="1ã€å¸¸ç”¨æ³¨è§£ä»‹ç»">1ã€å¸¸ç”¨æ³¨è§£ä»‹ç»</h2>
<h4 id="Api">@Api()</h4>
<p>ä½œç”¨åœ¨ç±»ä¸Šï¼Œç”¨æ¥æ ‡æ³¨è¯¥ç±»å…·ä½“å®ç°å†…å®¹ã€‚<br>
<em>å‚æ•°ï¼š</em><br>
<strong>tagsï¼šç±»æ ‡ç­¾ï¼Œä¸€èˆ¬ç”¨æ¥å†™ç±»çš„åç§°æˆ–ä½œç”¨ã€‚ï¼ˆå¸¸ç”¨ï¼‰<br>
descriptionï¼šå¯æè¿°æè¿°è¯¥ç±»ä½œç”¨ã€‚</strong></p>
<hr>
<h4 id="ApiOperation">@ApiOperation()</h4>
<p>ç”¨äºæ–¹æ³•çš„è¯´æ˜<br>
<em>å‚æ•°ï¼š</em><br>
<strong>value ï¼šæ–¹æ³•è¯´æ˜ï¼ˆå¸¸ç”¨ï¼‰<br>
notes ï¼šæ³¨é‡Šè¯´æ˜<br>
httpMethod ï¼š è¯´æ˜è¿™ä¸ªæ–¹æ³•è¢«è¯·æ±‚çš„æ–¹å¼<br>
response ï¼šæ–¹æ³•çš„è¿”å›å€¼çš„ç±»å‹</strong></p>
<hr>
<h4 id="ApiOperationSupport">@ApiOperationSupport()</h4>
<p>ï¼ˆknife4jå¢åŠ ç‰¹æ€§ï¼‰ç”¨äºæ¥å£æ–¹æ³•æ’åºï¼Œä½œè€…ä¿¡æ¯æè¿°ç­‰ã€‚<br>
<em>å‚æ•°ï¼š</em><br>
<strong>orderï¼šæ’åº<br>
authorï¼šä½œè€…ä¿¡æ¯</strong></p>
<hr>
<h4 id="ApiImplicitParam">@ApiImplicitParam()</h4>
<p>å¯¹å•ä¸ªå‚æ•°çš„è¯´æ˜<br>
<em>å‚æ•°ï¼š</em><br>
<strong>name ï¼šå‚æ•°åã€‚<br>
value ï¼š å‚æ•°çš„å…·ä½“æ„ä¹‰ï¼Œä½œç”¨ã€‚ï¼ˆå¸¸ç”¨ï¼‰<br>
required ï¼š å‚æ•°æ˜¯å¦å¿…å¡«ã€‚ ï¼ˆå¸¸ç”¨ï¼‰<br>
dataType ï¼šå‚æ•°çš„æ•°æ®ç±»å‹ã€‚ ï¼ˆå¸¸ç”¨ï¼‰<br>
paramType ï¼šæŸ¥è¯¢å‚æ•°ç±»å‹ï¼Œè¿™é‡Œæœ‰å‡ ç§å½¢å¼ï¼š<br>
ç±»å‹ã€€ã€€ã€€ã€€ã€€ä½œç”¨<br>
path ã€€ã€€ã€€ä»¥åœ°å€çš„å½¢å¼æäº¤æ•°æ®<br>
query  ã€€ã€€ç›´æ¥è·Ÿå‚æ•°å®Œæˆè‡ªåŠ¨æ˜ å°„èµ‹å€¼<br>
bodyã€€ã€€ã€€ä»¥æµçš„å½¢å¼æäº¤ ä»…æ”¯æŒPOST<br>
headerã€€ã€€å‚æ•°åœ¨request headers é‡Œè¾¹æäº¤<br>
formã€€ã€€ã€€ä»¥formè¡¨å•çš„å½¢å¼æäº¤ ä»…æ”¯æŒPOST</strong></p>
<hr>
<h4 id="ApiModel">@ApiModel()</h4>
<p>ç”¨äºæè¿°ä¸€ä¸ªæ•°æ®æ¨¡å‹çš„ä¿¡æ¯ï¼Œå³æˆ‘ä»¬å¸¸ç”¨çš„å®ä½“ã€VOç±»ã€DTOç±»ç­‰æè¿°<br>
<em>å‚æ•°ï¼š</em><br>
<strong>value ï¼š æ•°æ®æ¨¡å‹åç§°ã€‚ï¼ˆå¸¸ç”¨ï¼‰<br>
description:å…·ä½“æè¿°<br>
parentï¼šçˆ¶ç±»</strong></p>
<hr>
<h4 id="ApiModelProperty">@ApiModelProperty()</h4>
<p>ç”¨äºæè¿°æ•°æ®æ¨¡å‹çš„å±æ€§ä¿¡æ¯<br>
<em>å‚æ•°ï¼š</em><br>
<strong>valueï¼šå­—æ®µè¯´æ˜ ï¼ˆå¸¸ç”¨ï¼‰<br>
nameï¼šé‡å†™å±æ€§åå­—<br>
dataTypeï¼šé‡å†™å±æ€§ç±»å‹<br>
requiredï¼šæ˜¯å¦å¿…å¡« ï¼ˆå¸¸ç”¨ï¼‰<br>
exampleï¼šä¸¾ä¾‹è¯´æ˜ ï¼ˆå¸¸ç”¨ï¼‰<br>
hiddenï¼šéšè—</strong></p>
<hr>
<h4 id="ApiIgnore">@ApiIgnore</h4>
<p>è‡ªåŠ¨ç”Ÿæˆæ¥å£è¯´æ˜æ—¶å¿½ç•¥</p>
<h2 id="2ã€é¡¹ç›®ä¸­çš„ç®€å•ä½¿ç”¨">2ã€é¡¹ç›®ä¸­çš„ç®€å•ä½¿ç”¨</h2>
<p>â€ƒåœ¨é¡¹ç›®å¯åŠ¨ä¸­æˆ‘è¿˜é‡åˆ°äº†<code>javax/validation/constraints/Min</code>æŠ¥é”™ï¼ŒåŸå› æ˜¯æˆ‘ä½¿ç”¨äº†æœ€æ–°çš„springbootæ¡†æ¶ç‰ˆæœ¬ï¼Œæ–°ç‰ˆæœ¬æ²¡æœ‰è‡ªåŠ¨å¼•å…¥ validationå¯¹åº”çš„åŒ…ï¼Œæ‰€ä»¥è¦æƒ³ä½¿ç”¨æ ¡éªŒåŠŸèƒ½è¦æ‰‹åŠ¨å¼•å…¥åŒ…ã€‚åœ¨pom.xmlå¼•å…¥ä¾èµ–å³å¯</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-validation<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>â€ƒå¯åŠ¨é¡¹ç›®åï¼Œè®¿é—®<code>http://localhost:8080/doc.html</code>å³å¯(ipå’Œç«¯å£æ ¹æ®å®é™…éœ€æ±‚æ¥)ã€‚æ ¹æ®æ¥å£çš„ä¸åŒéœ€æ±‚ï¼Œç»“åˆå®˜æ–¹æ–‡æ¡£ï¼Œå¯ä»¥å†™å‡ºè‡ªå·±éœ€è¦çš„ä¸ªæ€§åŒ–éœ€æ±‚ã€‚ä¸‹é¢æ˜¯æˆ‘è‡ªå·±æµ‹è¯•çš„demo<br>
<a href="https://doc.xiaominfo.com/knife4j/" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£å‚è€ƒ</a></p>
<p><img src="https://img-blog.csdnimg.cn/20200823214211723.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xlbW9uX1RU,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>
<img src="https://img-blog.csdnimg.cn/20200823214335383.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xlbW9uX1RU,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<hr>
<p><a href="https://blog.csdn.net/tuoyun6647/article/details/106021012" target="_blank" rel="noopener">å‚è€ƒæ–‡ç« </a></p>
]]></content>
      <categories>
        <category>Java</category>
      </categories>
      <tags>
        <tag>springboot</tag>
      </tags>
  </entry>
  <entry>
    <title>Vueæ‰“åŒ…éƒ¨ç½²å‡ºç°ç™½å±</title>
    <url>/posts/1e9a5ba7.html</url>
    <content><![CDATA[<h4 id="1ã€é—®é¢˜æè¿°">1ã€é—®é¢˜æè¿°</h4>
<p>â€ƒæˆ‘ä»¬ç”¨vueé¡¹ç›®åœ¨æœ¬åœ°è·‘çš„æ—¶å€™ä¸€åˆ‡æ­£å¸¸ï¼Œå½“æ—¶æˆ‘ä»¬ç”¨<code>npm run build</code>å‘½ä»¤æ‰“åŒ…å¹¶éƒ¨ç½²æœåŠ¡å™¨åï¼Œå‘ç°Indexå±•ç¤ºçš„æ˜¯ç™½å±ï¼Œæ§åˆ¶å°æ˜¾ç¤ºèµ„æºéƒ½èƒ½æ­£ç¡®è®¿é—®åˆ°<img src="https://img-blog.csdnimg.cn/20200704175746282.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xlbW9uX1RU,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<a id="more"></a>
<h4 id="2ã€åŸå› ">2ã€åŸå› </h4>
<p>â€ƒå‡ºç°è¿™ä¸ªé—®é¢˜çš„åŸå› å°±æ˜¯Vueè·¯ç”±æ¨¡å¼çš„è®¾ç½®é—®é¢˜ï¼Œé¦–å…ˆç®€å•ä»‹ç»ä¸€ä¸‹Vueçš„ä¸¤ç§è·¯ç”±æ¨¡å¼ï¼š<strong>hashæ¨¡å¼å’Œhistoryæ¨¡å¼</strong><br>
â€ƒè¿™ä¸¤ä¸ªæ¨¡å¼æœ€ç›´è§‚çš„åŒºåˆ«å°±æ˜¯åœ¨urlä¸­ hash æ¨¡å¼å¸¦äº†ä¸€ä¸ªå¾ˆä¸‘çš„ # è€Œhistoryæ˜¯æ²¡æœ‰#çš„ï¼Œåœ¨ä¸€èˆ¬å¼€å‘ç¯å¢ƒä¸‹ï¼Œè¿™ä¸¤ä¸ªæ¨¡å¼éƒ½æ˜¯å¯ä»¥æ­£å¸¸ä½¿ç”¨çš„ï¼Œä½†æ˜¯æ‰“åŒ…ç¼–è¯‘çš„æ—¶å€™è¿™ä¸¤ä¸ªæ¨¡å¼æœ‰äº›åœ°æ–¹éœ€è¦è¿›è¡Œä¿®æ”¹æ‰èƒ½é˜²æ­¢æ‰“åŒ…åçš„é¡µé¢å˜æˆç©ºç™½ã€‚</p>
<hr>
<p>PS:é¡µé¢ç©ºç™½å¦ä¸€ç§å¯èƒ½æ˜¯æ–‡ä»¶å¼•ç”¨è·¯å¾„ä¸å¯¹ï¼Œåœ¨vue.config.jsé‡Œä¿®æ”¹ï¼Œä¹‹åé‡æ–°æ‰“åŒ…</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">	...</span><br><span class="line">    publicPath: <span class="string">'./'</span></span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h4 id="3ã€è§£å†³æ–¹æ³•">3ã€è§£å†³æ–¹æ³•</h4>
<ol>
<li>è·¯ç”±æ¨¡å¼è®¾ç½®ä¸ºhash<br>
â€ƒæ‰“å¼€<code>router/index.js</code>ï¼Œè®¾ç½®modeä¸ºhashåæ‰“åŒ…éƒ¨ç½²</li>
</ol>
 <figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"> <span class="keyword">const</span> router = <span class="keyword">new</span> VueRouter(&#123;</span><br><span class="line">    mode: <span class="string">'hash'</span>,</span><br><span class="line">    routes</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>è·¯ç”±æ¨¡å¼è®¾ç½®ä¸ºhistory<br>
â€ƒä½¿ç”¨è¿™ä¸ªæ¨¡å¼ï¼Œåœ¨å¼€å‘é˜¶æ®µä¸€åˆ‡éƒ½æ˜¯æ­£å¸¸çš„ï¼Œä½†æ˜¯éœ€è¦æ‰“åŒ…éƒ¨ç½²æ—¶ï¼Œéœ€è¦åœ¨<code>router/index.js</code>ä¸­æ·»åŠ baseå±æ€§ã€‚<a href="http://xn--nginxwww-8t1mv2in3id8aiz1avsc6xnwjy9tljymujbbygo7fg11ix8b.test.com/vue/app/%E7%9B%AE%E5%BD%95%E4%B8%8B%E7%9A%84%EF%BC%8C%E5%B0%B1%E5%BF%85%E9%A1%BB%E8%A6%81%E5%9C%A8%E6%B7%BB%E5%8A%A0" target="_blank" rel="noopener">å‡å¦‚æ‰“åŒ…çš„ç›®å½•æ–‡ä»¶æ˜¯æ”¾åœ¨nginxæœåŠ¡å™¨www.test.com/vue/app/ç›®å½•ä¸‹çš„ï¼Œå°±å¿…é¡»è¦åœ¨æ·»åŠ </a><strong>base:â€™/vue/app/â€™</strong>ï¼Œä¸¤è¾¹**/**éƒ½ä¸èƒ½ç¼ºå°‘</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> router = <span class="keyword">new</span> VueRouter(&#123;</span><br><span class="line">    mode: <span class="string">'history'</span>,</span><br><span class="line">    base: <span class="string">'/vue/app/'</span></span><br><span class="line">    routes</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>å‰ç«¯</category>
      </categories>
      <tags>
        <tag>Vue</tag>
      </tags>
  </entry>
  <entry>
    <title>Linuxä¸Šä½¿ç”¨dockerè¿è¡Œé…·Qæœºå™¨äºº</title>
    <url>/posts/18a55fe7.html</url>
    <content><![CDATA[<p>â€ƒæˆ‘ä»¬çŸ¥é“é…·Qæœºå™¨äººæ˜¯è¿è¡Œåœ¨windowsä¸Šçš„ï¼Œé…åˆå›¾çµæœºå™¨äººçš„APIå¯ä»¥å®ç°QQæˆ–è€…å¾®ä¿¡çš„è‡ªåŠ¨å¯¹è¯ï¼Œä½†æ˜¯å¦‚æœæƒ³è®©æœºå™¨äººä¸é—´æ–­24å°æ—¶è¿è¡Œï¼Œé‚£å°±éœ€è¦ä½¿ç”¨äº‘æœåŠ¡äº†ï¼Œå¹¶ä¸”éœ€è¦ä½¿ç”¨dockerä½œä¸ºè¿è¡Œçš„å®¹å™¨æ¥è¿è¡Œé…·Qæœºå™¨äººã€‚</p>
<h3 id="1ã€å®‰è£…å’Œè¿è¡Œdocker">1ã€å®‰è£…å’Œè¿è¡Œdocker</h3>
<p>è¿™é‡Œæˆ‘ç”¨äº†Centosçš„linuxæ“ä½œç³»ç»Ÿï¼Œä½¿ç”¨å…¶ä»–Linuxçš„ä¹Ÿå¤§åŒå°å¼‚ï¼Œä¸è¿‡è¿™é‡Œçš„æ“ä½œéƒ½éœ€è¦rootæƒé™ï¼Œæ²¡æœ‰çš„è¯éœ€è¦<code>sudo su</code>è·å¾—rootæƒé™</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#ä¸‹è½½docker</span></span><br><span class="line">yum install docker</span><br><span class="line"><span class="comment">#è¿è¡Œdocker</span></span><br><span class="line">systemctl start docker</span><br></pre></td></tr></table></figure>
<a id="more"></a>
<h3 id="2ã€ä¸‹è½½é…·Qé•œåƒ">2ã€ä¸‹è½½é…·Qé•œåƒ</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">docker pull coolq/wine-coolq</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œçš„é•œåƒæ˜¯ä»dockerä¸­å¤®ä»“åº“è·å–ï¼Œä¹Ÿæ˜¯åˆ«äººå·²ç»æ‰“åŒ…å¥½çš„é•œåƒï¼Œæˆ‘ä»¬ç›´æ¥æ‹¿æ¥ç”¨å°±è¡Œäº†<br>
<img src="https://img-blog.csdnimg.cn/20200522193608772.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xlbW9uX1RU,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>
ä½¿ç”¨<code>docker images</code>å¯ä»¥æŸ¥çœ‹æ‹‰å–çš„é•œåƒ<br>
<img src="https://img-blog.csdnimg.cn/20200522193655630.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h3 id="3ã€åå°è¿è¡Œé…·Qå®¹å™¨">3ã€åå°è¿è¡Œé…·Qå®¹å™¨</h3>
<p>åˆ›å»ºä¸€ä¸ªç”¨äºå­˜æ”¾ï¼ˆæ˜ å°„ï¼‰coolqæ•°æ®çš„ç›®å½•ï¼Œç”¨äºæŒä¹…åŒ–å­˜æ”¾coolqï¼ˆé…·Qåº”ç”¨ï¼‰çš„æ•°æ®ã€‚è¿™é‡Œæˆ‘åœ¨æ ¹ç›®å½•ä¸‹åˆ›å»ºcooqldataæ–‡ä»¶å¤¹</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mkdir /coolqdata</span><br></pre></td></tr></table></figure>
<p>åå°è¿è¡Œ<br>
docker run --name=coolq -d -p 8765:9000 -v /coolqdata:/home/user/coolq -e VNC_PASSWD=12345678 -e COOLQ_ACCOUNT=1000000 coolq/wine-coolq</p>
<h6 id="å…¶ä¸­éƒ¨åˆ†å‚æ•°æ ¹æ®è‡ªå·±çš„éœ€æ±‚æ›¿æ¢ï¼š">å…¶ä¸­éƒ¨åˆ†å‚æ•°æ ¹æ®è‡ªå·±çš„éœ€æ±‚æ›¿æ¢ï¼š</h6>
<p>è¿œç¨‹ç›‘å¬ç«¯å£<br>
8765(9000æ˜ å°„æˆ8765ï¼Œå‰é¢çš„ç«¯å£å·å¯ä»¥è‡ªå®šä¹‰)<br>
æ•°æ®å­˜æ”¾ä½ç½®<br>
/coolqdataï¼ˆå®¹å™¨å†…çš„/home/user/coolqè·¯å¾„ æ˜ å°„åˆ°æœ¬æœºçš„/coolqdataï¼‰<br>
è¿œç¨‹è®¿é—®å¯†ç <br>
12345678ï¼ˆåªèƒ½è®¾8ä½ï¼‰<br>
æœºå™¨äºº QQ å¸å·<br>
1000000</p>
<p>==æœ€åå¼€æ”¾è®¾ç½®çš„ç«¯å£å·==</p>
<h4 id="4ã€ç™»å½•VNCè¿›è¡Œæœºå™¨äººçš„è®¾ç½®">4ã€ç™»å½•VNCè¿›è¡Œæœºå™¨äººçš„è®¾ç½®</h4>
<p>æ‰“å¼€æµè§ˆå™¨ï¼Œåœ¨æµè§ˆå™¨è¾“å…¥æœåŠ¡å™¨ip+ç«¯å£å·å³å¯è¿›è¡Œè®¿é—®ï¼ŒæŒ‰è¦æ±‚è¿›è¡Œæœºå™¨äººçš„ç™»å½•è®¾ç½®ï¼Œå¯ä»¥ç™»å½•http://www.tuling123.com/ è·å–æœºå™¨äººå¯¹è¯çš„APIæ¥å£å¹¶æ”¾å…¥åˆ°é…·Qä¸­ï¼Œè¿™é‡Œå¦‚æœéœ€è¦å¤åˆ¶å¯ä½¿ç”¨æ—è¾¹çš„å·¥å…·</p>
<p><img src="https://img-blog.csdnimg.cn/20200522195848627.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xlbW9uX1RU,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<hr>
<p>å‚è€ƒæ–‡ç« :<a href="https://www.cnblogs.com/tielemao/p/8462263.html" target="_blank" rel="noopener">Linuxé€šè¿‡dockerå®‰è£…è¿è¡Œé…·Qâ€“ç”¨QQéª°å­å›è¿›è¡Œè·‘å›¢</a>.</p>
]]></content>
      <categories>
        <category>äº‘è®¡ç®—</category>
      </categories>
      <tags>
        <tag>docker</tag>
      </tags>
  </entry>
  <entry>
    <title>Centoså¯åŠ¨Ipv4åœ°å€è¿›è¡Œè¿œç¨‹è¿æ¥å’ŒYumæ¢æº</title>
    <url>/posts/2a55c286.html</url>
    <content><![CDATA[<h3 id="å¯åŠ¨Ipv4åœ°å€">å¯åŠ¨Ipv4åœ°å€</h3>
<p>â€ƒå¥½å¤šæ—¶å€™ï¼Œåœ¨è™šæ‹Ÿæœºä¸­å®‰è£…å®Œåï¼Œè¿›å»centosä¸­ï¼Œä½¿ç”¨<code>ifconfig</code>å‘ç°æ²¡æœ‰æ­¤å‘½ä»¤ï¼Œå¯ä½¿ç”¨<code>ip a</code>æŸ¥çœ‹IPï¼Œä½†æ˜¯æœ‰æ—¶ä½ ä¼šå‘ç°æ²¡æœ‰æ˜¾ç¤ºipv4çš„åœ°å€ï¼Œè¿™æ ·æˆ‘ä»¬ä¹Ÿæ— æ³•è¿›è¡Œè¿œç¨‹è¿æ¥ï¼Œè¿™ä¸ªé—®é¢˜åŸå› æ˜¯å®‰è£…centosçš„æ—¶å€™æ²¡æœ‰å¯ç”¨é»˜è®¤çš„ç½‘å¡<br>
è§£å†³åŠæ³•:<br>
CentOSé…ç½®ç½‘å¡å¼€æœºè‡ªåŠ¨è·å–IPåœ°å€</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> /etc/sysconfig/network-scripts</span><br><span class="line"><span class="comment">#æ³¨æ„è¿™æ˜¯æˆ‘çš„ç½‘å¡é…ç½®ï¼Œå…·ä½“æœºå™¨éœ€è¦lsæŸ¥çœ‹ä¸€ä¸‹</span></span><br><span class="line">vim ifcfg-ens33</span><br></pre></td></tr></table></figure>
<p>è¿›å…¥é…ç½®åå°† <code>ONBOOT=â€noâ€</code> æ”¹ä¸º <code>ONBOOT=â€yesâ€</code><br>
ä¿å­˜åæ‰§è¡Œ<code>systemctl restart network</code></p>
<a id="more"></a>
<h3 id="Centos-Yumæ¢æº">Centos Yumæ¢æº</h3>
<h6 id="1-å¤‡ä»½">1. å¤‡ä»½</h6>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mv /etc/yum.repos.d/CentOS-Base.repo /etc/yum.repos.d/CentOS-Base.repo.backup</span><br></pre></td></tr></table></figure>
<h5 id="2-ä¸‹è½½æ–°çš„-CentOS-Base-repo-åˆ°-etc-yum-repos-d">2. ä¸‹è½½æ–°çš„ CentOS-Base.repo åˆ° /etc/yum.repos.d/</h5>
<p><strong>CentOS 6</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">wget -O /etc/yum.repos.d/CentOS-Base.repo https://mirrors.aliyun.com/repo/Centos-6.repo</span><br></pre></td></tr></table></figure>
<p>æˆ–è€…</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">curl -o /etc/yum.repos.d/CentOS-Base.repo https://mirrors.aliyun.com/repo/Centos-6.repo</span><br></pre></td></tr></table></figure>
<p><strong>CentOS 7</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">wget -O /etc/yum.repos.d/CentOS-Base.repo https://mirrors.aliyun.com/repo/Centos-7.repo</span><br></pre></td></tr></table></figure>
<p>æˆ–è€…</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">curl -o /etc/yum.repos.d/CentOS-Base.repo https://mirrors.aliyun.com/repo/Centos-7.repo</span><br></pre></td></tr></table></figure>
<p><strong>CentOS 8</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">wget -O /etc/yum.repos.d/CentOS-Base.repo https://mirrors.aliyun.com/repo/Centos-8.repo</span><br></pre></td></tr></table></figure>
<p>æˆ–è€…</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">curl -o /etc/yum.repos.d/CentOS-Base.repo https://mirrors.aliyun.com/repo/Centos-8.repo</span><br></pre></td></tr></table></figure>
<h5 id="3-è¿è¡Œ-yum-makecache-ç”Ÿæˆç¼“å­˜">3. è¿è¡Œ <code>yum makecache</code> ç”Ÿæˆç¼“å­˜</h5>
]]></content>
      <tags>
        <tag>è™šæ‹Ÿæœº</tag>
      </tags>
  </entry>
  <entry>
    <title>Centos7å®‰è£…Anacondaå®ç°è¿œç¨‹Jupyterç™»é™†</title>
    <url>/posts/191c082b.html</url>
    <content><![CDATA[<h3 id="1ã€ä¸‹è½½Anaconda">1ã€ä¸‹è½½Anaconda</h3>
<blockquote>
<p>å®˜æ–¹ä¸‹è½½: <a href="https://www.anaconda.com/download/" target="_blank" rel="noopener">https://www.anaconda.com/download/</a><br>
æ¸…åé•œåƒä¸‹è½½: <a href="https://mirrors.tuna.tsinghua.edu.cn/anaconda/archive/?C=N&amp;O=D" target="_blank" rel="noopener">https://mirrors.tuna.tsinghua.edu.cn/anaconda/archive/?C=N&amp;O=D</a></p>
</blockquote>
<p>â€ƒcentosåœ¨çº¿ä¸‹è½½æœ€æ–°ç‰ˆAnaconda</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">wget https://mirrors.tuna.tsinghua.edu.cn/anaconda/archive/Anaconda3-2020.02-Linux-x86_64.sh</span><br></pre></td></tr></table></figure>
<a id="more"></a>
<h3 id="2ã€Anacondaå®‰è£…">2ã€Anacondaå®‰è£…</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">bash Anaconda3-2020.02-Linux-x86_64.sh</span><br></pre></td></tr></table></figure>
<p>â€ƒåœ¨å®‰è£…çš„è¿‡ç¨‹ä¸­é—´å¯èƒ½ä¼šæœ‰äº›è¯¢é—®ï¼Œæ¯”å¦‚æ˜¯å¦æŒ‡å®šæ–°çš„å®‰è£…ä½ç½®ç­‰ï¼Œæˆ‘è¿™é‡Œéƒ½é€‰æ‹©äº†é»˜è®¤å®‰è£…äº†ã€‚</p>
<h3 id="3ã€åŠ è½½é…ç½®">3ã€åŠ è½½é…ç½®</h3>
<p>â€ƒå®‰è£…å®Œæˆåï¼Œanacondaä¼šè‡ªåŠ¨åˆå§‹åŒ–ï¼Œåˆå§‹åŒ–è¿‡ç¨‹ä¸­ä¼šåœ¨ <code>~/.bashrc </code>æ–‡ä»¶ä¸­å†™å…¥ä¸€äº›å†…å®¹ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦é‡æ–°åŠ è½½è¯¥æ–‡ä»¶ä½¿anacondaç”Ÿæ•ˆ</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">source</span> ~/.bashrc</span><br></pre></td></tr></table></figure>
<p>â€ƒæˆåŠŸæ‰§è¡Œåå¯ä»¥å‘ç°å‘½ä»¤æç¤ºç¬¦å‰é¢åŠ äº†ä¸€ä¸ª(base)ï¼Œè¿™å°±è¯´æ˜æˆåŠŸå®‰è£…äº†anaconda<br>
<img src="https://img-blog.csdnimg.cn/20200507203600596.png" alt="Alt"><br>
â€ƒè¿™é‡Œè¦æ³¨æ„çš„æ˜¯ï¼Œ<code>~/.bashrc</code>åˆå§‹åŒ–çš„æ—¶å€™ï¼Œanacondaæ˜¯é»˜è®¤æ‰§è¡Œ<br>
<code>conda  activate base</code>å‘½ä»¤çš„ï¼Œå¦‚æœæƒ³å˜å›åŸæ¥çš„ç»ˆç«¯ï¼Œåªéœ€è¦æ‰§è¡Œ<code>conda deactivate</code>å‘½ä»¤ã€‚å¦‚æœæƒ³è¦æ°¸ä¹…æ¶ˆé™¤ï¼Œ<code>vim  ~/.bashrc</code>è¿›å…¥æ–‡ä»¶åœ¨æœ€ååŠ ä¸Š<code>conda deactivate</code>ï¼Œä¿å­˜é€€å‡ºå°±å¯<br>
<img src="https://img-blog.csdnimg.cn/2020050720562438.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xlbW9uX1RU,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°">â€ƒå¦å¤–ï¼Œå¦‚æœéœ€è¦å¦å¤–å®‰è£…åº“ï¼Œåˆ™åªéœ€è¦</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">conda install xxx</span><br></pre></td></tr></table></figure>
<h3 id="4ã€é…ç½®jupyter-notebook">4ã€é…ç½®jupyter notebook</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#è¿›å…¥conda baseç¯å¢ƒï¼Œåé¢æ“ä½œéƒ½éœ€è¦åœ¨baseç¯å¢ƒä¸‹</span></span><br><span class="line">conda activate base</span><br><span class="line"><span class="comment">#ç”Ÿæˆjupyterçš„é…ç½®æ–‡ä»¶</span></span><br><span class="line">jupyter notebook --generate-config</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/20200507210502610.png" alt="alt"><br>
â€ƒåœ¨è®¾ç½®è¿œç¨‹ç™»é™†é…ç½®å‰ï¼Œé¦–å…ˆéœ€è¦ç”Ÿæˆç§˜é’¥</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#è¿›å…¥pythonäº¤äº’ç¯å¢ƒ</span></span><br><span class="line">ipython</span><br><span class="line"><span class="comment">#å¯¼å…¥ä¾èµ–</span></span><br><span class="line"><span class="keyword">from</span> notebook.auth <span class="keyword">import</span> passwd</span><br><span class="line"><span class="comment">#ç”Ÿæˆç§˜é’¥ï¼Œç”Ÿæˆçš„ç§˜é’¥è¦å¤åˆ¶</span></span><br><span class="line">passwd()</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/20200507215931671.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xlbW9uX1RU,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>
â€ƒè¿›å…¥é…ç½®æ–‡ä»¶å¹¶ç¼–è¾‘<code>vim /root/.jupyter/jupyter_notebook_config.py</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># åœ¨ç©ºç™½åŒºåŸŸè¿›è¡Œæ’å…¥</span></span><br><span class="line">c.NotebookApp.ip = <span class="string">'*'</span> <span class="comment">#å…è®¸è®¿é—®æ­¤æœåŠ¡å™¨çš„ IPï¼Œæ˜Ÿå·è¡¨ç¤ºä»»æ„ IP</span></span><br><span class="line">c.NotebookApp.password = u<span class="string">'sha1:fdd89498b287:bbb896de44a315f88c0e699db0798ebc2c098686'</span> <span class="comment"># ä¹‹å‰ç”Ÿæˆçš„å¯†ç  hash å­—ä¸²</span></span><br><span class="line">c.NotebookApp.open_browser = False <span class="comment"># è¿è¡Œæ—¶ä¸æ‰“å¼€æœ¬æœºæµè§ˆå™¨</span></span><br><span class="line">c.NotebookApp.port = 9999 <span class="comment"># ç«¯å£éšæ„è®¾ç½®ï¼Œæ³¨æ„ç¡®ä¿äº‘æœåŠ¡å™¨æ­¤ç«¯å£è¦å¼€æ”¾ã€‚</span></span><br><span class="line">c.NotebookApp.enable_mathjax = True <span class="comment"># å¯ç”¨ MathJax</span></span><br><span class="line">c.NotebookApp.allow_root = True</span><br><span class="line">c.NotebookApp.notebook_dir = <span class="string">'/root/JupyterNotebook'</span> <span class="comment">#å·¥ä½œç›®å½•ï¼Œä¿å­˜ä»£ç é¡¹ç›®æ–‡ä»¶ã€‚</span></span><br></pre></td></tr></table></figure>
<p>â€ƒä¿å­˜åé€€å‡ºï¼Œå¹¶åˆ›å»ºå·¥ä½œç›®å½•</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mkdir /root/JupyterNotebook</span><br></pre></td></tr></table></figure>
<p>â€ƒå¦å¤–è¦æ³¨æ„äº‘æœåŠ¡å™¨ç«¯å£çš„å¼€æ”¾ã€‚</p>
<h3 id="5ã€jupyteråå°è¿è¡Œ">5ã€jupyteråå°è¿è¡Œ</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#åå°è¿è¡Œ</span></span><br><span class="line">nohup jupyter notebook &amp;</span><br></pre></td></tr></table></figure>
<p>æˆåŠŸåå¯ä»¥æ‰“å¼€æµè§ˆå™¨å³å¯è¿œç¨‹ç™»é™†ä½¿ç”¨å•¦<br>
<img src="https://img-blog.csdnimg.cn/20200507220815404.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xlbW9uX1RU,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
]]></content>
      <categories>
        <category>äº‘è®¡ç®—</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title>pythonå®ç°Synology NASçš„å…³æœº</title>
    <url>/posts/461ef441.html</url>
    <content><![CDATA[<h4 id="ä¸€ã€é—®é¢˜æè¿°">ä¸€ã€é—®é¢˜æè¿°</h4>
<p>â€ƒå› ä¸ºéœ€è¦ä½¿ç”¨ç¼–ç¨‹è¿›è¡ŒNASçš„å…³æœºï¼Œè€Œä¸”è¿™ä¸ªç¨‹åºä¸èƒ½åœ¨NASå†…éƒ¨è¿è¡Œï¼Œå› æ­¤æƒ³åˆ°äº†ä½¿ç”¨è¿œç¨‹è¿æ¥æ¥è¿›è¡ŒNASçš„å…³æœºæ“ä½œã€‚å› ä¸ºNASæ˜¯ä¸€ç§å®šåˆ¶çš„LINUXç³»ç»Ÿï¼Œå› æ­¤å¯ä»¥åˆ©ç”¨Pythonä½¿ç”¨SSHæ¥è¿œç¨‹è¿æ¥ï¼Œå¹¶ä½¿ç”¨å‘½ä»¤è¡Œå…³æœºæŒ‡ä»¤<code>shutdown -h now</code>å®ç°è¿œç¨‹å…³æœºã€‚</p>
<a id="more"></a>
<h4 id="äºŒã€å®éªŒæ­¥éª¤">äºŒã€å®éªŒæ­¥éª¤</h4>
<h5 id="1ã€å¯ç”¨NASçš„SSHåŠŸèƒ½">1ã€å¯ç”¨NASçš„SSHåŠŸèƒ½</h5>
<p>1ã€æ‰“å¼€æ§åˆ¶é¢æ¿é€‰æ‹©é«˜çº§æ¨¡å¼<br>
<img src="https://img-blog.csdnimg.cn/20200429112924953.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xlbW9uX1RU,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>
2ã€è¿›å…¥ç»ˆç«¯æœºå’ŒSNMP<br>
<img src="https://img-blog.csdnimg.cn/2020042911293858.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xlbW9uX1RU,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>
3ã€é€‰æ‹©å¯ç”¨SSHåŠŸèƒ½<br>
<img src="https://img-blog.csdnimg.cn/20200429112942903.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xlbW9uX1RU,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h5 id="2ã€Pythonå®ç°è¿œç¨‹å…³æœº">2ã€Pythonå®ç°è¿œç¨‹å…³æœº</h5>
<p>1ã€å®‰è£…paramikoæ¨¡å—<br>
â€ƒparamikoæ˜¯ç”¨pythonè¯­è¨€å†™çš„ä¸€ä¸ªæ¨¡å—ï¼Œéµå¾ªSSH2åè®®ï¼Œæ”¯æŒä»¥åŠ å¯†å’Œè®¤è¯çš„æ–¹å¼ï¼Œè¿›è¡Œè¿œç¨‹æœåŠ¡å™¨çš„è¿æ¥ã€‚è·Ÿå¸¸ç”¨è½¯ä»¶xshell ã€xftpåŠŸèƒ½ä¸€æ ·ï¼Œä½†æ˜¯å¯ä»¥è¿æ¥å¤šå°æœåŠ¡å™¨ï¼Œè¿›è¡Œå¤æ‚çš„æ“ä½œã€‚<br>
â€ƒåœ¨è¿™é‡Œæˆ‘ä½¿ç”¨äº†Jupyterï¼Œå› æ­¤ä½¿ç”¨äº†anacondaå®‰è£…æ–¹æ³•ã€‚æ‰“å¼€<code>Anaconda Prompt (anaconda)</code>ç»ˆç«¯ï¼Œè¾“å…¥ä»¥ä¸‹å‘½ä»¤</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">conda install paramiko</span><br></pre></td></tr></table></figure>
<p>2ã€æ‰§è¡ŒPythonç¨‹åº<br>
â€ƒè¿™é‡Œä½¿ç”¨äº†SSHClientåŸºäºç”¨æˆ·åå’Œå¯†ç çš„ sshclient æ–¹å¼ç™»å½•ã€‚å…¶ä¸­hostnameå¡«å†™NASçš„ipåœ°å€ï¼Œpasswordå¡«å†™è‡ªå·±è®¾ç½®çš„å¯†ç ï¼Œcommandæ˜¯éœ€è¦æ‰§è¡Œçš„å‘½ä»¤ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> paramiko</span><br><span class="line"></span><br><span class="line"><span class="comment"># å»ºç«‹ä¸€ä¸ªsshclientå¯¹è±¡</span></span><br><span class="line">ssh = paramiko.SSHClient()</span><br><span class="line"><span class="comment"># å…è®¸å°†ä¿¡ä»»çš„ä¸»æœºè‡ªåŠ¨åŠ å…¥åˆ°host_allow åˆ—è¡¨ï¼Œæ­¤æ–¹æ³•å¿…é¡»æ”¾åœ¨connectæ–¹æ³•çš„å‰é¢</span></span><br><span class="line">ssh.set_missing_host_key_policy(paramiko.AutoAddPolicy())</span><br><span class="line"><span class="comment"># è°ƒç”¨connectæ–¹æ³•è¿æ¥æœåŠ¡å™¨</span></span><br><span class="line"><span class="comment"># éœ€è¦ç®¡ç†å‘˜è´¦å·</span></span><br><span class="line">ssh.connect(hostname=<span class="string">'192.168.1.104'</span>, port=<span class="number">22</span>, username=<span class="string">'root'</span>, password=<span class="string">'123456'</span>)</span><br><span class="line"><span class="comment"># æ‰§è¡Œå‘½ä»¤</span></span><br><span class="line"><span class="comment"># å…³æœºå‘½ä»¤</span></span><br><span class="line">command=<span class="string">"shutdown -h now"</span></span><br><span class="line">stdin, stdout, stderr = ssh.exec_command(command)</span><br><span class="line"><span class="comment"># ç»“æœæ”¾åˆ°stdoutä¸­ï¼Œå¦‚æœæœ‰é”™è¯¯å°†æ”¾åˆ°stderrä¸­</span></span><br><span class="line">print(stdout.read().decode())</span><br><span class="line">print(<span class="string">'æ‰§è¡Œå®Œæ¯•'</span>)</span><br><span class="line"><span class="comment"># å…³é—­è¿æ¥</span></span><br><span class="line">ssh.close()</span><br></pre></td></tr></table></figure>
<hr>
<p>å…¶ä»–ç™»å½•æ–¹å¼å‚è€ƒ<br>
<a href="https://blog.csdn.net/appke846/article/details/80514024" target="_blank" rel="noopener">å‚è€ƒæ–‡ç« </a></p>
]]></content>
      <categories>
        <category>äº‘è®¡ç®—</category>
      </categories>
      <tags>
        <tag>äº‘è®¡ç®—</tag>
      </tags>
  </entry>
  <entry>
    <title>javaè®¾è®¡æ¨¡å¼----ä»£ç†æ¨¡å¼</title>
    <url>/posts/31773db5.html</url>
    <content><![CDATA[<h3 id="ä¸€ã€ä»£ç†æ¨¡å¼ä»‹ç»">ä¸€ã€ä»£ç†æ¨¡å¼ä»‹ç»</h3>
<p>â€ƒä»£ç†æ¨¡å¼(Proxy Pattern)ï¼Œæ˜¯23ç§è®¾è®¡æ¨¡å¼ä¹‹ä¸€ï¼Œå®ƒå…³å¿ƒçš„ä¸»è¦æ˜¯è¿‡ç¨‹ï¼Œè€Œä¸æ˜¯ç»“æœã€‚ä»£ç†æ¨¡å¼ä¸»è¦æä¾›äº†å¯¹ç›®æ ‡å¯¹è±¡çš„é—´æ¥è®¿é—®æ–¹å¼ï¼Œå³é€šè¿‡ä»£ç†å¯¹è±¡æ¥è®¿é—®ç›®æ ‡å¯¹è±¡ï¼Œè¿™æ ·å¯ä»¥åœ¨ç›®æ ‡å¯¹è±¡å®ç°çš„åŸºç¡€ä¸Šï¼Œ==å¢å¼ºé¢å¤–çš„åŠŸèƒ½æ“ä½œï¼Œå³æ‰©å±•ç›®æ ‡å¯¹è±¡çš„åŠŸèƒ½==ï¼Œ<em>SpringAop</em>ä¾¿æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­ã€‚è€Œè¢«ä»£ç†çš„å¯¹è±¡å¯ä»¥æ˜¯è¿œç¨‹å¯¹è±¡ã€åˆ›å»ºå¼€é”€å¤§çš„å¯¹è±¡æˆ–éœ€è¦å®‰å…¨æ§åˆ¶çš„å¯¹è±¡ã€‚ä»£ç†æ¨¡å¼çš„ç®€å•ç¤ºæ„å›¾å¦‚ä¸‹ã€‚<br>
<img src="https://img-blog.csdnimg.cn/2020041418500189.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xlbW9uX1RU,size_16,color_FFFFFF,t_70" alt="ä»£ç†æ¨¡å¼ç¤ºæ„å›¾"><br>
â€ƒä»£ç†æ¨¡å¼ä¸»è¦æœ‰ä¸‰ç§å®ç°æ–¹å¼ <strong>é™æ€ä»£ç†</strong>ã€<strong>åŠ¨æ€ä»£ç†</strong>(JDKä»£ç†ã€æ¥å£ä»£ç†)å’Œ<strong>Cglibä»£ç†</strong>(ä¸éœ€è¦å®ç°æ¥å£)ã€‚</p>
<a id="more"></a>
<h3 id="äºŒã€ä¸‰ç§ä»£ç†æ¨¡å¼çš„ç®€å•ä»‹ç»">äºŒã€ä¸‰ç§ä»£ç†æ¨¡å¼çš„ç®€å•ä»‹ç»</h3>
<h4 id="1ã€é™æ€ä»£ç†">1ã€é™æ€ä»£ç†</h4>
<h6 id="1ã€ä»‹ç»">1ã€ä»‹ç»</h6>
<p>â€ƒé™æ€ä»£ç†UMLç±»å›¾å¦‚ä¸‹å›¾ï¼ŒStudentDaoProxyç±»æ˜¯ä»£ç†ç±»ï¼Œé€šè¿‡èšåˆçš„æ–¹å¼ä»£ç†StudentDaoç±»ï¼ŒåŒæ—¶StudentDaoç±»å’Œä»£ç†ç±»éƒ½å®ç°IStudentDaoæ¥å£ç±»ã€‚<br>
â€ƒé™æ€ä»£ç†çš„ä¼˜ç‚¹æ˜¯èƒ½å¤Ÿè¾ƒä¸ºç®€å•å¿«é€Ÿçš„åœ¨ä¸ä¿®æ”¹ç›®æ ‡å¯¹è±¡çš„å‰æä¸‹ï¼Œå¯¹ç›®æ ‡å¯¹è±¡åŠŸèƒ½è¿›è¡Œæ‰©å±•ï¼›è€Œç¼ºç‚¹å°±æ˜¯ä¸å¤Ÿçµæ´»ï¼Œå¦‚æœæ¥å£æ–°å¢æ–¹æ³•ï¼Œé‚£ä¹ˆéœ€è¦ç»´æŠ¤ç±»çš„æˆæœ¬å¤ªå¤§ã€‚<img src="https://img-blog.csdnimg.cn/2020041419041627.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xlbW9uX1RU,size_16,color_FFFFFF,t_70" alt="é™æ€ä»£ç†"></p>
<h6 id="2ã€ä»£ç å®ç°">2ã€ä»£ç å®ç°</h6>
<p>â‘ æ–°å»ºIStudentDaoæ¥å£ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IStudentDao</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">read</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>â‘¡è¢«ä»£ç†çš„å­¦ç”Ÿç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StudentDao</span> <span class="keyword">implements</span> <span class="title">IStudentDao</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"æ­£åœ¨è¯»ä¹¦ä¸­ã€‚ã€‚ã€‚ã€‚ã€‚"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>â‘¢åˆ›å»ºä»£ç†ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StudentDaoProxy</span> <span class="keyword">implements</span> <span class="title">IStudentDao</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// è¢«ä»£ç†ç±»èšåˆåˆ°ä»£ç†ç±»</span></span><br><span class="line">	<span class="keyword">private</span> StudentDao studentDao;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">StudentDaoProxy</span><span class="params">(StudentDao studentDao)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// é€šè¿‡æ„é€ å™¨ä¼ å…¥èšåˆå¯¹è±¡ï¼Œä¹Ÿå¯ä»¥é€šè¿‡setæ–¹æ³•ä¼ å…¥</span></span><br><span class="line">		<span class="keyword">this</span>.studentDao=studentDao;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="comment">// å¢å¼ºæ–¹æ³•ï¼Œè¿™é‡Œå¯ä»¥å†™å…¶ä»–å¤æ‚ä¸šåŠ¡</span></span><br><span class="line">		System.out.println(<span class="string">"æ‰“å¼€ä¹¦æœ¬ã€‚ã€‚ã€‚ã€‚ã€‚"</span>);</span><br><span class="line">		<span class="comment">//è¢«ä»£ç†ç±»åŸæ–¹æ³•</span></span><br><span class="line">		studentDao.read();</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>â‘£ç”¨æˆ·æµ‹è¯•ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		StudentDao studentDao = <span class="keyword">new</span> StudentDao();</span><br><span class="line">		StudentDaoProxy studentDaoProxy = <span class="keyword">new</span> StudentDaoProxy(studentDao);</span><br><span class="line">		<span class="comment">// ä½¿ç”¨ä»£ç†æ–¹æ³•</span></span><br><span class="line">		studentDaoProxy.read();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¾“å‡ºç»“æœ</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">æ‰“å¼€ä¹¦æœ¬ã€‚ã€‚ã€‚ã€‚ã€‚</span><br><span class="line">æ­£åœ¨è¯»ä¹¦ä¸­ã€‚ã€‚ã€‚ã€‚ã€‚</span><br></pre></td></tr></table></figure>
<h4 id="2ã€åŠ¨æ€ä»£ç†">2ã€åŠ¨æ€ä»£ç†</h4>
<h6 id="1ã€ä»‹ç»-v2">1ã€ä»‹ç»</h6>
<p>â€ƒåŠ¨æ€ä»£ç†å¯¹è±¡ä¸éœ€è¦å®ç°æ¥å£ï¼Œä½†æ˜¯ç›®æ ‡å¯¹è±¡è¿˜æ˜¯éœ€è¦å®ç°æ¥å£ã€‚è€Œä»£ç†å¯¹è±¡çš„ç”Ÿæˆï¼Œæ˜¯åˆ©ç”¨JDKçš„APIï¼ŒåŠ¨æ€çš„åœ¨å†…å­˜ä¸­æ„å»ºä»£ç†å¯¹è±¡ï¼Œç›¸æ¯”äºé™æ€ä»£ç†çµæ´»çš„å¤šï¼Œæ‰€ä»¥ä¹Ÿå«JDKä»£ç†æˆ–æ¥å£ä»£ç†ã€‚å…¶UMLç±»å›¾å¦‚ä¸‹<br>
<img src="https://img-blog.csdnimg.cn/20200414195831770.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xlbW9uX1RU,size_16,color_FFFFFF,t_70" alt="åŠ¨æ€ä»£ç†"></p>
<h6 id="2ã€ä»£ç å®ç°-v2">2ã€ä»£ç å®ç°</h6>
<p>â‘ æ–°å»ºIStudentDaoæ¥å£ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IStudentDao</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">read</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>â‘¡è¢«ä»£ç†çš„å­¦ç”Ÿç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StudentDao</span> <span class="keyword">implements</span> <span class="title">IStudentDao</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"æ­£åœ¨è¯»ä¹¦ä¸­ã€‚ã€‚ã€‚ã€‚ã€‚"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>â‘¢åˆ›å»ºä»£ç†ç±»<br>
è¿™é‡Œç›¸æ¯”é™æ€ä»£ç†æœ‰ç‚¹å°ä¿®æ”¹ï¼ŒJDKä»£ç†éœ€è¦ä½¿ç”¨<code>newProxyInstance</code>æ–¹æ³•ï¼Œå…¶å®Œæ•´å†™æ³•æ˜¯<code>static Object newProxyInstance(ClassLoader loader,Class&lt;?&gt;[] interfaces,InvocationHandlerh)</code>ï¼Œè¯¥æ–¹æ³•åœ¨<code>java.lang.reflect.Proxy</code>åŒ…å†…ï¼Œé€šè¿‡åå°„æœºåˆ¶å®ç°ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProxyFactory</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// è¢«ä»£ç†ç±»èšåˆåˆ°ä»£ç†ç±»</span></span><br><span class="line">	<span class="keyword">private</span> Object target;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">ProxyFactory</span><span class="params">(Object studentDao)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// é€šè¿‡æ„é€ å™¨ä¼ å…¥èšåˆå¯¹è±¡ï¼Œä¹Ÿå¯ä»¥é€šè¿‡setæ–¹æ³•ä¼ å…¥</span></span><br><span class="line">		<span class="keyword">this</span>.target=studentDao;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//ç»™ç›®æ ‡å¯¹è±¡ ç”Ÿæˆä¸€ä¸ªä»£ç†å¯¹è±¡</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Object <span class="title">getProxyInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">			<span class="comment">//è¯´æ˜</span></span><br><span class="line">			<span class="comment">/*</span></span><br><span class="line"><span class="comment">			 *  public static Object newProxyInstance(ClassLoader loader,</span></span><br><span class="line"><span class="comment">	                                          Class&lt;?&gt;[] interfaces,</span></span><br><span class="line"><span class="comment">	                                          InvocationHandler h)	                                          </span></span><br><span class="line"><span class="comment">	            //1. ClassLoader loader ï¼š æŒ‡å®šå½“å‰ç›®æ ‡å¯¹è±¡ä½¿ç”¨çš„ç±»åŠ è½½å™¨, è·å–åŠ è½½å™¨çš„æ–¹æ³•å›ºå®š</span></span><br><span class="line"><span class="comment">	            //2. Class&lt;?&gt;[] interfaces: ç›®æ ‡å¯¹è±¡å®ç°çš„æ¥å£ç±»å‹ï¼Œä½¿ç”¨æ³›å‹æ–¹æ³•ç¡®è®¤ç±»å‹</span></span><br><span class="line"><span class="comment">	            //3. InvocationHandler h : äº‹æƒ…å¤„ç†ï¼Œæ‰§è¡Œç›®æ ‡å¯¹è±¡çš„æ–¹æ³•æ—¶ï¼Œä¼šè§¦å‘äº‹æƒ…å¤„ç†å™¨æ–¹æ³•, ä¼šæŠŠå½“å‰æ‰§è¡Œçš„ç›®æ ‡å¯¹è±¡æ–¹æ³•ä½œä¸ºå‚æ•°ä¼ å…¥</span></span><br><span class="line"><span class="comment">			 */</span></span><br><span class="line">			<span class="keyword">return</span> Proxy.newProxyInstance(target.getClass().getClassLoader(), </span><br><span class="line">					target.getClass().getInterfaces(), </span><br><span class="line">					<span class="keyword">new</span> MyInvocationHandler()); </span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">		 <span class="class"><span class="keyword">class</span> <span class="title">MyInvocationHandler</span> <span class="keyword">implements</span> <span class="title">InvocationHandler</span></span>&#123;</span><br><span class="line"></span><br><span class="line">			<span class="meta">@Override</span></span><br><span class="line">			<span class="function"><span class="keyword">public</span> Object <span class="title">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span>  <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">				<span class="comment">// è‡ªå®šä¹‰ä¸šåŠ¡é€»è¾‘</span></span><br><span class="line">				System.out.println(<span class="string">"JDKä»£ç†å¼€å§‹~~"</span>);</span><br><span class="line">				<span class="comment">//åå°„æœºåˆ¶è°ƒç”¨ç›®æ ‡å¯¹è±¡çš„æ–¹æ³•</span></span><br><span class="line">				Object returnVal = method.invoke(target, args);</span><br><span class="line">				System.out.println(<span class="string">"JDKä»£ç†æäº¤"</span>);</span><br><span class="line">				<span class="keyword">return</span> returnVal;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>â‘£ç”¨æˆ·æµ‹è¯•ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		StudentDao studentDao = <span class="keyword">new</span> StudentDao();</span><br><span class="line">		ProxyFactory studentDaoProxy = <span class="keyword">new</span> ProxyFactory(studentDao);</span><br><span class="line">		<span class="comment">// ä½¿ç”¨ä»£ç†æ–¹æ³•,æ³¨æ„è¿™é‡Œä¸€å®šè¦ç”¨æ¥å£æ¥æ”¶</span></span><br><span class="line">		IStudentDao studentDao2 = (IStudentDao) studentDaoProxy.getProxyInstance();</span><br><span class="line">		studentDao2.read();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç»“æœ</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">JDKä»£ç†å¼€å§‹~~</span><br><span class="line">æ­£åœ¨è¯»ä¹¦ä¸­ã€‚ã€‚ã€‚ã€‚ã€‚</span><br><span class="line">JDKä»£ç†æäº¤</span><br></pre></td></tr></table></figure>
<h4 id="3ã€Cglibä»£ç†">3ã€Cglibä»£ç†</h4>
<h6 id="1ã€ä»‹ç»-v3">1ã€ä»‹ç»</h6>
<ul>
<li>åŠ¨æ€ä»£ç†æˆ–é™æ€ä»£ç†éƒ½è¦æ±‚å®ç°ä¸€ä¸ªæ¥å£ï¼Œä½†æ˜¯å¯¹äºCglibå¹¶ä¸éœ€è¦å®ç°ä»»ä½•æ¥å£ã€‚</li>
<li>Cglibä»£ç†ä¹Ÿå«ä½œå­ç±»ä»£ç†ï¼Œå®ƒæ˜¯åœ¨å†…å­˜ä¸­æ„å»ºä¸€ä¸ªå­ç±»å¯¹è±¡ä»è€Œå®ç°å¯¹ç›®æ ‡å¯¹è±¡åŠŸèƒ½æ‰©å±•ï¼Œæ‰€ä»¥ä¹Ÿå¯ç§°ä¸ºåŠ¨æ€ä»£ç†ã€‚</li>
<li>Cglibæ˜¯ä¸€ä¸ªå¼ºå¤§çš„é«˜æ€§èƒ½çš„ä»£ç ç”ŸæˆåŒ…ï¼Œå®ƒå¯ä»¥åœ¨è¿è¡ŒæœŸæ‰©å±•javaç±»ä¸å®ç°javaæ¥å£ã€‚å®ƒå¹¿æ³›çš„è¢«è®¸å¤šAOPæ¡†æ¶ä½¿ç”¨ï¼Œä¾‹å¦‚SpringAOPï¼Œå®ç°æ–¹æ³•æ‹¦æˆªã€‚</li>
<li>åœ¨AOPç¼–ç¨‹ä¸­å¦‚ä½•é€‰æ‹©ä»£ç†æ¨¡å¼ï¼š<br>
1.ç›®æ ‡å¯¹è±¡éœ€è¦å®ç°æ¥å£ï¼Œç”¨JDKä»£ç†<br>
2.ç›®æ ‡å¯¹è±¡ä¸éœ€è¦å®ç°æ¥å£ï¼Œç”¨Cglibä»£ç†</li>
<li>CglibåŒ…çš„åº•å±‚æ˜¯é€šè¿‡ä½¿ç”¨å­—èŠ‚ç å¤„ç†æ¡†æ¶ASMæ¥è½¬æ¢å­—èŠ‚ç å¹¶ç”Ÿæˆæ–°çš„ç±»<br>
<img src="https://img-blog.csdnimg.cn/20200414200122604.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xlbW9uX1RU,size_16,color_FFFFFF,t_70" alt="cglibä»£ç†"></li>
</ul>
<h6 id="2ã€ä»£ç å®ç°-v3">2ã€ä»£ç å®ç°</h6>
<p>ä½¿ç”¨Cglibæ—¶ä»£ç†çš„ç±»ä¸èƒ½ä¸ºfinal/staticï¼Œå¦åˆ™ä¸ä¼šè¢«æ‹¦æˆªï¼ŒåŒæ—¶éœ€è¦å¼•å…¥cglibç›¸å…³jaråŒ…<br>
é“¾æ¥ï¼š<a href="https://pan.baidu.com/s/1ydin81D5ueuIm2cbSXSnIw" target="_blank" rel="noopener">https://pan.baidu.com/s/1ydin81D5ueuIm2cbSXSnIw</a><br>
æå–ç ï¼šb5au</p>
<p>â‘ è¢«ä»£ç†çš„å­¦ç”Ÿç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StudentDao</span> <span class="keyword">implements</span> <span class="title">IStudentDao</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"æ­£åœ¨è¯»ä¹¦ä¸­ã€‚ã€‚ã€‚ã€‚ã€‚"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>â‘¡åˆ›å»ºä»£ç†ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProxyFactory</span> <span class="keyword">implements</span> <span class="title">MethodInterceptor</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//ç»´æŠ¤ä¸€ä¸ªç›®æ ‡å¯¹è±¡</span></span><br><span class="line">		<span class="keyword">private</span> Object target;</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//æ„é€ å™¨ï¼Œä¼ å…¥ä¸€ä¸ªè¢«ä»£ç†çš„å¯¹è±¡</span></span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="title">ProxyFactory</span><span class="params">(Object target)</span> </span>&#123;</span><br><span class="line">			<span class="keyword">this</span>.target = target;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">//è¿”å›ä¸€ä¸ªä»£ç†å¯¹è±¡:  æ˜¯ target å¯¹è±¡çš„ä»£ç†å¯¹è±¡</span></span><br><span class="line">		<span class="function"><span class="keyword">public</span> Object <span class="title">getProxyInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">			<span class="comment">//1. åˆ›å»ºä¸€ä¸ªå·¥å…·ç±»</span></span><br><span class="line">			Enhancer enhancer = <span class="keyword">new</span> Enhancer();</span><br><span class="line">			<span class="comment">//2. è®¾ç½®çˆ¶ç±»</span></span><br><span class="line">			enhancer.setSuperclass(target.getClass());</span><br><span class="line">			<span class="comment">//3. è®¾ç½®å›è°ƒå‡½æ•°</span></span><br><span class="line">			enhancer.setCallback(<span class="keyword">this</span>);</span><br><span class="line">			<span class="comment">//4. åˆ›å»ºå­ç±»å¯¹è±¡ï¼Œå³ä»£ç†å¯¹è±¡</span></span><br><span class="line">			<span class="keyword">return</span> enhancer.create();</span><br><span class="line">			</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line"></span><br><span class="line">		<span class="comment">//é‡å†™  intercept æ–¹æ³•ï¼Œä¼šè°ƒç”¨ç›®æ ‡å¯¹è±¡çš„æ–¹æ³•</span></span><br><span class="line">		<span class="meta">@Override</span></span><br><span class="line">		<span class="function"><span class="keyword">public</span> Object <span class="title">intercept</span><span class="params">(Object arg0, Method method, Object[] args, MethodProxy arg3)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">			<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">			System.out.println(<span class="string">"Cglibä»£ç†æ¨¡å¼ ~~ å¼€å§‹"</span>);</span><br><span class="line">			Object returnVal = method.invoke(target, args);</span><br><span class="line">			System.out.println(<span class="string">"Cglibä»£ç†æ¨¡å¼ ~~ æäº¤"</span>);</span><br><span class="line">			<span class="keyword">return</span> returnVal;</span><br><span class="line">		&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>â‘¢ç”¨æˆ·æµ‹è¯•ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		StudentDao studentDao = <span class="keyword">new</span> StudentDao();</span><br><span class="line">		ProxyFactory studentDaoProxy = <span class="keyword">new</span> ProxyFactory(studentDao);</span><br><span class="line">		StudentDao studentDao2 = (StudentDao)studentDaoProxy.getProxyInstance();</span><br><span class="line">		studentDao2.read();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç»“æœ</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Cglibä»£ç†æ¨¡å¼ ~~ å¼€å§‹</span><br><span class="line">æ­£åœ¨è¯»ä¹¦ä¸­ã€‚ã€‚ã€‚ã€‚ã€‚</span><br><span class="line">Cglibä»£ç†æ¨¡å¼ ~~ æäº¤</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>Java</category>
      </categories>
      <tags>
        <tag>è®¾è®¡æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title>Dockeråˆ¶ä½œè‡ªå·±çš„é•œåƒ--ubuntu16.04æ„å»ºPythonå’ŒPaddlepaddle</title>
    <url>/posts/e1b007ae.html</url>
    <content><![CDATA[<h3 id="1ã€æ‹‰å–ubuntu16-04çº¯å‡€é•œåƒ">1ã€æ‹‰å–ubuntu16.04çº¯å‡€é•œåƒ</h3>
<p>é¦–å…ˆè¿›å…¥è™šæ‹Ÿæœºç®¡ç†å‘˜ï¼Œå°†ubuntu16åŸºç¡€é•œåƒä»ä¸­å¿ƒä»“åº“æ‹‰ä¸‹æ¥ï¼Œè¾“å…¥å‘½ä»¤<code>docker pull ubuntu:16.04</code>,<br>
dockerå°±ä¼šè‡ªåŠ¨ä¸‹è½½ubuntu16çš„é•œåƒäº†<br>
<img src="https://img-blog.csdnimg.cn/20200410202138280.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>
ç”¨<code>docker images</code> æŸ¥çœ‹ä¸‹è½½å¥½çš„é•œåƒ<br>
<img src="https://img-blog.csdnimg.cn/20200410202204654.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>
å› ä¸ºéœ€è¦åˆ¶ä½œè‡ªå·±çš„å®¹å™¨ï¼Œå› æ­¤å…ˆä¸‹è½½å¥½python3.7çš„taråŒ…ï¼Œè¿™é‡Œæˆ‘ä»¬é€‰æ‹©ç¼–è¯‘å®‰è£…</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#åœ¨çº¿ä¸‹è½½python3.7ï¼Œå¦‚æœå«Œæ…¢å¯ä»¥å…ˆä¸‹è½½å¥½ç›´æ¥æ‹–è¿›æ¥</span></span><br><span class="line">wget https://www.python.org/ftp/python/3.7.0/Python-3.7.0.tgz</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/20200410202353342.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<a id="more"></a>
<h3 id="2ã€ubuntu16-04å®¹å™¨å†…å®‰è£…Python3-7å’ŒPaddlepaddle">2ã€ubuntu16.04å®¹å™¨å†…å®‰è£…Python3.7å’ŒPaddlepaddle</h3>
<p><code>docker run -it -v $PWD:/home/root123 ubuntu:16.04 /bin/bash</code>è¾“å…¥å‘½ä»¤è¿›å…¥å¹¶è¿è¡Œå®¹å™¨ï¼Œå¯ä»¥çœ‹è§æˆåŠŸè¿›å…¥ubuntuå®¹å™¨äº†<br>
<img src="https://img-blog.csdnimg.cn/20200410202325422.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>
åœ¨è¿™é‡Œæœ‰å¯èƒ½è‡ªå¸¦çš„aptæºè¿˜æ˜¯å›½å¤–çš„ï¼Œè€Œä¸”æ²¡æœ‰vi/vimå¯ç¼–è¾‘è½¯ä»¶ï¼Œæ‰€ä»¥è¿™é‡Œç”¨äº†echoç›´æ¥æ›´æ–°æº</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mv /etc/apt/sources.list /etc/apt/sources.list.bak</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"deb http://mirrors.aliyun.com/ubuntu/ xenial main restricted universe multiverse"</span> &gt;&gt; /etc/apt/sources.list</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"deb http://mirrors.aliyun.com/ubuntu/ xenial-updates main restricted universe multiverse"</span> &gt;&gt;/etc/apt/sources.list</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"deb http://mirrors.aliyun.com/ubuntu/ xenial-backports main restricted universe multiverse"</span> &gt;&gt;/etc/apt/sources.list</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"deb http://mirrors.aliyun.com/ubuntu/ xenial-security main restricted universe multiverse"</span> &gt;&gt;/etc/apt/sources.list</span><br></pre></td></tr></table></figure>
<p>ä¹‹åè¿›è¡Œå¿…è¦çš„ç»„ä»¶å‡çº§å®‰è£…</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">apt update</span><br><span class="line"></span><br><span class="line">apt install vim	<span class="comment">#å®‰è£…vim</span></span><br><span class="line"></span><br><span class="line">apt install gcc</span><br><span class="line"></span><br><span class="line"><span class="comment">###pythinå¿…é¡»çš„åŸºç¡€åŒ…</span></span><br><span class="line">apt-get install zlib1g-dev libbz2-dev libssl-dev libncurses5-dev libsqlite3-dev libreadline-dev tk-dev libgdbm-dev libdb-dev libpcap-dev xz-utils libexpat1-dev</span><br><span class="line"></span><br><span class="line">apt-get install liblzma-dev libffi-dev libc6-dev</span><br></pre></td></tr></table></figure>
<p>å®Œæˆåè¿›å…¥ä¸ä¸»æœºæŒ‚è½½çš„ç›®å½•ä¸‹ï¼Œå¯ä»¥çœ‹è§ä¸»æœºç›®å½•çš„æ–‡ä»¶æˆåŠŸæ˜ å°„åˆ°äº†è™šæ‹Ÿæœºå†…<br>
<img src="https://img-blog.csdnimg.cn/20200410202407936.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>
è§£å‹<code>tar -zxvf Python-3.7.0.tgz</code>ï¼Œå®Œæˆåè¿›å…¥Python-3.7.0ç›®å½•ï¼Œåé¢å°±éœ€è¦ä¾æ¬¡è¿›è¡Œç¼–è¯‘å®‰è£…äº†ï¼Œè¿™æ­¥å¯èƒ½æ—¶é—´ä¼šæœ‰ç‚¹é•¿</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#ä»¥ä¸‹å‘½ä»¤åˆ†å¼€æ‰§è¡Œ</span></span><br><span class="line">./configure --with-ssl --prefix=/usr/<span class="built_in">local</span>/python3 --<span class="built_in">enable</span>-optimizations</span><br><span class="line"></span><br><span class="line">make</span><br><span class="line"></span><br><span class="line">make install</span><br></pre></td></tr></table></figure>
<p>ä¹‹åè¿›è¡Œé“¾æ¥ï¼Œä¾æ¬¡è¾“å…¥ä¸€ä¸‹å‘½ä»¤</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ln -s /usr/<span class="built_in">local</span>/python3/bin/python3.7 /usr/bin/python3</span><br><span class="line">ln -s /usr/<span class="built_in">local</span>/python3/bin/pip3.7 /usr/bin/pip3</span><br></pre></td></tr></table></figure>
<p>åˆ°æ­¤ä¸ºæ­¢Pythonå°±å®‰è£…å®Œäº†ï¼ŒéªŒè¯ä¸€ä¸‹å‘ç°å¾ˆæˆåŠŸ<br>
<img src="https://img-blog.csdnimg.cn/20200410202416990.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xlbW9uX1RU,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>
æ¥ä¸‹æ¥å°±è¿›è¡ŒPaddlepaddleçš„å®‰è£…ï¼Œè¿™é‡Œå› ä¸ºå®‰è£…äº†pipï¼Œå› æ­¤ä½¿ç”¨pipå®‰è£…ï¼Œè¾“å…¥ä»¥ä¸‹å‘½ä»¤</p>
<p>å½“ç„¶ä¹Ÿå¯ä»¥ç”¨å…¶ä»–æ–¹å¼å®‰è£…ï¼Œ<a href="https://www.paddlepaddle.org.cn/install/quick" target="_blank" rel="noopener">å…¶ä»–å®‰è£…æ–¹å¼</a></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">python3 -m pip install paddlepaddle -i https://mirror.baidu.com/pypi/simple</span><br></pre></td></tr></table></figure>
<p>å®‰è£…å®Œæˆåï¼ŒéªŒè¯ä¸€ä¸‹æ˜¯å¦æˆåŠŸå®‰è£…ã€‚</p>
<p>å…ˆè¿›å…¥<code>python3</code>ï¼Œç„¶åè¾“å…¥<code>import paddle.fluid</code>ï¼Œåœ¨è¾“å…¥<code>paddle.fluid.install_check.run_check()</code>ï¼Œå¦‚æœå‡ºç° <code>Your Paddle Fluid is installed successfully!</code>ï¼Œè¯´æ˜å·²æˆåŠŸå®‰è£…ã€‚<br>
<img src="https://img-blog.csdnimg.cn/20200410202427737.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xlbW9uX1RU,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h3 id="3ã€åˆ¶ä½œè‡ªå·±çš„é•œåƒ">3ã€åˆ¶ä½œè‡ªå·±çš„é•œåƒ</h3>
<p>é€€å‡ºå®¹å™¨åï¼Œæˆ‘ä»¬éœ€è¦æ„å»ºè‡ªå·±çš„é•œåƒ,å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬æˆåŠŸçš„æ„å»ºäº†å±äºæˆ‘ä»¬è‡ªå·±çš„å®¹å™¨</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#æŸ¥çœ‹æ‰€æœ‰å®¹å™¨</span></span><br><span class="line">docker ps -a</span><br><span class="line"><span class="comment">#-måæ˜¯è¯´æ˜æ–‡å­— -aæ˜¯ä½œè€… å®¹å™¨id åé¢æ˜¯é•œåƒåå­—</span></span><br><span class="line">docker commit -m <span class="string">"add vim&amp;source"</span> -a <span class="string">"author"</span> 1db56d541f2c python:1.0</span><br><span class="line"><span class="comment">#å®Œæˆåè¾“å…¥ä¸€ä¸‹å³å¯çœ‹è§æ–°çš„é•œåƒ</span></span><br><span class="line">docker images</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/20200410202434190.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xlbW9uX1RU,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>
æœ€åå¯å°†å®¹å™¨ä¿å­˜ä¸ºæ–‡ä»¶ï¼Œå­˜æ”¾äºå½“å‰ç›®å½•ä¸‹</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">docker save -o python.tar python3.7:1.0</span><br></pre></td></tr></table></figure>
<p>è€Œä»å¤–éƒ¨è£…è½½æ—¶åˆ™éœ€è¦è¾“å…¥</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">docker load -input python.tar</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>äº‘è®¡ç®—</category>
      </categories>
      <tags>
        <tag>docker</tag>
      </tags>
  </entry>
  <entry>
    <title>Synologyå®‰è£…å¹¶å®ç°åœ¨linuxå’Œwinä¸‹ä½¿ç”¨ISCSIå­˜å‚¨</title>
    <url>/posts/63c06a7a.html</url>
    <content><![CDATA[<h3 id="1ã€è™šæ‹Ÿæœºå®‰è£…Synologyéœ€è¦å‡†å¤‡çš„å·¥å…·">1ã€è™šæ‹Ÿæœºå®‰è£…Synologyéœ€è¦å‡†å¤‡çš„å·¥å…·</h3>
<ul>
<li>
<p>Synology Assistant</p>
</li>
<li>
<p>DSM_DS3615xs_5967.pat</p>
</li>
<li>
<p>XPEnoboot_DS3615xs_5.2-5967.1.iso</p>
</li>
</ul>
<blockquote>
<p>é“¾æ¥ï¼š<a href="https://pan.baidu.com/s/1vU0WDlJV_pxTTt0d02KLKg" target="_blank" rel="noopener">https://pan.baidu.com/s/1vU0WDlJV_pxTTt0d02KLKg</a>  æå–ç ï¼š0sy9<br>
æˆ–è€…https://download.csdn.net/download/lemon_TT/14945706</p>
</blockquote>
<p>æ³¨æ„DSMå’ŒXPEnobootçš„ç‰ˆæœ¬è¦ä¸€è‡´ï¼Œå¦‚ä¸Šéƒ½æ˜¯DS3615xs_5967</p>
<p>XPEnoboot_DS3615xs_5.1-5967.1.isoç”¨äºå¼•å¯¼é•œåƒ</p>
<p>DSMæ˜¯ç³»ç»Ÿæ–‡ä»¶</p>
<p>Synology Assistantæ˜¯å®¢æˆ·ç«¯ç®¡ç†å·¥å…·</p>
<a id="more"></a>
<h3 id="2ã€-Synologyçš„å®‰è£…">2ã€ Synologyçš„å®‰è£…</h3>
<h5 id="æ‰“å¼€è™šæ‹Ÿæœºæ–°å»ºï¼Œé€‰æ‹©è‡ªå®šä¹‰">æ‰“å¼€è™šæ‹Ÿæœºæ–°å»ºï¼Œé€‰æ‹©è‡ªå®šä¹‰</h5>
<p><img src="https://s1.ax1x.com/2020/04/08/GW1XUe.png" alt="GW1XUe.png"></p>
<h5 id="å› ä¸ºè€ƒè™‘å…¼å®¹é—®é¢˜ï¼Œè¿™é‡Œé€‰æ‹©12çš„ç‰ˆæœ¬">å› ä¸ºè€ƒè™‘å…¼å®¹é—®é¢˜ï¼Œè¿™é‡Œé€‰æ‹©12çš„ç‰ˆæœ¬</h5>
<p><a href="https://imgchr.com/i/GW1Tjx" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2020/04/08/GW1Tjx.png" alt="GW1Tjx.png"></a><br>
<a href="https://imgchr.com/i/GW1og1" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2020/04/08/GW1og1.png" alt="GW1og1.png"></a><br>
<a href="https://imgchr.com/i/GW1I3R" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2020/04/08/GW1I3R.png" alt="GW1I3R.png"></a><br>
<a href="https://imgchr.com/i/GW15C9" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2020/04/08/GW15C9.png" alt="GW15C9.png"></a></p>
<h5 id="ç½‘ç»œé€‰æ‹©æ¡¥æ¥æ¨¡å¼ï¼Œä¸ºäº†è®©å±€åŸŸç½‘å†…å…¶ä»–ä¸»æœºèƒ½å¤Ÿé¡ºåˆ©è¿›è¡Œè®¿é—®">ç½‘ç»œé€‰æ‹©æ¡¥æ¥æ¨¡å¼ï¼Œä¸ºäº†è®©å±€åŸŸç½‘å†…å…¶ä»–ä¸»æœºèƒ½å¤Ÿé¡ºåˆ©è¿›è¡Œè®¿é—®</h5>
<p><a href="https://imgchr.com/i/GW1fN4" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2020/04/08/GW1fN4.png" alt="GW1fN4.png"></a><br>
<a href="https://imgchr.com/i/GW1Hu6" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2020/04/08/GW1Hu6.md.png" alt="GW1Hu6.md.png"></a><br>
<a href="https://imgchr.com/i/GW1qHO" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2020/04/08/GW1qHO.md.png" alt="GW1qHO.md.png"></a></p>
<h5 id="å› ä¸ºæœ¬æ¬¡éœ€è¦æ­å»ºä¸€ä¸ªraid6ï¼Œå› æ­¤è‡³å°‘éœ€è¦4ä¸ªç¡¬ç›˜ã€‚åœ¨è¿™é‡Œæˆ‘ä»¬å…ˆåˆ›å»ºå¥½">å› ä¸ºæœ¬æ¬¡éœ€è¦æ­å»ºä¸€ä¸ªraid6ï¼Œå› æ­¤è‡³å°‘éœ€è¦4ä¸ªç¡¬ç›˜ã€‚åœ¨è¿™é‡Œæˆ‘ä»¬å…ˆåˆ›å»ºå¥½</h5>
<p><img src="https://s1.ax1x.com/2020/04/08/GW1OED.png" alt="GW1OED.png"></p>
<h5 id="å¦‚ä½•éœ€è¦ä¿®æ”¹ç”µæºå›ºä»¶é€‰é¡¹ï¼Œéœ€è¦æŠŠCD-ROMè®¾ç½®ä¸ºä¼˜å…ˆå¯åŠ¨ï¼Œä¿å­˜åé€‰æ‹©install">å¦‚ä½•éœ€è¦ä¿®æ”¹ç”µæºå›ºä»¶é€‰é¡¹ï¼Œéœ€è¦æŠŠCD-ROMè®¾ç½®ä¸ºä¼˜å…ˆå¯åŠ¨ï¼Œä¿å­˜åé€‰æ‹©install</h5>
<p><img src="https://s1.ax1x.com/2020/04/08/GW8smV.png" alt="GW8smV.png"><br>
<img src="https://s1.ax1x.com/2020/04/08/GW8DO0.png" alt="GW8DO0.png"></p>
<p><img src="https://s1.ax1x.com/2020/04/08/GW86TU.png" alt="GW86TU.png"></p>
<hr>
<h4 id="åˆ°ç›®å‰ä¸ºæ­¢ï¼Œå°±å¯ä»¥è¿›è¡ŒNASçš„å®‰è£…äº†ï¼Œæ‰“å¼€ç¾¤æ™–åŠ©æ‰‹è¿›è¡Œæ‰«æï¼Œå¦‚æœæ²¡æœ‰æŠ¥é”™ï¼Œä¹Ÿå¯ä»¥è¿›è¡Œå®‰è£…ï¼Œä½†æ˜¯å¦‚æœæŠ¥é”™äº†æ²¡æ‰¾åˆ°ï¼Œæ²¡å…³ç³»ï¼Œæˆ‘ä»¬è¿˜æœ‰å¦ä¸€ç§ç½‘é¡µè¿›è¡Œå®‰è£…ï¼Œä¸‹é¢è®©æˆ‘æ¥è¯¦ç»†ä»‹ç»ä¸€ä¸‹ã€‚">åˆ°ç›®å‰ä¸ºæ­¢ï¼Œå°±å¯ä»¥è¿›è¡ŒNASçš„å®‰è£…äº†ï¼Œæ‰“å¼€ç¾¤æ™–åŠ©æ‰‹è¿›è¡Œæ‰«æï¼Œå¦‚æœæ²¡æœ‰æŠ¥é”™ï¼Œä¹Ÿå¯ä»¥è¿›è¡Œå®‰è£…ï¼Œä½†æ˜¯å¦‚æœæŠ¥é”™äº†æ²¡æ‰¾åˆ°ï¼Œæ²¡å…³ç³»ï¼Œæˆ‘ä»¬è¿˜æœ‰å¦ä¸€ç§ç½‘é¡µè¿›è¡Œå®‰è£…ï¼Œä¸‹é¢è®©æˆ‘æ¥è¯¦ç»†ä»‹ç»ä¸€ä¸‹ã€‚</h4>
<h5 id="é¦–å…ˆæ‰“å¼€æµè§ˆå™¨è¾“å…¥ä»¥ä¸‹ç½‘å€http-find-synology-com-æµè§ˆå™¨å°±ä¼šè‡ªåŠ¨æœç´¢äº†">é¦–å…ˆæ‰“å¼€æµè§ˆå™¨è¾“å…¥ä»¥ä¸‹ç½‘å€<code>http://find.synology.com/</code>æµè§ˆå™¨å°±ä¼šè‡ªåŠ¨æœç´¢äº†</h5>
<h5 id="é€‰æ‹©è”æœº">é€‰æ‹©è”æœº</h5>
<p><img src="https://s1.ax1x.com/2020/04/08/GWtl4S.png" alt="GWtl4S.png"></p>
<h5 id="åœ¨æ­¤ä¹‹åé€‰æ‹©æ‰‹åŠ¨å®‰è£…ï¼Œå¦‚ä½•å°†patæ–‡ä»¶åŠ è¿›æ¥åé€‰æ‹©ç«‹å³å®‰è£…">åœ¨æ­¤ä¹‹åé€‰æ‹©æ‰‹åŠ¨å®‰è£…ï¼Œå¦‚ä½•å°†patæ–‡ä»¶åŠ è¿›æ¥åé€‰æ‹©ç«‹å³å®‰è£…</h5>
<p><img src="https://s1.ax1x.com/2020/04/08/GWtmnI.png" alt="GWtmnI.png"></p>
<h5 id="é€‰æ‹©ç¡®å®šåéœ€è¦ç­‰å¾…æ€¥å‡ åˆ†é’Ÿ">é€‰æ‹©ç¡®å®šåéœ€è¦ç­‰å¾…æ€¥å‡ åˆ†é’Ÿ</h5>
<p><img src="https://s1.ax1x.com/2020/04/08/GWtE1H.png" alt="GWtE1H.png"></p>
<h5 id="å®Œæˆååˆ›å»ºç”¨æˆ·åå’Œå¯†ç ">å®Œæˆååˆ›å»ºç”¨æˆ·åå’Œå¯†ç </h5>
<p><img src="https://s1.ax1x.com/2020/04/08/GWNpvj.png" alt="GWNpvj.png"></p>
<h5 id="ä¸­é—´çš„æ›´æ–°é€‰é¡¹å¯ä»¥è‡ªç”±é€‰æ‹©ï¼Œè€Œè´¦æˆ·åˆ›å»ºé€‰æ‹©è·³è¿‡ï¼Œä¹‹åæˆåŠŸè¿›å…¥NASç•Œé¢äº†">ä¸­é—´çš„æ›´æ–°é€‰é¡¹å¯ä»¥è‡ªç”±é€‰æ‹©ï¼Œè€Œè´¦æˆ·åˆ›å»ºé€‰æ‹©è·³è¿‡ï¼Œä¹‹åæˆåŠŸè¿›å…¥NASç•Œé¢äº†</h5>
<p><img src="https://s1.ax1x.com/2020/04/08/GWNE5T.png" alt="GWNE5T.png"></p>
<h3 id="3ã€iSCSIå­˜å‚¨çš„æ„å»º">3ã€iSCSIå­˜å‚¨çš„æ„å»º</h3>
<h5 id="æ‰“å¼€å­˜å‚¨ç©ºé—´ç®¡ç†å‘˜é€‰é¡¹ï¼Œå¯ä»¥çœ‹è§æœ‰4ä¸ªç©ºç¡¬ç›˜">æ‰“å¼€å­˜å‚¨ç©ºé—´ç®¡ç†å‘˜é€‰é¡¹ï¼Œå¯ä»¥çœ‹è§æœ‰4ä¸ªç©ºç¡¬ç›˜</h5>
<p><img src="https://s1.ax1x.com/2020/04/08/GWUX9S.png" alt="GWUX9S.png"></p>
<h5 id="é€‰æ‹©iSCSI-LUNï¼Œé€‰æ‹©æ–°å¢">é€‰æ‹©iSCSI LUNï¼Œé€‰æ‹©æ–°å¢</h5>
<p><img src="https://s1.ax1x.com/2020/04/08/GWUvcQ.png" alt="GWUvcQ.png"></p>
<h5 id="ç›´æ¥é»˜è®¤é€‰é¡¹ä¸‹ä¸€æ­¥ï¼Œraidç±»å‹é€‰æ‹©RAID6">ç›´æ¥é»˜è®¤é€‰é¡¹ä¸‹ä¸€æ­¥ï¼Œraidç±»å‹é€‰æ‹©RAID6</h5>
<p><img src="https://s1.ax1x.com/2020/04/08/GWagDs.png" alt="GWagDs.png"></p>
<h5 id="å¦‚æœè®¾è®¡éšç§ï¼Œå¯ä»¥å¯ç”¨CHAPè¿›è¡Œå¯†ç ä¿æŠ¤">å¦‚æœè®¾è®¡éšç§ï¼Œå¯ä»¥å¯ç”¨CHAPè¿›è¡Œå¯†ç ä¿æŠ¤</h5>
<p><img src="https://s1.ax1x.com/2020/04/08/GWayvQ.png" alt="GWayvQ.png"><br>
<img src="https://s1.ax1x.com/2020/04/08/GWar8S.png" alt="GWar8S.png"><br>
<img src="https://s1.ax1x.com/2020/04/08/GWaDC8.png" alt="GWaDC8.png"></p>
<p><img src="https://s1.ax1x.com/2020/04/08/GWagDs.png" alt="GWagDs.png"><br>
<img src="https://s1.ax1x.com/2020/04/08/GWayvQ.png" alt="GWayvQ.png"><br>
<img src="https://s1.ax1x.com/2020/04/08/GWar8S.png" alt="GWar8S.png"></p>
<h5 id="æˆåŠŸåæ˜¾ç¤ºå¦‚ä¸‹ä¿¡æ¯å°±å¤§åŠŸå‘Šè¾äº†ï¼Œè¿™é‡Œå› ä¸ºæœ‰å¥‡å¶æ ¡éªŒç›˜ï¼Œæ‰€ä»¥ä¼šæœ‰å®¹é‡æŸå¤±ã€‚">æˆåŠŸåæ˜¾ç¤ºå¦‚ä¸‹ä¿¡æ¯å°±å¤§åŠŸå‘Šè¾äº†ï¼Œè¿™é‡Œå› ä¸ºæœ‰å¥‡å¶æ ¡éªŒç›˜ï¼Œæ‰€ä»¥ä¼šæœ‰å®¹é‡æŸå¤±ã€‚</h5>
<p><img src="https://s1.ax1x.com/2020/04/08/GWaDC8.png" alt="GWaDC8.png"></p>
<h3 id="4ã€åœ¨windowsä¸Šä½¿ç”¨iSCSIå­˜å‚¨">4ã€åœ¨windowsä¸Šä½¿ç”¨iSCSIå­˜å‚¨</h3>
<h5 id="åœ¨windowsæ§åˆ¶é¢æ¿ä¸­çš„ç®¡ç†å·¥å…·ï¼Œæ‰“å¼€iSCSIå‘èµ·ç¨‹åº">åœ¨windowsæ§åˆ¶é¢æ¿ä¸­çš„ç®¡ç†å·¥å…·ï¼Œæ‰“å¼€iSCSIå‘èµ·ç¨‹åº</h5>
<p><img src="https://s1.ax1x.com/2020/04/08/GW2qqf.png" alt="GW2qqf.png"></p>
<h5 id="åœ¨å‘ç°é‡Œè¾“å…¥NASçš„ipåœ°å€ï¼Œç¨‹åºå°±ä¼šè‡ªåŠ¨æœå¯»">åœ¨å‘ç°é‡Œè¾“å…¥NASçš„ipåœ°å€ï¼Œç¨‹åºå°±ä¼šè‡ªåŠ¨æœå¯»</h5>
<p><img src="https://s1.ax1x.com/2020/04/08/GW2bsP.png" alt="GW2bsP.png"></p>
<h5 id="å¯ä»¥çœ‹åˆ°ç¨‹åºå·²ç»æˆåŠŸå‘ç°ç›®æ ‡ï¼Œé€‰æ‹©è¿æ¥å³å¯è¿æ¥åˆ°iSCSI-LUN">å¯ä»¥çœ‹åˆ°ç¨‹åºå·²ç»æˆåŠŸå‘ç°ç›®æ ‡ï¼Œé€‰æ‹©è¿æ¥å³å¯è¿æ¥åˆ°iSCSI LUN</h5>
<p><img src="https://s1.ax1x.com/2020/04/08/GW2HMt.png" alt="GW2HMt.png"></p>
<h5 id="æ‰“å¼€ç£ç›˜ç®¡ç†ï¼Œè¿™é‡Œä¸ºäº†å…¼å®¹æˆ‘ä»¬é€‰æ‹©MBR">æ‰“å¼€ç£ç›˜ç®¡ç†ï¼Œè¿™é‡Œä¸ºäº†å…¼å®¹æˆ‘ä»¬é€‰æ‹©MBR</h5>
<p><img src="https://s1.ax1x.com/2020/04/08/GWWZ0f.png" alt="GWWZ0f.png"></p>
<h5 id="ç„¶åå¯ä»¥å‘ç°å¤šäº†ä¸€ä¸ªç©ºç£ç›˜ï¼Œé€‰æ‹©æ–°å»ºå·ï¼Œæ ¼å¼åŒ–åå°±å½¢æˆäº†ä¸€ä¸ªæ–°çš„ç£ç›˜ï¼Œæ‰“å¼€æˆ‘çš„ç”µè„‘å³å¯è®¿é—®æ–°çš„ç£ç›˜ï¼Œå’Œå†…ç½®ç£ç›˜ä¸€æ¨¡ä¸€æ ·ã€‚">ç„¶åå¯ä»¥å‘ç°å¤šäº†ä¸€ä¸ªç©ºç£ç›˜ï¼Œé€‰æ‹©æ–°å»ºå·ï¼Œæ ¼å¼åŒ–åå°±å½¢æˆäº†ä¸€ä¸ªæ–°çš„ç£ç›˜ï¼Œæ‰“å¼€æˆ‘çš„ç”µè„‘å³å¯è®¿é—®æ–°çš„ç£ç›˜ï¼Œå’Œå†…ç½®ç£ç›˜ä¸€æ¨¡ä¸€æ ·ã€‚</h5>
<p><img src="https://s1.ax1x.com/2020/04/08/GWWVnP.png" alt="GWWVnP.png"><br>
<img src="https://s1.ax1x.com/2020/04/08/GWWAXt.png" alt="GWWAXt.png"></p>
<h3 id="5ã€åœ¨ESXiä¸‹ä½¿ç”¨iSCSI-å­˜å‚¨">5ã€åœ¨ESXiä¸‹ä½¿ç”¨iSCSI å­˜å‚¨</h3>
<p>é¦–å…ˆéœ€è¦æ–­å¼€windowsçš„è¿æ¥ï¼Œè¿™é‡Œé»˜è®¤å·²ç»å¯åŠ¨å¥½äº†ESXiè™šæ‹Ÿæœºï¼Œæ‰“å¼€exsiæµè§ˆå™¨æ§åˆ¶é¢æ¿ã€‚</p>
<p><img src="https://s1.ax1x.com/2020/04/08/GW5dVx.png" alt="GW5dVx.png"></p>
<h5 id="é€‰æ‹©é…ç½®iSCSIï¼Œåœ¨åŠ¨æ€ç›®æ ‡é‡Œå¡«ä¸ŠNASçš„ipåœ°å€ï¼Œä¿å­˜åé€€å‡ºå†è¿›æ¥å¯ä»¥å‘ç°é™æ€ç›®æ ‡å·²ç»è‡ªåŠ¨ç”Ÿæˆã€‚">é€‰æ‹©é…ç½®iSCSIï¼Œåœ¨åŠ¨æ€ç›®æ ‡é‡Œå¡«ä¸ŠNASçš„ipåœ°å€ï¼Œä¿å­˜åé€€å‡ºå†è¿›æ¥å¯ä»¥å‘ç°é™æ€ç›®æ ‡å·²ç»è‡ªåŠ¨ç”Ÿæˆã€‚</h5>
<p><img src="https://s1.ax1x.com/2020/04/08/GW4kc9.png" alt="GW4kc9.png"><br>
<img src="https://s1.ax1x.com/2020/04/08/GW49tU.png" alt="GW49tU.png"></p>
<h5 id="åœ¨è®¾å¤‡é‡Œå¯ä»¥æˆåŠŸæ‰¾åˆ°æˆ‘ä»¬å®‰è£…å¥½çš„ä¸ºå®šä¹‰çš„ç©ºç£ç›˜">åœ¨è®¾å¤‡é‡Œå¯ä»¥æˆåŠŸæ‰¾åˆ°æˆ‘ä»¬å®‰è£…å¥½çš„ä¸ºå®šä¹‰çš„ç©ºç£ç›˜</h5>
<p><img src="https://s1.ax1x.com/2020/04/08/GWIAdx.png" alt="GWIAdx.png"></p>
<h5 id="å¦‚ä½•å³é”®åˆ é™¤åˆ†åŒºè¡¨åå†é‡æ–°è¿›å…¥é€‰æ‹©æ–°å»ºæ•°æ®å­˜å‚¨">å¦‚ä½•å³é”®åˆ é™¤åˆ†åŒºè¡¨åå†é‡æ–°è¿›å…¥é€‰æ‹©æ–°å»ºæ•°æ®å­˜å‚¨</h5>
<p><img src="https://s1.ax1x.com/2020/04/08/GWo2UP.png" alt="GWo2UP.png"></p>
<h5 id="é»˜è®¤ä¸‹ä¸€æ­¥">é»˜è®¤ä¸‹ä¸€æ­¥</h5>
<p><img src="https://s1.ax1x.com/2020/04/08/GWo5vQ.png" alt="GWo5vQ.png"><br>
<img src="https://s1.ax1x.com/2020/04/08/GWoh8S.png" alt="GWoh8S.png"></p>
<h5 id="æœ€ç»ˆå¯ä»¥çœ‹è§æˆåŠŸåˆ›å»ºå¥½äº†åˆ†åŒºï¼Œä¹‹åå°±å¯ä»¥ç›´æ¥åœ¨è¯¥æ–‡ä»¶å­˜å‚¨ä¸Šå­˜å‚¨æ•°æ®äº†">æœ€ç»ˆå¯ä»¥çœ‹è§æˆåŠŸåˆ›å»ºå¥½äº†åˆ†åŒºï¼Œä¹‹åå°±å¯ä»¥ç›´æ¥åœ¨è¯¥æ–‡ä»¶å­˜å‚¨ä¸Šå­˜å‚¨æ•°æ®äº†</h5>
<p><img src="https://s1.ax1x.com/2020/04/08/GWT3Pf.png" alt="GWT3Pf.png"></p>
]]></content>
      <categories>
        <category>äº‘è®¡ç®—</category>
      </categories>
      <tags>
        <tag>äº‘è®¡ç®—</tag>
      </tags>
  </entry>
  <entry>
    <title>NASã€SANã€ISCSIå­˜å‚¨ç®€å•ç†è§£</title>
    <url>/posts/2.927e+166.html</url>
    <content><![CDATA[<h3 id="NAS">NAS</h3>
<p>â€ƒNASæ˜¯Network-Attached Storageçš„ç®€ç§°ã€‚ä¸­æ–‡ä¸€èˆ¬ç§°ä¸ºâ€œç½‘ç»œé™„åŠ å­˜å‚¨â€ï¼Œæˆ–è€…â€œç½‘ç»œè¿æ¥å­˜å‚¨â€ã€‚æˆ‘ä»¬å¯ä»¥æŠŠNASç†è§£ä¸ºé€šè¿‡ç½‘ç»œæä¾›å­˜å‚¨çš„è®¾å¤‡ï¼ˆè¯·ç‰¹åˆ«æ³¨æ„ï¼Œä¸éœ€è¦å…‰çº¤äº¤æ¢æœºï¼Œæ™®é€šçš„å±€åŸŸç½‘äº¤æ¢æœºå³å¯ï¼‰ã€‚</p>
<p>NASæ˜¯ä¸€ç§åŸºäºIPçš„é«˜æ€§èƒ½æ–‡ä»¶å…±äº«å’Œå­˜å‚¨ä¸“ç”¨è®¾å¤‡ã€‚</p>
<ul>
<li>å¯ä½¿NASå®¢æˆ·ç«¯é€šè¿‡IPç½‘ç»œå…±äº«æ–‡ä»¶</li>
<li>é‡‡ç”¨é’ˆå¯¹æ–‡ä»¶I/Oè€Œä¼˜åŒ–çš„ä¸“ç”¨æ“ä½œç³»ç»Ÿ</li>
<li>ä½¿UNIXå’ŒWindowsç”¨æˆ·éƒ½èƒ½å…±äº«æ•°æ®</li>
</ul>
<p>â€ƒé€šä¿—æ¥è®²ï¼šNASå¯ä»¥æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„å­˜å‚¨ç³»ç»Ÿï¼Œä»ä¸æ™®é€šçš„åº”ç”¨æœåŠ¡å™¨å¯¹æ¯”ä¹Ÿå¯ä»¥çœ‹å‡ºï¼ŒNASæ˜¯ç›´æ¥ç‹¬ç«‹çš„å­˜å‚¨ï¼Œæˆ‘ä»¬å°±ç§°ä¸º<strong>NASå­˜å‚¨ç³»ç»Ÿ</strong>ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨NASæ­å»ºå®¶åº­å…±äº«å­˜å‚¨è®¾å¤‡ï¼Œå¯ä»¥å®ç°è§†é¢‘ã€ç…§ç‰‡ç­‰åœ¨å¤šç»ˆç«¯çš„åŒæ—¶å…±äº«ã€‚</p>
<p><img src="https://s1.ax1x.com/2020/04/08/GWAFfS.png" alt="GWAFfS.png"></p>
<a id="more"></a>
<h3 id="SAN">SAN</h3>
<p>â€ƒSANå…¨ç§°Storage Area Network and SAN Protocolsï¼Œä¸­æ–‡åå­˜å‚¨åŒºåŸŸç½‘ç»œï¼ŒSANæ˜¯ä¸€ç§é«˜é€Ÿç½‘ç»œï¼Œæä¾›åœ¨è®¡ç®—æœºä¸å­˜å‚¨ç³»ç»Ÿä¹‹é—´çš„æ•°æ®ä¼ è¾“ã€‚å­˜å‚¨è®¾å¤‡æ˜¯æŒ‡ä¸€å°æˆ–å¤šå°ç”¨ä»¥å­˜å‚¨è®¡ç®—æœºæ•°æ®çš„ç£ç›˜è®¾å¤‡ï¼Œé€šå¸¸æŒ‡ç£ç›˜é˜µåˆ—ã€‚å…¶é‡‡ç”¨ç½‘çŠ¶é€šé“ï¼ˆFibre Channelï¼Œç®€ç§°FCï¼‰æŠ€æœ¯ï¼Œé€šè¿‡FCäº¤æ¢æœºè¿æ¥å­˜å‚¨é˜µåˆ—å’ŒæœåŠ¡å™¨ä¸»æœºï¼Œå»ºç«‹ä¸“ç”¨äºæ•°æ®å­˜å‚¨çš„åŒºåŸŸç½‘ç»œã€‚SANå­˜å‚¨ç”±äºå…¶åŸºç¡€æ˜¯ä¸€ä¸ªä¸“ç”¨ç½‘ç»œï¼Œå› æ­¤æ‰©å±•æ€§å¾ˆå¼ºï¼Œä¸ç®¡æ˜¯åœ¨ä¸€ä¸ªSANç³»ç»Ÿä¸­å¢åŠ ä¸€å®šçš„å­˜å‚¨ç©ºé—´è¿˜æ˜¯å¢åŠ å‡ å°ä½¿ç”¨å­˜å‚¨ç©ºé—´çš„æœåŠ¡å™¨éƒ½éå¸¸æ–¹ä¾¿ã€‚</p>
<p>ä½†æ³¨æ„çš„æ˜¯ï¼ŒSANå’ŒNASå¹¶ä¸æ˜¯ç›¸äº’å†²çªçš„ï¼Œæ˜¯å¯ä»¥å…±å­˜äºä¸€ä¸ªç³»ç»Ÿç½‘ç»œä¸­çš„ï¼Œä½†NASé€šè¿‡ä¸€ä¸ªå…¬å…±çš„æ¥å£å®ç°ç©ºé—´çš„ç®¡ç†å’Œèµ„æºå…±äº«ï¼ŒSANä»…ä»…æ˜¯ä¸ºæœåŠ¡å™¨å­˜å‚¨æ•°æ®æä¾›ä¸€ä¸ªä¸“é—¨çš„å¿«é€Ÿåæ–¹é€šé“</p>
<p><img src="https://s1.ax1x.com/2020/04/08/GWE1Et.png" alt="GWE1Et.png"></p>
<h3 id="iSCSIå­˜å‚¨">iSCSIå­˜å‚¨</h3>
<p>â€ƒä½¿ç”¨ä¸“é—¨çš„å­˜å‚¨åŒºåŸŸç½‘æˆæœ¬å¾ˆé«˜ï¼Œè€Œåˆ©ç”¨æ™®é€šçš„æ•°æ®ç½‘æ¥ä¼ è¾“ISCSIæ•°æ®å®ç°å’ŒSANç›¸ä¼¼çš„åŠŸèƒ½å¯ä»¥å¤§å¤§çš„é™ä½æˆæœ¬ï¼ŒåŒæ—¶æé«˜ç³»ç»Ÿçš„çµæ´»æ€§ã€‚SCSIå°±æ˜¯è¿™æ ·ä¸€ç§æŠ€æœ¯ï¼Œå®ƒåˆ©ç”¨æ™®é€šçš„TCP/IPç½‘æ¥ä¼ è¾“æœ¬æ¥ç”¨å­˜å‚¨åŒºåŸŸç½‘æ¥ä¼ è¾“çš„SCSIæ•°æ®å—ã€‚</p>
<p>â€ƒISCSIç½‘ç»œå­˜å‚¨çš„å…´èµ·åŸå› ï¼šä½¿ç”¨ä¸“é—¨çš„å…‰çº¤ä»‹è´¨ç»„å»ºçš„SANæ¨¡å¼çš„å­˜å‚¨åŒºåŸŸç½‘æˆæœ¬å¾ˆé«˜ï¼Œè€Œåˆ©ç”¨æ™®é€šçš„æ•°æ®ç½‘æ¥ä¼ è¾“ISCSIæ•°æ®å®ç°å’ŒSANç›¸ä¼¼çš„åŠŸèƒ½å¯ä»¥å¤§å¤§çš„é™ä½æˆæœ¬ï¼ŒåŒæ—¶æé«˜ç³»ç»Ÿçš„çµæ´»æ€§ã€‚</p>
<p><img src="https://s1.ax1x.com/2020/04/08/GWZtmj.png" alt="GWZtmj.png"></p>
<h3 id="DAS"><strong>DAS</strong></h3>
<p>â€ƒä¸€ç§ç›´æ¥ä¸ä¸»æœºç³»ç»Ÿç›¸è¿æ¥çš„å­˜å‚¨è®¾å¤‡ï¼Œå¦‚ä½œä¸ºæœåŠ¡å™¨çš„è®¡ç®—æœºå†…éƒ¨ç¡¬ä»¶é©±åŠ¨ã€‚</p>
<h6 id=""></h6>
]]></content>
      <categories>
        <category>äº‘è®¡ç®—</category>
      </categories>
      <tags>
        <tag>äº‘è®¡ç®—</tag>
      </tags>
  </entry>
  <entry>
    <title>springboot2æ•´åˆWebSocketå…¥é—¨å®æˆ˜</title>
    <url>/posts/f56bb91e.html</url>
    <content><![CDATA[<h3 id="ä¸€ã€é—®é¢˜æè¿°">ä¸€ã€é—®é¢˜æè¿°</h3>
<p>æœ€è¿‘åˆšå¥½æœ‰ä¸€ä¸ªéœ€è¦ï¼Œå°±æ˜¯éœ€è¦æœåŠ¡ç«¯æ¨é€æ¶ˆæ¯åˆ°å®¢æˆ·ç«¯ï¼Œè§£å†³æ–¹æ¡ˆç¬¬ä¸€ä¸ªæƒ³åˆ°çš„ä¾¿æ˜¯å‰ç«¯è½®è¯¢æœåŠ¡å™¨ï¼ŒæŸ¥è¯¢æœåŠ¡å™¨æ˜¯å¦æœ‰è¯·æ±‚ã€‚å¯¹äºè¿™ç§æ–¹æ³•ï¼Œä¼˜ç‚¹æ˜¯ç®€å•ï¼Œä½†ç¼ºç‚¹ä¹Ÿååˆ†æ˜æ˜¾ï¼Œé‚£å°±æ˜¯ååˆ†è€—è´¹æœåŠ¡å™¨èµ„æºã€‚å› æ­¤åœ¨è¿™é‡Œä»‹ç»äº†ç¬¬äºŒç§æ–¹æ³•ï¼Œä½¿ç”¨webSocketã€‚</p>
<h3 id="äºŒã€websocketä¸http-åŒºåˆ«">äºŒã€websocketä¸http åŒºåˆ«</h3>
<p>httpåè®®æ˜¯ç”¨åœ¨åº”ç”¨å±‚çš„åè®®ï¼Œä»–æ˜¯åŸºäºtcpåè®®çš„ï¼Œhttpåè®®å»ºç«‹é“¾æ¥ä¹Ÿå¿…é¡»è¦æœ‰ä¸‰æ¬¡æ¡æ‰‹æ‰èƒ½å‘é€ä¿¡æ¯ã€‚httpé“¾æ¥åˆ†ä¸ºçŸ­é“¾æ¥ï¼Œé•¿é“¾æ¥ï¼ŒçŸ­é“¾æ¥æ˜¯æ¯æ¬¡è¯·æ±‚éƒ½è¦ä¸‰æ¬¡æ¡æ‰‹æ‰èƒ½å‘é€è‡ªå·±çš„ä¿¡æ¯ã€‚å³æ¯ä¸€ä¸ªrequestå¯¹åº”ä¸€ä¸ªresponseã€‚é•¿é“¾æ¥æ˜¯åœ¨ä¸€å®šçš„æœŸé™å†…ä¿æŒé“¾æ¥ã€‚ä¿æŒTCPè¿æ¥ä¸æ–­å¼€ã€‚å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨é€šä¿¡ï¼Œå¿…é¡»è¦æœ‰å®¢æˆ·ç«¯å‘èµ·ç„¶åæœåŠ¡å™¨è¿”å›ç»“æœã€‚å®¢æˆ·ç«¯æ˜¯ä¸»åŠ¨çš„ï¼ŒæœåŠ¡å™¨æ˜¯è¢«åŠ¨çš„ã€‚<br>
WebSocketæ˜¯HTML5ä¸­çš„åè®®ï¼Œ ä»–æ˜¯ä¸ºäº†è§£å†³å®¢æˆ·ç«¯å‘èµ·å¤šä¸ªhttpè¯·æ±‚åˆ°æœåŠ¡å™¨èµ„æºæµè§ˆå™¨å¿…é¡»è¦ç»è¿‡é•¿æ—¶é—´çš„è½®è®­é—®é¢˜è€Œç”Ÿçš„ï¼Œä»–å®ç°äº†å¤šè·¯å¤ç”¨ï¼Œä»–æ˜¯å…¨åŒå·¥é€šä¿¡ã€‚åœ¨webSocketåè®®ä¸‹å®¢æœç«¯å’Œæµè§ˆå™¨å¯ä»¥åŒæ—¶å‘é€ä¿¡æ¯ã€‚æœåŠ¡å™¨ä¹Ÿå¯ä»¥ä¸»åŠ¨æ¨é€æ¶ˆæ¯ç»™å®¢æˆ·ç«¯ã€‚</p>
<p><a href="https://imgchr.com/i/G2Em9g" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2020/04/07/G2Em9g.md.png" alt="G2Em9g.md.png"></a></p>
<a id="more"></a>
<h3 id="ä¸‰ã€springbootæ•´åˆWebSocket">ä¸‰ã€springbootæ•´åˆWebSocket</h3>
<h5 id="1ã€mavenä¾èµ–">1ã€mavenä¾èµ–</h5>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&lt;dependency&gt;  </span><br><span class="line">    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;  </span><br><span class="line">    &lt;artifactId&gt;spring-boot-starter-websocket&lt;/artifactId&gt;  </span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>
<h5 id="2ã€é…ç½®WebSocketConfig">2ã€é…ç½®WebSocketConfig</h5>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Configuration</span>  </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WebSocketConfig</span> </span>&#123;  </span><br><span class="line">    <span class="comment">//å¦‚æœä½¿ç”¨äº†springbootå¯åŠ¨é¡¹ç›®ï¼Œåˆ™éœ€è¦beanæ³¨å…¥ï¼Œè€Œå¦‚æœä½¿ç”¨äº†å¤–ç½®tomcatå®¹å™¨ï¼Œåˆ™å¹¶ä¸è¦beanæ³¨å…¥ï¼Œå¦ä¾§ä¼šæŠ¥é”™</span></span><br><span class="line">    <span class="meta">@Bean</span>  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> ServerEndpointExporter <span class="title">serverEndpointExporter</span><span class="params">()</span> </span>&#123;  </span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ServerEndpointExporter();  </span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="3ã€è®¾ç½®WebSocketServerï¼ˆé‡ç‚¹ï¼‰">3ã€è®¾ç½®WebSocketServerï¼ˆé‡ç‚¹ï¼‰</h5>
<p>ç›´æ¥<code>@ServerEndpoint(&quot;/wsserver/{userId}&quot;)</code> ã€<code>@Component</code>å¯ç”¨å³å¯ï¼Œç„¶ååœ¨é‡Œé¢å®ç°<code>@OnOpen</code>å¼€å¯è¿æ¥ï¼Œ<code>@onClose</code>å…³é—­è¿æ¥ï¼Œ<code>@onMessage</code>æ¥æ”¶æ¶ˆæ¯ç­‰æ–¹æ³•</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSON;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSONObject;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.lang.StringUtils;</span><br><span class="line"><span class="keyword">import</span> org.apache.logging.log4j.LogManager;</span><br><span class="line"><span class="keyword">import</span> org.apache.logging.log4j.Logger;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.websocket.*;</span><br><span class="line"><span class="keyword">import</span> javax.websocket.server.PathParam;</span><br><span class="line"><span class="keyword">import</span> javax.websocket.server.ServerEndpoint;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.ConcurrentHashMap;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@ServerEndpoint</span>(<span class="string">"/wsserver/&#123;userId&#125;"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WebSocketServer</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> Logger logger = LogManager.getLogger(WebSocketServer<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">    <span class="comment">/**é™æ€å˜é‡ï¼Œç”¨æ¥è®°å½•å½“å‰åœ¨çº¿è¿æ¥æ•°ã€‚åº”è¯¥æŠŠå®ƒè®¾è®¡æˆçº¿ç¨‹å®‰å…¨çš„ã€‚*/</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> onlineCount = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">/**concurrentåŒ…çš„çº¿ç¨‹å®‰å…¨Setï¼Œç”¨æ¥å­˜æ”¾æ¯ä¸ªå®¢æˆ·ç«¯å¯¹åº”çš„MyWebSocketå¯¹è±¡ã€‚*/</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> ConcurrentHashMap&lt;String,WebSocketServer&gt; webSocketMap = <span class="keyword">new</span> ConcurrentHashMap&lt;&gt;();</span><br><span class="line">    <span class="comment">/**ä¸æŸä¸ªå®¢æˆ·ç«¯çš„è¿æ¥ä¼šè¯ï¼Œéœ€è¦é€šè¿‡å®ƒæ¥ç»™å®¢æˆ·ç«¯å‘é€æ•°æ®*/</span></span><br><span class="line">    <span class="keyword">private</span> Session session;</span><br><span class="line">    <span class="comment">/**æ¥æ”¶userId*/</span></span><br><span class="line">    <span class="keyword">private</span> String userId=<span class="string">""</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¿æ¥å»ºç«‹æˆåŠŸè°ƒç”¨çš„æ–¹æ³•*/</span></span><br><span class="line">    <span class="meta">@OnOpen</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onOpen</span><span class="params">(Session session,@PathParam(<span class="string">"userId"</span>)</span> String userId) </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.session = session;</span><br><span class="line">        <span class="keyword">this</span>.userId=userId;</span><br><span class="line">        <span class="keyword">if</span>(webSocketMap.containsKey(userId))&#123;</span><br><span class="line">            webSocketMap.remove(userId);</span><br><span class="line">            webSocketMap.put(userId,<span class="keyword">this</span>);</span><br><span class="line">            <span class="comment">//åŠ å…¥setä¸­</span></span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            webSocketMap.put(userId,<span class="keyword">this</span>);</span><br><span class="line">            <span class="comment">//åŠ å…¥setä¸­</span></span><br><span class="line">            addOnlineCount();</span><br><span class="line">            <span class="comment">//åœ¨çº¿æ•°åŠ 1</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        logger.info(<span class="string">"ç”¨æˆ·è¿æ¥:"</span>+userId+<span class="string">",å½“å‰åœ¨çº¿äººæ•°ä¸º:"</span> + getOnlineCount());</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            sendMessage(<span class="string">"è¿æ¥æˆåŠŸ"</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            logger.error(<span class="string">"ç”¨æˆ·:"</span>+userId+<span class="string">",ç½‘ç»œå¼‚å¸¸!!!!!!"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¿æ¥å…³é—­è°ƒç”¨çš„æ–¹æ³•</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@OnClose</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClose</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(webSocketMap.containsKey(userId))&#123;</span><br><span class="line">            webSocketMap.remove(userId);</span><br><span class="line">            <span class="comment">//ä»setä¸­åˆ é™¤</span></span><br><span class="line">            subOnlineCount();</span><br><span class="line">        &#125;</span><br><span class="line">        logger.info(<span class="string">"ç”¨æˆ·é€€å‡º:"</span>+userId+<span class="string">",å½“å‰åœ¨çº¿äººæ•°ä¸º:"</span> + getOnlineCount());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ”¶åˆ°å®¢æˆ·ç«¯æ¶ˆæ¯åè°ƒç”¨çš„æ–¹æ³•</span></span><br><span class="line"><span class="comment">     *éœ€è¦æœ‰</span></span><br><span class="line"><span class="comment">     * &#123;</span></span><br><span class="line"><span class="comment">     *     xxx:xxx,</span></span><br><span class="line"><span class="comment">     *     "toUserId","xx"</span></span><br><span class="line"><span class="comment">     * &#125;</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> message å®¢æˆ·ç«¯å‘é€è¿‡æ¥çš„æ¶ˆæ¯*/</span></span><br><span class="line">    <span class="meta">@OnMessage</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onMessage</span><span class="params">(String message, Session session)</span> </span>&#123;</span><br><span class="line">            logger.info(<span class="string">"ç”¨æˆ·æ¶ˆæ¯:"</span>+userId+<span class="string">",æŠ¥æ–‡:"</span>+message);</span><br><span class="line">            <span class="comment">//å¯ä»¥ç¾¤å‘æ¶ˆæ¯</span></span><br><span class="line">            <span class="comment">//æ¶ˆæ¯ä¿å­˜åˆ°æ•°æ®åº“ã€redis</span></span><br><span class="line">            <span class="keyword">if</span>(StringUtils.isNotBlank(message))&#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    <span class="comment">//è§£æå‘é€çš„æŠ¥æ–‡</span></span><br><span class="line">                    JSONObject jsonObject = JSON.parseObject(message);</span><br><span class="line">                    <span class="comment">//è¿½åŠ å‘é€äºº(é˜²æ­¢ä¸²æ”¹)</span></span><br><span class="line">                    jsonObject.put(<span class="string">"fromUserId"</span>,<span class="keyword">this</span>.userId);</span><br><span class="line">                    String toUserId=jsonObject.getString(<span class="string">"toUserId"</span>);</span><br><span class="line">                    <span class="comment">//ä¼ é€ç»™å¯¹åº”toUserIdç”¨æˆ·çš„websocket</span></span><br><span class="line">                    <span class="keyword">if</span>(StringUtils.isNotBlank(toUserId)&amp;&amp;webSocketMap.containsKey(toUserId))&#123;</span><br><span class="line">                        webSocketMap.get(toUserId).sendMessage(jsonObject.toJSONString());</span><br><span class="line">                    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                        logger.error(<span class="string">"è¯·æ±‚çš„userId:"</span>+toUserId+<span class="string">"ä¸åœ¨è¯¥æœåŠ¡å™¨ä¸Š"</span>);</span><br><span class="line">                        <span class="comment">//å¦åˆ™ä¸åœ¨è¿™ä¸ªæœåŠ¡å™¨ä¸Šï¼Œå‘é€åˆ°mysqlæˆ–è€…redis</span></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> session</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> error</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@OnError</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onError</span><span class="params">(Session session, Throwable error)</span> </span>&#123;</span><br><span class="line">        logger.error(<span class="string">"ç”¨æˆ·é”™è¯¯:"</span>+<span class="keyword">this</span>.userId+<span class="string">",åŸå› :"</span>+error.getMessage());</span><br><span class="line">        error.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å®ç°æœåŠ¡å™¨ä¸»åŠ¨æ¨é€</span></span><br><span class="line"><span class="comment">     * è¿™é‡Œéœ€è¦</span></span><br><span class="line"><span class="comment">     * &#123;xxx:xxx&#125;æ ¼å¼</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sendMessage</span><span class="params">(String message)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        System.out.println(<span class="keyword">this</span>);</span><br><span class="line">        System.out.println(<span class="keyword">this</span>.session);</span><br><span class="line">        <span class="keyword">this</span>.session.getBasicRemote().sendText(message);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å‘é€è‡ªå®šä¹‰æ¶ˆæ¯</span></span><br><span class="line"><span class="comment">     * */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">sendInfo</span><span class="params">(String message,@PathParam(<span class="string">"userId"</span>)</span> String userId) <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        logger.info(<span class="string">"å‘é€æ¶ˆæ¯åˆ°:"</span>+userId+<span class="string">"ï¼ŒæŠ¥æ–‡:"</span>+message);</span><br><span class="line">        <span class="keyword">if</span>(StringUtils.isNotBlank(userId)&amp;&amp;webSocketMap.containsKey(userId))&#123;</span><br><span class="line">            webSocketMap.get(userId).sendMessage(message);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            logger.error(<span class="string">"ç”¨æˆ·"</span>+userId+<span class="string">",ä¸åœ¨çº¿ï¼"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">synchronized</span> <span class="keyword">int</span> <span class="title">getOnlineCount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> onlineCount;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">addOnlineCount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        WebSocketServer.onlineCount++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">subOnlineCount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        WebSocketServer.onlineCount--;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ³¨æ„ï¼šå¦‚æœé¡¹ç›®ä½¿ç”¨äº†nginxåå‘ä»£ç†ï¼Œåˆ™éœ€è¦åœ¨nginxçš„é…ç½®æ–‡ä»¶çš„<code>location/</code>ä½ç½®å¤„æ·»åŠ </p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">proxy_http_version 1.1;</span><br><span class="line">proxy_set_header Upgrade <span class="variable">$http_upgrade</span>;</span><br><span class="line">proxy_set_header Connection <span class="string">"upgrade"</span>;</span><br><span class="line"><span class="comment"># è¶…æ—¶æ—¶é—´è®¾ç½®ä¸ºä¸¤å°æ—¶</span></span><br><span class="line">proxy_read_timeout 7200s;</span><br></pre></td></tr></table></figure>
<h5 id="4ã€å‰ç«¯é¡µé¢è°ƒç”¨">4ã€å‰ç«¯é¡µé¢è°ƒç”¨</h5>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">HTML</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Test My WebSocket<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    Test<span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">"text"</span> <span class="attr">type</span>=<span class="string">"text"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">onclick</span>=<span class="string">"send()"</span>&gt;</span>Send<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">onclick</span>=<span class="string">"closeWebSocket()"</span>&gt;</span>Close<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"message"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> websocket = <span class="literal">null</span>;</span></span><br><span class="line"><span class="actionscript">    <span class="comment">//åˆ¤æ–­å½“å‰æµè§ˆå™¨æ˜¯å¦æ”¯æŒWebSocket</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">if</span> (<span class="string">'WebSocket'</span> <span class="keyword">in</span> <span class="built_in">window</span>) &#123;</span></span><br><span class="line"><span class="actionscript">        <span class="comment">//è¿æ¥WebSocketèŠ‚ç‚¹ </span></span></span><br><span class="line"><span class="actionscript">        <span class="comment">//è¿™é‡Œçš„useridè‡ªå·±ä¿®æ”¹å°±å¯ä»¥æ¨¡æ‹Ÿå¼€å¤šä¸ªç•Œé¢</span></span></span><br><span class="line"><span class="actionscript">        <span class="comment">//è¿™é‡Œçš„åœ°å€å†™ä¸Šä½ websocketçš„æœåŠ¡åœ°å€</span></span></span><br><span class="line"><span class="actionscript">        websocket = <span class="keyword">new</span> WebSocket(<span class="string">"ws://localhost:8888/wsserver/1"</span>);</span></span><br><span class="line"><span class="actionscript">    &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="actionscript">        alert(<span class="string">'Not support websocket'</span>)</span></span><br><span class="line">    &#125;</span><br><span class="line"><span class="actionscript">    <span class="comment">//è¿æ¥å‘ç”Ÿé”™è¯¯çš„å›è°ƒæ–¹æ³•</span></span></span><br><span class="line"><span class="actionscript">    websocket.onerror = <span class="function"><span class="keyword">function</span><span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="actionscript">        setMessageInnerHTML(<span class="string">"error"</span>);</span></span><br><span class="line">    &#125;;</span><br><span class="line"><span class="actionscript">    <span class="comment">//è¿æ¥æˆåŠŸå»ºç«‹çš„å›è°ƒæ–¹æ³•</span></span></span><br><span class="line"><span class="actionscript">    websocket.onopen = <span class="function"><span class="keyword">function</span><span class="params">(event)</span> </span>&#123;</span></span><br><span class="line"><span class="actionscript">            setMessageInnerHTML(<span class="string">"open"</span>);</span></span><br><span class="line">        &#125;</span><br><span class="line"><span class="actionscript">        <span class="comment">//æ¥æ”¶åˆ°æ¶ˆæ¯çš„å›è°ƒæ–¹æ³•</span></span></span><br><span class="line"><span class="actionscript">    websocket.onmessage = <span class="function"><span class="keyword">function</span><span class="params">(event)</span> </span>&#123;</span></span><br><span class="line">        setMessageInnerHTML(event.data);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="actionscript">    <span class="comment">//è¿æ¥å…³é—­çš„å›è°ƒæ–¹æ³•</span></span></span><br><span class="line"><span class="actionscript">    websocket.onclose = <span class="function"><span class="keyword">function</span><span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="actionscript">        setMessageInnerHTML(<span class="string">"close"</span>);</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="actionscript">    <span class="comment">//ç›‘å¬çª—å£å…³é—­äº‹ä»¶ï¼Œå½“çª—å£å…³é—­æ—¶ï¼Œä¸»åŠ¨å»å…³é—­websocketè¿æ¥ï¼Œé˜²æ­¢è¿æ¥è¿˜æ²¡æ–­å¼€å°±å…³é—­çª—å£ï¼Œserverç«¯ä¼šæŠ›å¼‚å¸¸ã€‚</span></span></span><br><span class="line"><span class="javascript">    <span class="built_in">window</span>.onbeforeunload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line">        websocket.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="actionscript">    <span class="comment">//å°†æ¶ˆæ¯æ˜¾ç¤ºåœ¨ç½‘é¡µä¸Š</span></span></span><br><span class="line"><span class="actionscript">    <span class="function"><span class="keyword">function</span> <span class="title">setMessageInnerHTML</span><span class="params">(innerHTML)</span> </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">document</span>.getElementById(<span class="string">'message'</span>).innerHTML += innerHTML + <span class="string">'&lt;br/&gt;'</span>;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="actionscript">    <span class="comment">//å…³é—­è¿æ¥</span></span></span><br><span class="line"><span class="actionscript">    <span class="function"><span class="keyword">function</span> <span class="title">closeWebSocket</span><span class="params">()</span> </span>&#123;</span></span><br><span class="line">        websocket.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="actionscript">    <span class="comment">//å‘é€æ¶ˆæ¯</span></span></span><br><span class="line"><span class="actionscript">    <span class="function"><span class="keyword">function</span> <span class="title">send</span><span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> message = <span class="built_in">document</span>.getElementById(<span class="string">'text'</span>).value;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(message);</span></span><br><span class="line">        websocket.send(message);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h5 id="5ã€è¿è¡Œç»“æœ">5ã€è¿è¡Œç»“æœ</h5>
<p>åœ¨è¿™é‡Œæˆ‘å¼€äº†ä¸¤ä¸ªç•Œé¢ï¼ŒuserIdåˆ†åˆ«æ˜¯1å’Œ2ï¼Œè¿™é‡Œæˆ‘åœ¨1å‘é€äº†å¦‚ä¸‹jsonä¸²ï¼Œè¿™ä¼šç»è¿‡æœåŠ¡å™¨è‡ªåŠ¨è½¬å‘åˆ°ä»ç„¶åœ¨çº¿çš„2ã€‚åŒæ—¶æˆ‘ä»¬å¯ä»¥æŸ¥çœ‹åˆ°æœåŠ¡ç«¯å¯ä»¥ç»Ÿè®¡å½“å‰åœ¨çº¿äººæ•°ï¼Œè¿˜æ‰“å°å‡ºäº†è½¬å‘çš„æŠ¥æ–‡</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">	&quot;msg&quot;: &quot;wda&quot;,</span><br><span class="line">	&quot;toUserId&quot;: &quot;2&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><a href="https://imgchr.com/i/G2VoLR" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2020/04/07/G2VoLR.md.png" alt="G2VoLR.md.png"></a><br>
<a href="https://imgchr.com/i/G2VIy9" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2020/04/07/G2VIy9.md.png" alt="G2VIy9.md.png"></a></p>
<p>ç®€å•çš„å®æˆ˜åˆ°æ­¤ä¸ºæ­¢ï¼Œå†æ¬¡åŸºç¡€ä¸Šå¯ä»¥ä¿®æ”¹å¾ˆå¤šåŠŸèƒ½å•¦~</p>
<p><br><br><br></p>
<p><a href="https://blog.csdn.net/huiyunfei/article/details/90719351?depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-2&amp;utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-2" target="_blank" rel="noopener">å‚è€ƒåšå®¢</a></p>
]]></content>
      <categories>
        <category>Java</category>
      </categories>
      <tags>
        <tag>springboot</tag>
        <tag>WebSocket</tag>
      </tags>
  </entry>
  <entry>
    <title>springbooté›†æˆRabbitMQç®€å•å…¥é—¨å®è·µ</title>
    <url>/posts/538a1b2.html</url>
    <content><![CDATA[<h3 id="ä¸€ã€RabbitMQæ ¸å¿ƒæ¦‚å¿µ">ä¸€ã€RabbitMQæ ¸å¿ƒæ¦‚å¿µ</h3>
<p>RabbitMQæ˜¯ä¸€ä¸ªç”±erlangå¼€å‘çš„AMQP(Advanved Message Queue Protocol)çš„å¼€æºå®ç°ã€‚æ‰€æœ‰ MQ äº§å“ä»æ¨¡å‹æŠ½è±¡ä¸Šæ¥è¯´éƒ½æ˜¯ä¸€æ ·çš„è¿‡ç¨‹ï¼š</p>
<blockquote>
<p>æ¶ˆè´¹è€…ï¼ˆconsumerï¼‰è®¢é˜…æŸä¸ªé˜Ÿåˆ—ã€‚ç”Ÿäº§è€…ï¼ˆproducerï¼‰åˆ›å»ºæ¶ˆæ¯ï¼Œç„¶åå‘å¸ƒåˆ°é˜Ÿåˆ—ï¼ˆqueueï¼‰ä¸­ï¼Œæœ€åå°†æ¶ˆæ¯å‘é€åˆ°ç›‘å¬çš„æ¶ˆè´¹è€…ã€‚</p>
</blockquote>
<p><img src="https://img-blog.csdnimg.cn/img_convert/f2c700887fa3dfe1fae01a0dbe6ecf63.png" alt=""></p>
<h5 id="1ã€Message">1ã€Message</h5>
<p>æ¶ˆæ¯ï¼Œæ¶ˆæ¯æ˜¯ä¸å…·åçš„ï¼Œå®ƒç”±æ¶ˆæ¯å¤´å’Œæ¶ˆæ¯ä½“ç»„æˆã€‚æ¶ˆæ¯ä½“æ˜¯ä¸é€æ˜çš„ï¼Œè€Œæ¶ˆæ¯å¤´åˆ™ç”±ä¸€ç³»åˆ—çš„å¯é€‰å±æ€§ç»„æˆï¼Œè¿™äº›å±æ€§åŒ…æ‹¬routing-key(è·¯ç”±é”®)ã€priority(ç›¸å¯¹äºå…¶ä»–æ¶ˆæ¯çš„ä¼˜å…ˆæƒ)ã€delivery-mode(æŒ‡å‡ºè¯¥æ¶ˆæ¯å¯èƒ½éœ€è¦æŒä¹…æ€§å­˜å‚¨)ç­‰ã€‚</p>
<h5 id="2ã€Publisher">2ã€Publisher</h5>
<p>æ¶ˆæ¯çš„ç”Ÿäº§è€…ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªå‘äº¤æ¢å™¨å‘å¸ƒæ¶ˆæ¯çš„å®¢æˆ·ç«¯åº”ç”¨ç¨‹åºã€‚</p>
<a id="more"></a>
<h5 id="3ã€Exchange">3ã€Exchange</h5>
<p>äº¤æ¢å™¨ï¼Œç”¨æ¥æ¥æ”¶ç”Ÿäº§è€…å‘é€çš„æ¶ˆæ¯å¹¶å°†è¿™äº›æ¶ˆæ¯è·¯ç”±ç»™æœåŠ¡å™¨ä¸­çš„é˜Ÿåˆ—ã€‚</p>
<p>Exchangeæœ‰4ç§ç±»å‹:direct(é»˜è®¤)ï¼Œfanout, topic, å’Œheadersï¼Œä¸åŒç±»å‹çš„Exchangeè½¬å‘æ¶ˆæ¯çš„ç­–ç•¥æœ‰æ‰€åŒºåˆ«ã€‚</p>
<h5 id="4ã€Queue">4ã€Queue</h5>
<p>æ¶ˆæ¯é˜Ÿåˆ—ï¼Œç”¨æ¥ä¿å­˜æ¶ˆæ¯ç›´åˆ°å‘é€ç»™æ¶ˆè´¹è€…ã€‚å®ƒæ˜¯æ¶ˆæ¯çš„å®¹å™¨ï¼Œä¹Ÿæ˜¯æ¶ˆæ¯çš„ç»ˆç‚¹ã€‚ä¸€ä¸ªæ¶ˆæ¯å¯æŠ•å…¥ä¸€ä¸ªæˆ–å¤šä¸ªé˜Ÿåˆ—ã€‚æ¶ˆæ¯ä¸€ç›´åœ¨é˜Ÿåˆ—é‡Œé¢ï¼Œç­‰å¾…æ¶ˆè´¹è€…è¿æ¥åˆ°è¿™ä¸ªé˜Ÿåˆ—å°†å…¶å–èµ°ã€‚</p>
<h5 id="5ã€Binding">5ã€Binding</h5>
<p>ç»‘å®šï¼Œç”¨äºæ¶ˆæ¯é˜Ÿåˆ—å’Œäº¤æ¢å™¨ä¹‹é—´çš„å…³è”ã€‚ä¸€ä¸ªç»‘å®šå°±æ˜¯åŸºäºè·¯ç”±é”®å°†äº¤æ¢å™¨å’Œæ¶ˆæ¯é˜Ÿåˆ—è¿æ¥èµ·æ¥çš„è·¯ç”±è§„åˆ™ï¼Œæ‰€ä»¥å¯ä»¥å°†äº¤æ¢å™¨ç†è§£æˆä¸€ä¸ªç”±ç»‘å®šæ„æˆçš„è·¯ç”±è¡¨ã€‚Exchange å’ŒQueueçš„ç»‘å®šå¯ä»¥æ˜¯å¤šå¯¹å¤šçš„å…³ç³»ã€‚</p>
<h5 id="6ã€Connection">6ã€Connection</h5>
<p>ç½‘ç»œè¿æ¥ï¼Œæ¯”å¦‚ä¸€ä¸ªTCPè¿æ¥ã€‚</p>
<h5 id="7ã€Channel">7ã€Channel</h5>
<p>ä¿¡é“ï¼Œå¤šè·¯å¤ç”¨è¿æ¥ä¸­çš„ä¸€æ¡ç‹¬ç«‹çš„åŒå‘æ•°æ®æµé€šé“ã€‚ä¿¡é“æ˜¯å»ºç«‹åœ¨çœŸå®çš„TCPè¿æ¥å†…çš„è™šæ‹Ÿè¿æ¥ï¼ŒAMQP å‘½ä»¤éƒ½æ˜¯é€šè¿‡ä¿¡é“å‘å‡ºå»çš„ï¼Œä¸ç®¡æ˜¯å‘å¸ƒæ¶ˆæ¯ã€è®¢é˜…é˜Ÿåˆ—è¿˜æ˜¯æ¥æ”¶æ¶ˆæ¯ï¼Œè¿™äº›åŠ¨ä½œéƒ½æ˜¯é€šè¿‡ä¿¡é“å®Œæˆã€‚å› ä¸ºå¯¹äºæ“ä½œç³»ç»Ÿæ¥è¯´å»ºç«‹å’Œé”€æ¯ TCP éƒ½æ˜¯éå¸¸æ˜‚è´µçš„å¼€é”€ï¼Œæ‰€ä»¥å¼•å…¥äº†ä¿¡é“çš„æ¦‚å¿µï¼Œä»¥å¤ç”¨ä¸€æ¡TCPè¿æ¥ã€‚</p>
<h5 id="8ã€Consumer">8ã€Consumer</h5>
<p>æ¶ˆæ¯çš„æ¶ˆè´¹è€…ï¼Œè¡¨ç¤ºä¸€ä¸ªä»æ¶ˆæ¯é˜Ÿåˆ—ä¸­å–å¾—æ¶ˆæ¯çš„å®¢æˆ·ç«¯åº”ç”¨ç¨‹åºã€‚</p>
<h5 id="9ã€Virtual-Host">9ã€Virtual Host</h5>
<p>è™šæ‹Ÿä¸»æœºï¼Œè¡¨ç¤ºä¸€æ‰¹äº¤æ¢å™¨ã€æ¶ˆæ¯é˜Ÿåˆ—å’Œç›¸å…³å¯¹è±¡ã€‚è™šæ‹Ÿä¸»æœºæ˜¯å…±äº«ç›¸åŒçš„èº«ä»½è®¤è¯å’ŒåŠ å¯†ç¯å¢ƒçš„ç‹¬ç«‹æœåŠ¡å™¨åŸŸã€‚æ¯ä¸ª vhost æœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ª mini ç‰ˆçš„ RabbitMQ æœåŠ¡å™¨ï¼Œæ‹¥æœ‰è‡ªå·±çš„é˜Ÿåˆ—ã€äº¤æ¢å™¨ã€ç»‘å®šå’Œæƒé™æœºåˆ¶ã€‚vhost æ˜¯ AMQP æ¦‚å¿µçš„åŸºç¡€ï¼Œå¿…é¡»åœ¨è¿æ¥æ—¶æŒ‡å®šï¼Œ RabbitMQ é»˜è®¤çš„ vhost æ˜¯ / ã€‚</p>
<h5 id="10ã€Broker">10ã€Broker</h5>
<p>è¡¨ç¤ºæ¶ˆæ¯é˜Ÿåˆ—æœåŠ¡å™¨å®ä½“<br>
<img src="https://img-blog.csdnimg.cn/img_convert/372d6ee73ac9f85bfbea86a0421b4906.png" alt="GZ9M79.png"></p>
<h3 id="äºŒã€AMQPçš„æ¶ˆæ¯è·¯ç”±">äºŒã€AMQPçš„æ¶ˆæ¯è·¯ç”±</h3>
<ol>
<li>
<p>AMQP ä¸­æ¶ˆæ¯çš„è·¯ç”±è¿‡ç¨‹å’Œ Java å¼€å‘è€…ç†Ÿæ‚‰çš„ JMS å­˜åœ¨ä¸€äº›å·®åˆ«ï¼ŒAMQP ä¸­å¢åŠ äº† Exchange å’Œ Binding çš„è§’è‰²ã€‚ç”Ÿäº§è€…æŠŠæ¶ˆæ¯å‘å¸ƒåˆ° Exchange ä¸Šï¼Œæ¶ˆæ¯æœ€ç»ˆåˆ°è¾¾é˜Ÿåˆ—å¹¶è¢«æ¶ˆè´¹è€…æ¥æ”¶ï¼Œè€Œ Binding å†³å®šäº¤æ¢å™¨çš„æ¶ˆæ¯åº”è¯¥å‘é€åˆ°é‚£ä¸ªé˜Ÿåˆ—ã€‚<br>
<img src="https://img-blog.csdn.net/20181022154515317?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzI5NDc5MDQx/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt=""></p>
<h4 id="Exchange-ç±»å‹"><strong>Exchange ç±»å‹</strong></h4>
<p>Exchangeåˆ†å‘æ¶ˆæ¯æ—¶æ ¹æ®ç±»å‹çš„ä¸åŒåˆ†å‘ç­–ç•¥æœ‰åŒºåˆ«ï¼Œç›®å‰å…±å››ç§ç±»å‹ï¼šdirectã€fanoutã€topicã€headers ã€‚headers åŒ¹é… AMQP æ¶ˆæ¯çš„ header è€Œä¸æ˜¯è·¯ç”±é”®ï¼Œæ­¤å¤– headers äº¤æ¢å™¨å’Œ direct äº¤æ¢å™¨å®Œå…¨ä¸€è‡´ï¼Œä½†æ€§èƒ½å·®å¾ˆå¤šï¼Œç›®å‰å‡ ä¹ç”¨ä¸åˆ°äº†ï¼Œæ‰€ä»¥ç›´æ¥çœ‹å¦å¤–ä¸‰ç§ç±»å‹ï¼š</p>
<h4 id="1ã€direct">1ã€direct</h4>
<p><img src="https://img-blog.csdn.net/20181022154545524?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzI5NDc5MDQx/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt=""></p>
<p>direct äº¤æ¢å™¨</p>
<p>æ¶ˆæ¯ä¸­çš„è·¯ç”±é”®ï¼ˆrouting keyï¼‰å¦‚æœå’Œ Binding ä¸­çš„ binding key ä¸€è‡´ï¼Œ äº¤æ¢å™¨å°±å°†æ¶ˆæ¯å‘åˆ°å¯¹åº”çš„é˜Ÿåˆ—ä¸­ã€‚è·¯ç”±é”®ä¸é˜Ÿåˆ—åå®Œå…¨åŒ¹é…ï¼Œå¦‚æœä¸€ä¸ªé˜Ÿåˆ—ç»‘å®šåˆ°äº¤æ¢æœºè¦æ±‚è·¯ç”±é”®ä¸ºâ€œdogâ€ï¼Œåˆ™åªè½¬å‘ routing key æ ‡è®°ä¸ºâ€œdogâ€çš„æ¶ˆæ¯ï¼Œä¸ä¼šè½¬å‘â€œdog.puppyâ€ï¼Œä¹Ÿä¸ä¼šè½¬å‘â€œdog.guardâ€ç­‰ç­‰ã€‚å®ƒæ˜¯å®Œå…¨åŒ¹é…ã€å•æ’­çš„æ¨¡å¼ã€‚</p>
<h4 id="2ã€fanout">2ã€fanout</h4>
<p><img src="https://img-blog.csdn.net/20181022154613161?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzI5NDc5MDQx/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt=""></p>
<p>fanout äº¤æ¢å™¨</p>
<p>æ¯ä¸ªå‘åˆ° fanout ç±»å‹äº¤æ¢å™¨çš„æ¶ˆæ¯éƒ½ä¼šåˆ†åˆ°æ‰€æœ‰ç»‘å®šçš„é˜Ÿåˆ—ä¸Šå»ã€‚fanout äº¤æ¢å™¨ä¸å¤„ç†è·¯ç”±é”®ï¼Œåªæ˜¯ç®€å•çš„å°†é˜Ÿåˆ—ç»‘å®šåˆ°äº¤æ¢å™¨ä¸Šï¼Œæ¯ä¸ªå‘é€åˆ°äº¤æ¢å™¨çš„æ¶ˆæ¯éƒ½ä¼šè¢«è½¬å‘åˆ°ä¸è¯¥äº¤æ¢å™¨ç»‘å®šçš„æ‰€æœ‰é˜Ÿåˆ—ä¸Šã€‚å¾ˆåƒå­ç½‘å¹¿æ’­ï¼Œæ¯å°å­ç½‘å†…çš„ä¸»æœºéƒ½è·å¾—äº†ä¸€ä»½å¤åˆ¶çš„æ¶ˆæ¯ã€‚fanout ç±»å‹è½¬å‘æ¶ˆæ¯æ˜¯æœ€å¿«çš„ã€‚</p>
<h4 id="3ã€topic">3ã€topic</h4>
<p><img src="https://img-blog.csdn.net/20181022154644143?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzI5NDc5MDQx/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt=""></p>
<p>topic äº¤æ¢å™¨</p>
<p>topic äº¤æ¢å™¨é€šè¿‡æ¨¡å¼åŒ¹é…åˆ†é…æ¶ˆæ¯çš„è·¯ç”±é”®å±æ€§ï¼Œå°†è·¯ç”±é”®å’ŒæŸä¸ªæ¨¡å¼è¿›è¡ŒåŒ¹é…ï¼Œæ­¤æ—¶é˜Ÿåˆ—éœ€è¦ç»‘å®šåˆ°ä¸€ä¸ªæ¨¡å¼ä¸Šã€‚å®ƒå°†è·¯ç”±é”®å’Œç»‘å®šé”®çš„å­—ç¬¦ä¸²åˆ‡åˆ†æˆå•è¯ï¼Œè¿™äº›å•è¯ä¹‹é—´ç”¨ç‚¹éš”å¼€ã€‚å®ƒåŒæ ·ä¹Ÿä¼šè¯†åˆ«ä¸¤ä¸ªé€šé…ç¬¦ï¼šç¬¦å·â€œ#â€å’Œç¬¦å·â€œ</p>
<p>â€ã€‚#åŒ¹é…0ä¸ªæˆ–å¤šä¸ªå•è¯ï¼Œ</p>
<p>åŒ¹é…ä¸å¤šä¸å°‘ä¸€ä¸ªå•è¯ã€‚</p>
</li>
</ol>
<h3 id="ä¸‰ã€RabbitMQçš„å®‰è£…">ä¸‰ã€RabbitMQçš„å®‰è£…</h3>
<p>Windowså’ŒLinuxçš„æ™®é€šå®‰è£…æˆ‘åœ¨è¿™å°±ä¸é˜è¿°äº†ï¼Œç½‘ä¸Šä¸€æœæœ‰å¾ˆå¤šæ–¹æ³•ï¼Œä½†è¦æ³¨æ„çš„æ˜¯erlç‰ˆæœ¬å’ŒRabbitMQç‰ˆæœ¬çš„å¯¹åº”å…³ç³»ï¼Œå…·ä½“è§<a href="https://www.rabbitmq.com/which-erlang.html" target="_blank" rel="noopener">å®˜ç½‘ç‰ˆæœ¬å¯¹åº”</a></p>
<p>åœ¨è¿™é‡Œæˆ‘æä¾›äº†ä¸€ç§ç®€å•çš„å®‰è£…æ–¹æ³•ï¼Œè¿™é‡Œçš„å®‰è£…ç¯å¢ƒæ˜¯centos7.6ï¼Œdockerå®‰è£…ï¼Œç›´æ¥å‡ åˆ†é’Ÿå°±å¯ä»¥å®‰è£…å¥½äº†ã€‚é»˜è®¤ä½ å·²ç»å®‰è£…å¥½äº†docker</p>
<blockquote>
<p>1ã€æ‰“å¼€è¿œç¨‹æœåŠ¡å™¨ï¼Œè®°å¾—ä¸‹è½½è¿™ä¸ªå¸¦webç®¡ç†çš„</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">docker pull rabbitmq:management</span><br></pre></td></tr></table></figure>
<blockquote>
<p>2.æŸ¥çœ‹ä¸‹è½½çš„é•œåƒ</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">docker images</span><br></pre></td></tr></table></figure>
<blockquote>
<p>3.è¿è¡Œé•œåƒï¼Œè¿™é‡Œæ³¨æ„é˜²ç«å¢™çš„å¼€æ”¾</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">docker run -d --name rabbitmq -p 5671:5671 -p 5672:5672 -p 4369:4369 -p 25672:25672 -p 15671:15671 -p 15672:15672 rabbitmq:management</span><br></pre></td></tr></table></figure>
<blockquote>
<p>4.è¾“å…¥ç½‘å€ï¼š<a href="http://IP:15672/" target="_blank" rel="noopener">http://IP:15672/</a> è´¦å·å¯†ç ï¼šguest/guestï¼Œå³å¯è¿›å…¥webç®¡ç†ç•Œé¢</p>
</blockquote>
<h3 id="å››ã€springbooté›†æˆç®€å•å®è·µ-ç‚¹å¯¹ç‚¹">å››ã€springbooté›†æˆç®€å•å®è·µ(ç‚¹å¯¹ç‚¹)</h3>
<h5 id="1ã€æ‰“å¼€ç®¡ç†ç•Œé¢ï¼Œç‚¹å‡»è¿›å…¥Exchangesï¼Œé€‰æ‹©æ–°å»ºä¸€ä¸ªï¼Œè¿™é‡Œæˆ‘è®¾ç½®åå­—ä¸ºexchange-directï¼Œå¹¶ä¸”é€‰æ‹©ç±»å‹ä¸ºdirect-è¡¨ç¤ºç‚¹å¯¹ç‚¹ã€‚è€Œå¦‚æœè¦å¹¿æ’­æ¨¡å¼ï¼Œå°±é€‰æ‹©fanoutæ¨¡å¼ï¼Œå¹¶ä¸”ç»‘å®šçš„é˜Ÿåˆ—ä¸éœ€è¦è®¾ç½®è·¯ç”±é”®ï¼Œè¿™æ ·åªè¦æœ‰ç”Ÿäº§è€…ç”Ÿäº§ï¼Œæ‰€æœ‰ç›‘å¬çš„æ¶ˆè´¹è€…éƒ½èƒ½æ”¶åˆ°ã€‚">1ã€æ‰“å¼€ç®¡ç†ç•Œé¢ï¼Œç‚¹å‡»è¿›å…¥Exchangesï¼Œé€‰æ‹©æ–°å»ºä¸€ä¸ªï¼Œè¿™é‡Œæˆ‘è®¾ç½®åå­—ä¸ºexchange.directï¼Œå¹¶ä¸”é€‰æ‹©ç±»å‹ä¸ºdirect,è¡¨ç¤ºç‚¹å¯¹ç‚¹ã€‚è€Œå¦‚æœè¦å¹¿æ’­æ¨¡å¼ï¼Œå°±é€‰æ‹©fanoutæ¨¡å¼ï¼Œå¹¶ä¸”ç»‘å®šçš„é˜Ÿåˆ—ä¸éœ€è¦è®¾ç½®è·¯ç”±é”®ï¼Œè¿™æ ·åªè¦æœ‰ç”Ÿäº§è€…ç”Ÿäº§ï¼Œæ‰€æœ‰ç›‘å¬çš„æ¶ˆè´¹è€…éƒ½èƒ½æ”¶åˆ°ã€‚</h5>
<p><img src="https://img-blog.csdnimg.cn/img_convert/58afb5845b1749c97694b90911235eda.png" alt="GZkGLT.png"></p>
<h5 id="2ã€ç‚¹å‡»Queuesï¼Œæ–°å»ºä¸€ä¸ªé˜Ÿåˆ—ï¼Œè¿™é‡Œæˆ‘æ–°å»ºäº†loginçš„é˜Ÿåˆ—">2ã€ç‚¹å‡»Queuesï¼Œæ–°å»ºä¸€ä¸ªé˜Ÿåˆ—ï¼Œè¿™é‡Œæˆ‘æ–°å»ºäº†loginçš„é˜Ÿåˆ—</h5>
<p><img src="https://img-blog.csdnimg.cn/img_convert/5e3c0de2e5e49c14a7443cc9b7118db4.png" alt="GZk8yV.md.png"></p>
<h5 id="3ã€è¿”å›åˆšæ‰çš„Exchangeäº¤æ¢å™¨ï¼Œç‚¹å‡»è¿›å…¥æˆ‘ä»¬åˆšæ‰åˆ›å»ºçš„exchange-directï¼Œæ¥å¯¹loginé˜Ÿåˆ—è¿›è¡Œç»‘å®šï¼Œè¿™é‡Œè·¯ç”±é”®ä¹Ÿè®¾ç½®ä¸ºlogin">3ã€è¿”å›åˆšæ‰çš„Exchangeäº¤æ¢å™¨ï¼Œç‚¹å‡»è¿›å…¥æˆ‘ä»¬åˆšæ‰åˆ›å»ºçš„exchange.directï¼Œæ¥å¯¹loginé˜Ÿåˆ—è¿›è¡Œç»‘å®šï¼Œè¿™é‡Œè·¯ç”±é”®ä¹Ÿè®¾ç½®ä¸ºlogin</h5>
<p><img src="https://img-blog.csdnimg.cn/img_convert/deed23c94bbfbfe9f072d28d0cf8bbd7.png" alt="GZkYeU.png"></p>
<h5 id="4ã€springbooté¡¹ç›®å¼•å…¥mavenä¾èµ–">4ã€springbooté¡¹ç›®å¼•å…¥mavenä¾èµ–</h5>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;spring-boot-starter-amqp&lt;/artifactId&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>
<h5 id="5ã€é…ç½®yml">5ã€é…ç½®yml</h5>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">spring</span><br><span class="line">  rabbitmq:</span><br><span class="line">    host: localhost</span><br><span class="line">    port: <span class="number">5672</span></span><br><span class="line">    username: guest</span><br><span class="line">    password: guest</span><br></pre></td></tr></table></figure>
<h5 id="6ã€config">6ã€config</h5>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//è‡ªå®šä¹‰MessageConverterï¼šå°†æ•°æ®è‡ªåŠ¨è½¬ä¸ºjosnå‘é€å‡ºå»</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyAMQPConfig</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> MessageConverter <span class="title">messageConverter</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Jackson2JsonMessageConverter();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="6ã€åˆ©ç”¨RabbitTemplateæ¶ˆæ¯å‘é€å¤„ç†ç»„ä»¶">6ã€åˆ©ç”¨RabbitTemplateæ¶ˆæ¯å‘é€å¤„ç†ç»„ä»¶</h5>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RabbitMQTest</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    RabbitTemplate rabbitTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">contextLoads</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//å¯¹è±¡è¢«é»˜è®¤åºåˆ—åŒ–</span></span><br><span class="line">        Map map = <span class="keyword">new</span> HashMap();</span><br><span class="line">        map.put(<span class="string">"msg"</span>,<span class="string">"helloword"</span>);</span><br><span class="line">        map.put(<span class="string">"data"</span>, Arrays.asList(<span class="string">"jkdsnj"</span>,<span class="number">123</span>,<span class="keyword">true</span>));</span><br><span class="line">       rabbitTemplate.convertAndSend(<span class="string">"exchange.direct"</span>,<span class="string">"login"</span>,map);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">receive</span><span class="params">()</span></span>&#123;</span><br><span class="line">    	<span class="comment">//è¿™æ˜¯ç›‘å¬ï¼Œä¸€æœ‰ç”Ÿäº§è€…ç”Ÿäº§ï¼Œè¿™é‡Œç«‹åˆ»èƒ½æ”¶åˆ°æ¶ˆæ¯</span></span><br><span class="line">        Object o = rabbitTemplate.receiveAndConvert(<span class="string">"login"</span>);</span><br><span class="line">        System.out.println(o);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>å¦å¤–æ¶ˆè´¹è€…è¿˜å¯ä»¥é€šè¿‡æ³¨è§£å®ç°ï¼Œåœ¨æ–¹æ³•å‰åŠ å…¥RabbitListenerï¼Œå¹¶å†™å‡ºé˜Ÿåˆ—ï¼Œå³å¯è‡ªåŠ¨ç›‘å¬ï¼ŒåŒæ—¶æ³¨æ„éœ€è¦åœ¨å¯åŠ¨ç±»ä¸ŠåŠ @EnableRabbit</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RabbitListener</span>(queues = <span class="string">"login"</span>)</span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">receive</span><span class="params">(Map map)</span></span>&#123;</span><br><span class="line">       System.out.println(<span class="string">"Rabbit"</span> + map);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>å¥½äº†ï¼Œåˆ°ç°åœ¨ä¸ºæ­¢ï¼Œä¸€ä¸ªç®€å•çš„ç‚¹å¯¹ç‚¹æ¶ˆæ¯é˜Ÿåˆ—å·²ç»é›†æˆå®Œæ¯•ï¼Œæ ¹æ®è¿™ä¸ªå¯ä»¥æ ¹æ®éœ€è¦åŠ å…¥åˆ°é¡¹ç›®ä¸­ï¼Œå…·ä½“ä¹Ÿå¯è§å‚è€ƒæ–‡ç« </p>
<br/>
<hr>
<h4 id="å‚è€ƒæ–‡ç« ">å‚è€ƒæ–‡ç« </h4>
<p><a href="https://blog.csdn.net/qq_29479041/article/details/83273735" target="_blank" rel="noopener">https://blog.csdn.net/qq_29479041/article/details/83273735</a></p>
<p><a href="https://www.jianshu.com/p/bd41f1a1e53d" target="_blank" rel="noopener">https://www.jianshu.com/p/bd41f1a1e53d</a></p>
]]></content>
      <categories>
        <category>Java</category>
        <category>ä¸­é—´ä»¶</category>
      </categories>
      <tags>
        <tag>springboot</tag>
        <tag>RabbitMQ</tag>
      </tags>
  </entry>
  <entry>
    <title>Centos7å®‰è£…zookeeperå’ŒWeb UI</title>
    <url>/posts/f2395be.html</url>
    <content><![CDATA[<h2 id="ä¸€ã€zookeeperçš„å®‰è£…">ä¸€ã€zookeeperçš„å®‰è£…</h2>
<h4 id="1ã€zookeeperä»‹ç»">1ã€zookeeperä»‹ç»</h4>
<p>ZooKeeperæ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼çš„ï¼Œå¼€æ”¾æºç çš„åˆ†å¸ƒå¼åº”ç”¨ç¨‹åºåè°ƒæœåŠ¡ï¼Œæ˜¯Googleçš„Chubbyä¸€ä¸ªå¼€æºçš„å®ç°ï¼Œæ˜¯Hadoopå’ŒHbaseçš„é‡è¦ç»„ä»¶ã€‚å®ƒæ˜¯ä¸€ä¸ªä¸ºåˆ†å¸ƒå¼åº”ç”¨æä¾›ä¸€è‡´æ€§æœåŠ¡çš„è½¯ä»¶ï¼Œæä¾›çš„åŠŸèƒ½åŒ…æ‹¬ï¼šé…ç½®ç»´æŠ¤ã€åŸŸåæœåŠ¡ã€åˆ†å¸ƒå¼åŒæ­¥ã€ç»„æœåŠ¡ç­‰ã€‚</p>
<p>ZooKeeperçš„ç›®æ ‡å°±æ˜¯å°è£…å¥½å¤æ‚æ˜“å‡ºé”™çš„å…³é”®æœåŠ¡ï¼Œå°†ç®€å•æ˜“ç”¨çš„æ¥å£å’Œæ€§èƒ½é«˜æ•ˆã€åŠŸèƒ½ç¨³å®šçš„ç³»ç»Ÿæä¾›ç»™ç”¨æˆ·ã€‚</p>
<p>ZooKeeperåŒ…å«ä¸€ä¸ªç®€å•çš„åŸè¯­é›†ï¼Œ [1] æä¾›Javaå’ŒCçš„æ¥å£ã€‚å®˜ç½‘ï¼š<a href="https://zookeeper.apache.org/" target="_blank" rel="noopener">https://zookeeper.apache.org</a></p>
<h4 id="2ã€å®‰è£…ç¯å¢ƒ">2ã€å®‰è£…ç¯å¢ƒ</h4>
<p>Centos7.6 ã€JDK1.8</p>
<a id="more"></a>
<h4 id="3ã€å®‰è£…è¿‡ç¨‹">3ã€å®‰è£…è¿‡ç¨‹</h4>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">wget https://mirrors.tuna.tsinghua.edu.cn/apache/zookeeper/zookeeper-3.6.2/apache-zookeeper-3.6.2-bin.tar.gz</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tar -zxvf apache-zookeeper-3.6.2-bin.tar.gz</span><br></pre></td></tr></table></figure>
<p>è¿›å…¥confæ–‡ä»¶å¤¹<code>cd  apache-zookeeper-3.6.2-bin/conf</code>å°†é…ç½®æ–‡ä»¶å¤åˆ¶ï¼Œè¿™ä¸€æ­¥å¾ˆå…³é”®ï¼Œå¦å¤–æ•´ä¸ªæ–‡ä»¶åå¯ä»¥ä¿®æ”¹ä¸€ä¸‹</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">cp zoo_sample.cfg zoo.cfg</span><br></pre></td></tr></table></figure>
<p>ç„¶ååœ¨æ ¹ç›®å½•æ–°å»º/dataï¼Œå¹¶ä¸”é…ç½®zoo.cfgå…¶ä¸­ä¸¤é¡¹å¦‚ä¸‹(è¿™æ˜¯æˆ‘è‡ªå·±å®šä¹‰çš„è·¯å¾„)</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">dataDir=/data/zookeeper/data</span><br><span class="line">dataLogDir=/data/zookeeper/logs</span><br></pre></td></tr></table></figure>
<p>å¦å¤–zookeeperæ˜¯é»˜è®¤å ç”¨8080ç«¯å£çš„ï¼Œå¦‚æœå¼€äº†tomcatå°±ä¼šæŠ¥é”™ï¼Œæ‰€ä»¥æˆ‘åœ¨é…ç½®æ–‡ä»¶é‡Œæ·»åŠ äº†</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">admin.serverPort=11223</span><br></pre></td></tr></table></figure>
<p>ç„¶åä¿®æ”¹ç¯å¢ƒå˜é‡ <code>vim /etc/profile</code> ï¼Œå®Œæˆå<code>source /etc/profile</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#è¿™é‡Œçš„ZOOKEEPER_HOMEæŒ‡çš„æ˜¯ä½ åˆšåˆšè§£å‹çš„ç›®å½•</span></span><br><span class="line"><span class="comment">#è¿™é‡Œå› ä¸ºæºæ–‡ä»¶åå­—å¤ªé•¿ï¼Œæˆ‘å·²ç»æ›´åmv apache-zookeeper-3.6.2-bin.tar.gz zookeeper</span></span><br><span class="line"><span class="built_in">export</span> ZOOKEEPER_HOME=/root/zookeeper/</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$ZOOKEEPER_HOME</span>/bin:<span class="variable">$PATH</span></span><br></pre></td></tr></table></figure>
<p>å¦å¤–è¿™é‡Œè´´å‡ºzoo.cfgçš„ä¸€äº›é…ç½®ä¿¡æ¯</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># The number of milliseconds of each tick</span></span><br><span class="line"><span class="comment"># tickTimeï¼šCSé€šä¿¡å¿ƒè·³æ•°</span></span><br><span class="line"><span class="comment"># Zookeeper æœåŠ¡å™¨ä¹‹é—´æˆ–å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ä¹‹é—´ç»´æŒå¿ƒè·³çš„æ—¶é—´é—´éš”ï¼Œä¹Ÿå°±æ˜¯æ¯ä¸ª tickTime æ—¶é—´å°±ä¼šå‘é€ä¸€ä¸ªå¿ƒè·³ã€‚tickTimeä»¥æ¯«ç§’ä¸ºå•ä½ã€‚</span></span><br><span class="line">tickTime=2000</span><br><span class="line"></span><br><span class="line"><span class="comment"># The number of ticks that the initial </span></span><br><span class="line"><span class="comment"># synchronization phase can take</span></span><br><span class="line"><span class="comment"># initLimitï¼šLFåˆå§‹é€šä¿¡æ—¶é™</span></span><br><span class="line"><span class="comment"># é›†ç¾¤ä¸­çš„followeræœåŠ¡å™¨(F)ä¸leaderæœåŠ¡å™¨(L)ä¹‹é—´åˆå§‹è¿æ¥æ—¶èƒ½å®¹å¿çš„æœ€å¤šå¿ƒè·³æ•°ï¼ˆtickTimeçš„æ•°é‡ï¼‰ã€‚</span></span><br><span class="line">initLimit=5</span><br><span class="line"></span><br><span class="line"><span class="comment"># The number of ticks that can pass between </span></span><br><span class="line"><span class="comment"># sending a request and getting an acknowledgement</span></span><br><span class="line"><span class="comment"># syncLimitï¼šLFåŒæ­¥é€šä¿¡æ—¶é™</span></span><br><span class="line"><span class="comment"># é›†ç¾¤ä¸­çš„followeræœåŠ¡å™¨ä¸leaderæœåŠ¡å™¨ä¹‹é—´è¯·æ±‚å’Œåº”ç­”ä¹‹é—´èƒ½å®¹å¿çš„æœ€å¤šå¿ƒè·³æ•°ï¼ˆtickTimeçš„æ•°é‡ï¼‰ã€‚</span></span><br><span class="line">syncLimit=2</span><br><span class="line"></span><br><span class="line"><span class="comment"># the directory where the snapshot is stored.</span></span><br><span class="line"><span class="comment"># do not use /tmp for storage, /tmp here is just </span></span><br><span class="line"><span class="comment"># example sakes.</span></span><br><span class="line"><span class="comment"># dataDirï¼šæ•°æ®æ–‡ä»¶ç›®å½•</span></span><br><span class="line"><span class="comment"># Zookeeperä¿å­˜æ•°æ®çš„ç›®å½•ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼ŒZookeeperå°†å†™æ•°æ®çš„æ—¥å¿—æ–‡ä»¶ä¹Ÿä¿å­˜åœ¨è¿™ä¸ªç›®å½•é‡Œã€‚</span></span><br><span class="line">dataDir=/data/soft/zookeeper-3.4.12/data</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># dataLogDirï¼šæ—¥å¿—æ–‡ä»¶ç›®å½•</span></span><br><span class="line"><span class="comment"># Zookeeperä¿å­˜æ—¥å¿—æ–‡ä»¶çš„ç›®å½•ã€‚</span></span><br><span class="line">dataLogDir=/data/soft/zookeeper-3.4.12/logs</span><br><span class="line"></span><br><span class="line"><span class="comment"># the port at which the clients will connect</span></span><br><span class="line"><span class="comment"># clientPortï¼šå®¢æˆ·ç«¯è¿æ¥ç«¯å£</span></span><br><span class="line"><span class="comment"># å®¢æˆ·ç«¯è¿æ¥ Zookeeper æœåŠ¡å™¨çš„ç«¯å£ï¼ŒZookeeper ä¼šç›‘å¬è¿™ä¸ªç«¯å£ï¼Œæ¥å—å®¢æˆ·ç«¯çš„è®¿é—®è¯·æ±‚ã€‚</span></span><br><span class="line">clientPort=2181</span><br><span class="line"></span><br><span class="line"><span class="comment"># the maximum number of client connections.</span></span><br><span class="line"><span class="comment"># increase this if you need to handle more clients</span></span><br><span class="line"><span class="comment">#maxClientCnxns=60</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Be sure to read the maintenance section of the </span></span><br><span class="line"><span class="comment"># administrator guide before turning on autopurge.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># http://zookeeper.apache.org/doc/current/zookeeperAdmin.html#sc_maintenance</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># The number of snapshots to retain in dataDir</span></span><br><span class="line"><span class="comment">#autopurge.snapRetainCount=3</span></span><br><span class="line"><span class="comment"># Purge task interval in hours</span></span><br><span class="line"><span class="comment"># Set to "0" to disable auto purge feature</span></span><br><span class="line"><span class="comment">#autopurge.purgeInterval=1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># æœåŠ¡å™¨åç§°ä¸åœ°å€ï¼šé›†ç¾¤ä¿¡æ¯ï¼ˆæœåŠ¡å™¨ç¼–å·ï¼ŒæœåŠ¡å™¨åœ°å€ï¼ŒLFé€šä¿¡ç«¯å£ï¼Œé€‰ä¸¾ç«¯å£ï¼‰</span></span><br><span class="line"><span class="comment"># è¿™ä¸ªé…ç½®é¡¹çš„ä¹¦å†™æ ¼å¼æ¯”è¾ƒç‰¹æ®Šï¼Œè§„åˆ™å¦‚ä¸‹ï¼š</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># server.N=YYY:A:B  </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å…¶ä¸­Nè¡¨ç¤ºæœåŠ¡å™¨ç¼–å·ï¼ŒYYYè¡¨ç¤ºæœåŠ¡å™¨çš„IPåœ°å€ï¼ŒAä¸ºLFé€šä¿¡ç«¯å£ï¼Œè¡¨ç¤ºè¯¥æœåŠ¡å™¨ä¸é›†ç¾¤ä¸­çš„leaderäº¤æ¢çš„ä¿¡æ¯çš„ç«¯å£ã€‚Bä¸ºé€‰ä¸¾ç«¯å£ï¼Œè¡¨ç¤ºé€‰ä¸¾æ–°leaderæ—¶æœåŠ¡å™¨é—´ç›¸äº’é€šä¿¡çš„ç«¯å£ï¼ˆå½“leaderæŒ‚æ‰æ—¶ï¼Œå…¶ä½™æœåŠ¡å™¨ä¼šç›¸äº’é€šä¿¡ï¼Œé€‰æ‹©å‡ºæ–°çš„leaderï¼‰ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œé›†ç¾¤ä¸­æ¯ä¸ªæœåŠ¡å™¨çš„Aç«¯å£éƒ½æ˜¯ä¸€æ ·ï¼Œæ¯ä¸ªæœåŠ¡å™¨çš„Bç«¯å£ä¹Ÿæ˜¯ä¸€æ ·ã€‚ä½†æ˜¯å½“æ‰€é‡‡ç”¨çš„ä¸ºä¼ªé›†ç¾¤æ—¶ï¼ŒIPåœ°å€éƒ½ä¸€æ ·ï¼Œåªèƒ½æ—¶Aç«¯å£å’ŒBç«¯å£ä¸ä¸€æ ·ã€‚</span></span><br></pre></td></tr></table></figure>
<h4 id="4ã€zookeeperçš„å¸¸ç”¨å‘½ä»¤">4ã€zookeeperçš„å¸¸ç”¨å‘½ä»¤</h4>
<p>è¿›å…¥zookeeperçš„binç›®å½•ä¸‹</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">å¯åŠ¨å‘½ä»¤ï¼š./zkServer.sh start</span><br><span class="line"></span><br><span class="line">åœæ­¢å‘½ä»¤ï¼š./zkServer.sh stopã€€ã€€</span><br><span class="line"></span><br><span class="line">é‡å¯å‘½ä»¤ï¼š./zkServer.sh restart</span><br><span class="line"></span><br><span class="line">çŠ¶æ€æŸ¥çœ‹å‘½ä»¤ï¼š./zkServer.sh status</span><br></pre></td></tr></table></figure>
<h4 id="5ã€å¼€æ”¾ç«¯å£å·">5ã€å¼€æ”¾ç«¯å£å·</h4>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">firewall-cmd --permanent --zone=public --add-port=2181/tcp</span><br><span class="line"><span class="comment">#é‡å¯é˜²ç«å¢™</span></span><br><span class="line">systemctl restart firewalld</span><br><span class="line"><span class="comment">#æŸ¥çœ‹å¼€æ”¾ç«¯å£</span></span><br><span class="line">netstat -ntl</span><br></pre></td></tr></table></figure>
<h2 id="äºŒã€Web-UIå¯è§†åŒ–çš„å®‰è£…">äºŒã€Web-UIå¯è§†åŒ–çš„å®‰è£…</h2>
<h4 id="1ã€Mavençš„å®‰è£…">1ã€Mavençš„å®‰è£…</h4>
<p>è¿™é‡Œéœ€è¦gitå’Œmavenï¼Œgitçš„è¯æœåŠ¡å™¨å¾ˆå¤šå°±æœ‰è‡ªå¸¦ï¼Œå°±ä¸å¤šé˜è¿°äº†ï¼Œè¿™é‡Œæ¥è¯´ä¸€ä¸‹mavençš„å®‰è£…</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">wget http://mirrors.hust.edu.cn/apache/maven/maven-3/3.3.9/binaries/apache-maven-3.3.9-bin.tar.gz</span><br><span class="line">tar -zxvf apache-maven-3.3.9-bin.tar.gz</span><br><span class="line">mv apache-maven-3.3.9 /usr/<span class="built_in">local</span>/maven3</span><br></pre></td></tr></table></figure>
<h4 id="2ã€æ·»åŠ ç¯å¢ƒå˜é‡">2ã€æ·»åŠ ç¯å¢ƒå˜é‡</h4>
<p>å’Œä¸Šé¢æ·»åŠ ä¸€æ ·</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">export</span> M2_HOME=/usr/<span class="built_in">local</span>/maven3</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$JAVA_HOME</span>/bin:<span class="variable">$M2_HOME</span>/bin</span><br></pre></td></tr></table></figure>
<p>å¦‚æœè¾“å…¥<code>mvn -v</code>æœ‰ç»“æœçš„è¯ï¼Œå°±è¯´æ˜å®‰è£…æˆåŠŸäº†</p>
<h4 id="3ã€ç”Ÿæˆzkuiçš„jaråŒ…">3ã€ç”Ÿæˆzkuiçš„jaråŒ…</h4>
<p>é¦–å…ˆä¸‹è½½æºç åŒ…</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://gitee.com/ilanni/zkui.git</span><br></pre></td></tr></table></figure>
<p>è¿›å…¥zkuiç›®å½•åè¿›è¡Œç¼–è¯‘ï¼Œæ„å»ºå’Œæ‰“åŒ…</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mvn clean install</span><br></pre></td></tr></table></figure>
<p>æˆåŠŸåä¼šç”Ÿæˆtargetæ–‡ä»¶å¤¹ï¼Œé‡Œé¢çš„<code>zkui-2.0-SNAPSHOT-jar-with-dependencies.jar</code>å°±æ˜¯æˆ‘ä»¬éœ€è¦çš„æ–‡ä»¶</p>
<h4 id="4ã€å¯åŠ¨jaråŒ…">4ã€å¯åŠ¨jaråŒ…</h4>
<p>å°†ç›®å½•ä¸‹çš„config.cfgæ–‡ä»¶ç§»åŠ¨åˆ°targetç›®å½•ä¸‹ï¼Œç„¶åå¯åŠ¨jaråŒ…ï¼Œé»˜è®¤ç”¨æˆ·åadminï¼Œå¯†ç managerï¼Œç«¯å£9090(æ³¨æ„ç«¯å£çš„å¼€æ”¾)</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">cpzk config.cfg target/config.cfg</span><br><span class="line"><span class="built_in">cd</span> target</span><br><span class="line">java -jar zkui-2.0-SNAPSHOT-jar-with-dependencies.jar</span><br></pre></td></tr></table></figure>
<h2 id="ä¸‰ã€Dubbo-Adminå¯è§†åŒ–å®‰è£…">ä¸‰ã€Dubbo-Adminå¯è§†åŒ–å®‰è£…</h2>
<h4 id="1ã€ä¸‹è½½dubbo-admin">1ã€ä¸‹è½½dubbo-admin</h4>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/apache/dubbo-admin.git</span><br></pre></td></tr></table></figure>
<h4 id="2ã€è®¾ç½®ç«¯å£">2ã€è®¾ç½®ç«¯å£</h4>
<p>åœ¨<code>dubbo-admin\dubbo-admin-server\src\main\resources\application.properties</code>ä¸­</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#### æ·»åŠ ä¸€è¡Œ</span></span><br><span class="line">server.port=8099</span><br></pre></td></tr></table></figure>
<h4 id="3ã€å¿½ç•¥test">3ã€å¿½ç•¥test</h4>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">#### åœ¨rootçš„pom.xmlé‡Œé¢</span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-surefire-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">version</span>&gt;</span>2.21.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">#### æ”¹ä¸ºå¦‚ä¸‹</span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-surefire-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">version</span>&gt;</span>2.21.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">skipTests</span>&gt;</span>true<span class="tag">&lt;/<span class="name">skipTests</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="4ã€æ‰“åŒ…">4ã€æ‰“åŒ…</h4>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#### åœ¨IDEAé‡Œé¢çš„å³è¾¹ç‚¹å¼€Mavenç‚¹å‡»dubbo-adminï¼ˆrootï¼‰</span></span><br><span class="line"><span class="comment">#### å…ˆåæ‰§è¡Œå¦‚ä¸‹2ä¸ªå‘½ä»¤</span></span><br><span class="line">clean</span><br><span class="line">install</span><br></pre></td></tr></table></figure>
<h4 id="5ã€éƒ¨ç½²">5ã€éƒ¨ç½²</h4>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#### å®Œæˆådubbo-admin\dubbo-admin-distribution\targetä¼šæœ‰ä¸ªdubbo-admin-0.1.jar</span></span><br><span class="line"><span class="comment">#### å¯ä»¥éƒ¨ç½²åˆ°æœ¬æœºæˆ–è€…linuxä¸Š</span></span><br><span class="line"> </span><br><span class="line">è¯·ç¡®ä¿zookeeperå·²ç»å¯åŠ¨</span><br><span class="line">java -jar dubbo-admin-0.1.jar</span><br><span class="line">æˆ–è€…åå°è¿è¡Œ</span><br><span class="line">nohup java -jar dubbo-admin-0.1.jar  &gt; dubbo-admin.log  2&gt;&amp;1 &amp;</span><br></pre></td></tr></table></figure>
<br/>
<br/>
<p><a href="https://www.cnblogs.com/h--d/p/10269869.html" target="_blank" rel="noopener">å‚è€ƒæ–‡ç« ä¸€</a></p>
<p><a href="https://www.cnblogs.com/smail-bao/p/7794636.html" target="_blank" rel="noopener">å‚è€ƒæ–‡ç« äºŒ</a></p>
]]></content>
      <categories>
        <category>Java</category>
      </categories>
      <tags>
        <tag>zookeeper</tag>
      </tags>
  </entry>
  <entry>
    <title>javaé€šè¿‡IPè§£æåœ°ç†ä½ç½®</title>
    <url>/posts/3b99ced5.html</url>
    <content><![CDATA[<h2 id="ä¸€ã€é—®é¢˜æè¿°">ä¸€ã€é—®é¢˜æè¿°</h2>
<p>æœ€è¿‘åœ¨åšä¸€ä¸ªå¤–åŒ…é¡¹ç›®ï¼Œè¿™é‡Œè¦æ±‚å¦‚æœå®šä½é«˜å»¶è¿Ÿæ€ä¹ˆåŠï¼Œå¦å¤–ä¸ºäº†èƒ½å¤ŸåŠ é™„è¿‘çš„äººä¸ºå¥½å‹æ–¹ä¾¿ï¼Œæ‰€ä»¥æƒ³åˆ°äº†åˆ©ç”¨ç”¨æˆ·çš„IPè¿›è¡Œç²—ç•¥çš„åœ°ç†ä½ç½®å®šä½ã€‚å› ä¸ºåœ¨å†™çš„æ—¶å€™é‡åˆ°äº†ä¸€äº›å‘ï¼Œæ‰€ä»¥åœ¨è¿™é‡Œç‰¹åˆ«è®°å½•ä¸€ä¸‹ï¼Œæ–¹ä¾¿ä»¥åç¿»é˜…ã€‚</p>
<a id="more"></a>
<h2 id="äºŒã€è·å–è®¿é—®è€…ip">äºŒã€è·å–è®¿é—®è€…ip</h2>
<h5 id="1ã€è·å–ipçš„javaå·¥å…·ç±»">1ã€è·å–ipçš„javaå·¥å…·ç±»</h5>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">IpUtil</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Logger logger = LogManager.getLogger(IpUtil<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">getIpAddr</span><span class="params">(HttpServletRequest request)</span> </span>&#123;</span><br><span class="line">        String ipAddress = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            ipAddress = request.getHeader(<span class="string">"x-forwarded-for"</span>);</span><br><span class="line">            <span class="keyword">if</span> (ipAddress == <span class="keyword">null</span> || ipAddress.length() == <span class="number">0</span> || <span class="string">"unknown"</span>.equalsIgnoreCase(ipAddress)) &#123;</span><br><span class="line">                ipAddress = request.getHeader(<span class="string">"Proxy-Client-IP"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (ipAddress == <span class="keyword">null</span> || ipAddress.length() == <span class="number">0</span> || <span class="string">"unknown"</span>.equalsIgnoreCase(ipAddress)) &#123;</span><br><span class="line">                ipAddress = request.getHeader(<span class="string">"WL-Proxy-Client-IP"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (ipAddress == <span class="keyword">null</span> || ipAddress.length() == <span class="number">0</span> || <span class="string">"unknown"</span>.equalsIgnoreCase(ipAddress)) &#123;</span><br><span class="line">                ipAddress = request.getRemoteAddr();</span><br><span class="line">                <span class="keyword">if</span> (ipAddress.equals(<span class="string">"127.0.0.1"</span>)) &#123;</span><br><span class="line">                    <span class="comment">// æ ¹æ®ç½‘å¡å–æœ¬æœºé…ç½®çš„IP</span></span><br><span class="line">                    InetAddress inet = <span class="keyword">null</span>;</span><br><span class="line">                    <span class="keyword">try</span> &#123;</span><br><span class="line">                        inet = InetAddress.getLocalHost();</span><br><span class="line">                    &#125; <span class="keyword">catch</span> (UnknownHostException e) &#123;</span><br><span class="line">                        logger.error(<span class="string">"è·å–ç”¨æˆ·çš„ä¸»æœºå‘ç”Ÿå¼‚å¸¸"</span>,e);</span><br><span class="line">                    &#125;</span><br><span class="line">                    ipAddress = inet.getHostAddress();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// å¯¹äºé€šè¿‡å¤šä¸ªä»£ç†çš„æƒ…å†µï¼Œç¬¬ä¸€ä¸ªIPä¸ºå®¢æˆ·ç«¯çœŸå®IP,å¤šä¸ªIPæŒ‰ç…§','åˆ†å‰²</span></span><br><span class="line">            <span class="keyword">if</span> (ipAddress != <span class="keyword">null</span> &amp;&amp; ipAddress.length() &gt; <span class="number">15</span>) &#123; <span class="comment">// "***.***.***.***".length()</span></span><br><span class="line">                <span class="comment">// = 15</span></span><br><span class="line">                <span class="keyword">if</span> (ipAddress.indexOf(<span class="string">","</span>) &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                    ipAddress = ipAddress.substring(<span class="number">0</span>, ipAddress.indexOf(<span class="string">","</span>));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            ipAddress=<span class="string">""</span>;</span><br><span class="line">            logger.error(<span class="string">"è·å–ç”¨æˆ·çš„ipåœ°å€å‘ç”Ÿå¼‚å¸¸"</span>,e);</span><br><span class="line">        &#125;</span><br><span class="line">         <span class="comment">//ipAddress = this.getRequest().getRemoteAddr();</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> ipAddress;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="2ã€è·å–å½“å‰çš„ç”¨æˆ·çš„HttpServletRequest">2ã€è·å–å½“å‰çš„ç”¨æˆ·çš„HttpServletRequest</h5>
<p>ä¸€ç§æ–¹æ³•å°±æ˜¯åˆ©ç”¨Controllerå±‚çš„Apiæ¥å£ä¼ è¿›æ¥ï¼Œä½†æ˜¯è¿™æ ·åšå¹¶ä¸æ˜¯ç‰¹åˆ«å¥½ï¼Œæ‰€ä»¥è¿™é‡Œåˆ©ç”¨äº†Springï¼Œè¯¥æ–¹æ³•ç›´æ¥å¯ä»¥åœ¨Serviceè·å¾—å½“å‰çš„ HttpServletRequestï¼Œä½†æ˜¯è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœåˆå¼€äº†ä¸€ä¸ªçº¿ç¨‹çš„è¯ï¼Œä¼šæŠ¥ç©ºæŒ‡é’ˆå¼‚å¸¸ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">HttpServletRequest request = ((ServletRequestAttributes) RequestContextHolder.getRequestAttributes()).getRequest();</span><br></pre></td></tr></table></figure>
<h5 id="3ã€nginxé…ç½®">3ã€nginxé…ç½®</h5>
<p>å½“é¡¹ç›®æ²¡æœ‰é¢å¤–é…ç½®nginxå·²ç»å…¶ä»–æœåŠ¡æ—¶ï¼Œå½“å‰ä»£ç å·²ç»å¯ä»¥è·å¾—è®¿é—®è€…çš„ipï¼Œä½†æ˜¯å¦‚æœé…ç½®äº†ä¾‹å¦‚nginxï¼Œnameå½“éƒ¨ç½²åˆ°æœåŠ¡å™¨ä¸Šæ—¶ï¼Œæ€»æ˜¯ä¼šè¿”å›æœåŠ¡å™¨çš„ipåœ°å€ï¼Œåœ¨è¿™é‡Œæˆ‘æ‰å‘äº†å¥½ä¹…ï¼Œè§£å†³æ–¹æ³•æ˜¯è¿›è¡Œnginxçš„é…ç½®</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">location / &#123;</span><br><span class="line">       // é…ç½®æ­¤å¤„ç”¨äºè·å–å®¢æˆ·ç«¯çš„çœŸå®IP</span><br><span class="line">       proxy_set_header Host <span class="variable">$http_host</span>;</span><br><span class="line">   	proxy_set_header X-Real-IP <span class="variable">$remote_addr</span>;</span><br><span class="line">   	proxy_set_header X-Forwarded-For <span class="variable">$proxy_add_x_forwarded_for</span>;</span><br><span class="line">   	proxy_set_header X-Forwarded-Proto <span class="variable">$scheme</span>;</span><br><span class="line">   	proxy_pass http://localhost:8080;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<h2 id="ä¸‰ã€åˆ©ç”¨IPè§£æåœ°ç†ä½ç½®">ä¸‰ã€åˆ©ç”¨IPè§£æåœ°ç†ä½ç½®</h2>
<p>åœ¨è¿™é‡Œå…¶å®æœ‰å¾ˆå¤šç§æ–¹æ³•äº†ï¼Œå¯ä»¥åˆ©ç”¨ç™¾åº¦çš„APIï¼Œä½†æ˜¯æœ‰é¢åº¦é™åˆ¶ï¼Œåœ¨è¿™é‡Œæˆ‘ç”¨çš„æ˜¯126çš„APIæ¥å£</p>
<p><code>http://ip.ws.126.net/ipquery?ip=IP</code></p>
<p>å› ä¸º126æ¥å£æ— æ³•è§£ææˆJSONæ ¼å¼ï¼Œæ‰€ä»¥åªèƒ½è‡ªå·±å†™ä»£ç è¿›è¡ŒStringçš„æ‹†è§£ã€‚é¦–å…ˆè¿›è¡Œæ¥å£çš„è®¿é—®</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">RestTemplate restTemplate=<span class="keyword">new</span> RestTemplate();</span><br><span class="line">       Map&lt;String,String&gt; params=<span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">       params.put(<span class="string">"ip"</span>,ip);  <span class="comment">//</span></span><br><span class="line">       ResponseEntity&lt;String&gt; responseEntity=restTemplate.getForEntity(<span class="string">"http://ip.ws.126.net/ipquery?ip=&#123;ip&#125;"</span>,String<span class="class">.<span class="keyword">class</span>,<span class="title">params</span>)</span>;</span><br><span class="line"></span><br><span class="line">       <span class="comment">// å­—ç¬¦ä¸²è§£æ</span></span><br><span class="line">       String resultStr = responseEntity.getBody().trim();</span><br><span class="line">       <span class="keyword">int</span> provinceNum = resultStr.indexOf(<span class="string">"lo"</span>) +<span class="number">4</span> ;</span><br><span class="line">       <span class="keyword">int</span> cityNum = resultStr.indexOf(<span class="string">"lc"</span>)  +<span class="number">4</span>;</span><br><span class="line">       String province = resultStr.trim().substring(provinceNum,provinceNum+<span class="number">3</span>);</span><br><span class="line">       String city = resultStr.trim().substring(cityNum,cityNum+<span class="number">3</span>);</span><br></pre></td></tr></table></figure>
<br/>
<br/>
<br/>
<p><a href="https://blog.csdn.net/weixin_42686556/article/details/81948418?depth_1-utm_source=distribute.pc_relevant.none-task&amp;utm_source=distribute.pc_relevant.none-task" target="_blank" rel="noopener">å‚è€ƒæ–‡ç« </a></p>
]]></content>
      <categories>
        <category>Java</category>
      </categories>
      <tags>
        <tag>IPè§£æ</tag>
      </tags>
  </entry>
  <entry>
    <title>ubuntu16.04ä¸‹dockerçš„å…¥é—¨å­¦ä¹ </title>
    <url>/posts/9188f990.html</url>
    <content><![CDATA[<h2 id="ä¸€ã€è™šæ‹Ÿæœº">ä¸€ã€è™šæ‹Ÿæœº</h2>
<p>è¿™é‡Œæˆ‘ä½¿ç”¨çš„æ˜¯VMWare 15çš„è™šæ‹Ÿæœºè½¯ä»¶ï¼ŒLinuxç‰ˆæœ¬ä½¿ç”¨äº†ubuntu16.04 TLEç‰ˆæœ¬ï¼Œå»ºè®®å»é˜¿é‡Œäº‘ä¸‹è½½ubuntuçš„é•œåƒï¼Œå¯åŠ¨åé»˜è®¤å°±å¯ä»¥äº†ï¼Œä¹‹åæ‰€æœ‰çš„æ“ä½œéƒ½ä»¥æœ€é«˜æƒé™æ“ä½œï¼Œè¾“å…¥<code>sudo su</code>è¿›è¡Œåˆ‡æ¢ã€‚ä¸è¿‡è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯åˆšå¼€å§‹ç³»ç»Ÿçš„aptæºæ˜¯å›½å¤–çš„ï¼Œæ‰€ä»¥ä½¿ç”¨<code>apt update</code>æ—¶ä¼šæŠ¥é”™ï¼Œæ‰€ä»¥éœ€è¦åœ¨è®¾ç½®é‡Œå…ˆä¿®æ”¹åˆ°å›½å†…æºã€‚åé¢ä¹Ÿå¯ä»¥è¿›å…¥<code>/etc/apt/source.list</code>ä¸‹è¿›è¡Œå›½å†…æºçš„æ·»åŠ ï¼Œè¿™äº›ç½‘ä¸Šæœ‰å¾ˆå¤šï¼Œè¿™é‡Œå°±ä¸é˜è¿°äº†ã€‚</p>
<a id="more"></a>
<h2 id="äºŒã€docker-çš„å®‰è£…">äºŒã€docker çš„å®‰è£…</h2>
<h5 id="1ã€æ›´æ–°aptåº“">1ã€æ›´æ–°aptåº“</h5>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt update</span><br></pre></td></tr></table></figure>
<h5 id="2ã€ä»¥ä¸‹å®‰è£…ä½¿å¾—å…è®¸apté€šè¿‡HTTPSä½¿ç”¨å­˜å‚¨åº“">2ã€ä»¥ä¸‹å®‰è£…ä½¿å¾—å…è®¸apté€šè¿‡HTTPSä½¿ç”¨å­˜å‚¨åº“</h5>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt install apt-transport-https ca-certificates curl software-properties-common</span><br></pre></td></tr></table></figure>
<h5 id="3ã€æ·»åŠ é˜¿é‡ŒGPGç§˜é’¥">3ã€æ·»åŠ é˜¿é‡ŒGPGç§˜é’¥</h5>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">curl -fsSL https://mirrors.aliyun.com/docker-ce/linux/ubuntu/gpg | sudo apt-key add -</span><br></pre></td></tr></table></figure>
<!-- more-->
<h5 id="4ã€æ·»åŠ é˜¿é‡Œdockeræº">4ã€æ·»åŠ é˜¿é‡Œdockeræº</h5>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo add-apt-repository <span class="string">"deb [arch=amd64] https://mirrors.aliyun.com/docker-ce/linux/ubuntu <span class="variable">$(lsb_release -cs)</span> stable"</span></span><br></pre></td></tr></table></figure>
<h5 id="5ã€æ›´æ–°aptæº">5ã€æ›´æ–°aptæº</h5>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt-get update</span><br></pre></td></tr></table></figure>
<h5 id="6ã€å®‰è£…">6ã€å®‰è£…</h5>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt install -y docker-ce</span><br></pre></td></tr></table></figure>
<h5 id="7ã€æŸ¥çœ‹ç‰ˆæœ¬">7ã€æŸ¥çœ‹ç‰ˆæœ¬</h5>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">docker --version</span><br></pre></td></tr></table></figure>
<p>å¦‚æœæˆåŠŸå®‰è£…å°±ä¼šæ˜¾ç¤ºdockerçš„ç‰ˆæœ¬å·ï¼Œå¦å¤–ï¼Œä¸ºäº†åŠ å¿«dockeré•œåƒçš„æ‹‰å–ï¼Œæˆ‘ä»¬ä¹Ÿéœ€è¦ä¿®æ”¹dockeræº</p>
<h5 id="8ã€æ›´æ¢dockeræº">8ã€æ›´æ¢dockeræº</h5>
<p>ä»¥ä¸‹æ˜¯å›½å†…å¯ç”¨çš„é•œåƒæº</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Docker å®˜æ–¹ä¸­å›½åŒºï¼šhttps://registry.docker-cn.com</span><br><span class="line">ç½‘æ˜“ï¼šhttp://hub-mirror.c.163.com</span><br><span class="line">ä¸­å›½ç§‘æŠ€å¤§å­¦ï¼šhttps://docker.mirrors.ustc.edu.cn</span><br><span class="line">é˜¿é‡Œäº‘ï¼šhttps://y0qd3iq.mirror.aliyuncs.com</span><br></pre></td></tr></table></figure>
<p>å¢åŠ Dockerçš„é•œåƒæºé…ç½®æ–‡ä»¶ /etc/docker/daemon.jsonï¼Œå¦‚æœæ²¡æœ‰é…ç½®è¿‡é•œåƒè¯¥æ–‡ä»¶é»˜è®¤æ˜¯ä¸å­˜çš„ï¼Œåœ¨å…¶ä¸­å¢åŠ å¦‚ä¸‹å†…å®¹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"registry-mirrors"</span>: [<span class="string">"https://y0qd3iq.mirror.aliyuncs.com"</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å…¶ä¸­çš„URLå°±æ˜¯æŒ‡å®šçš„é•œåƒæºï¼Œå¯ä»¥å°†å…¶è®¾ç½®ä¸ºä¸Šé¢è¯´çš„å››ä¸ªé•œåƒæºä¸­çš„ä»»ä½•ä¸€ä¸ªã€‚</p>
<p>ç„¶åé‡å¯DockeræœåŠ¡ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">service docker restart</span><br></pre></td></tr></table></figure>
<p>ç„¶åé€šè¿‡ä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹é…ç½®æ˜¯å¦ç”Ÿæ•ˆï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">docker info|grep Mirrors -A 1</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°å¦‚ä¸‹çš„è¾“å‡ºï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Registry Mirrors:</span><br><span class="line"> https://y0qd3iq.mirror.aliyuncs.com/</span><br></pre></td></tr></table></figure>
<p>å°±è¡¨ç¤ºé•œåƒé…ç½®æˆåŠŸï¼Œç„¶åå†æ‰§è¡Œdocker pullæ“ä½œï¼Œå°±ä¼šå¾ˆå¿«äº†ã€‚å¯ä»¥ä½¿ç”¨ <code>docker run hello-world</code> æ¥éªŒè¯æ˜¯å¦æˆåŠŸ</p>
<h2 id="ä¸‰ã€dockerå¸¸ç”¨å‘½ä»¤">ä¸‰ã€dockerå¸¸ç”¨å‘½ä»¤</h2>
<h5 id="1ã€æŸ¥çœ‹docker-å½“å‰ç‰ˆæœ¬">1ã€æŸ¥çœ‹docker å½“å‰ç‰ˆæœ¬</h5>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">docker version</span><br></pre></td></tr></table></figure>
<h5 id="2ã€å¯åŠ¨ä¸åœæ­¢">2ã€å¯åŠ¨ä¸åœæ­¢</h5>
<p>å®‰è£…å®ŒæˆDockeråï¼Œé»˜è®¤å·²ç»å¯åŠ¨äº†dockeræœåŠ¡ï¼Œå¦‚éœ€æ‰‹åŠ¨æ§åˆ¶dockeræœåŠ¡çš„å¯åœï¼Œå¯æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å¯åŠ¨docker</span></span><br><span class="line">sudo service docker start</span><br><span class="line"><span class="comment"># åœæ­¢docker</span></span><br><span class="line">sudo service docker stop</span><br><span class="line"><span class="comment"># é‡å¯docker</span></span><br><span class="line">sudo service docker restart</span><br></pre></td></tr></table></figure>
<h5 id="3ã€æŸ¥çœ‹æ‰€æœ‰é•œåƒ">3ã€æŸ¥çœ‹æ‰€æœ‰é•œåƒ</h5>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo docker image ls</span><br><span class="line">sudo docker image ls --all</span><br></pre></td></tr></table></figure>
<ul>
<li>REPOSITORYï¼šé•œåƒæ‰€åœ¨çš„ä»“åº“åç§°</li>
<li>TAGï¼šé•œåƒæ ‡ç­¾</li>
<li>IMAGEIDï¼šé•œåƒID</li>
<li>CREATEDï¼šé•œåƒçš„åˆ›å»ºæ—¥æœŸ(ä¸æ˜¯è·å–è¯¥é•œåƒçš„æ—¥æœŸ)</li>
<li>SIZEï¼šé•œåƒå¤§å°</li>
</ul>
<h5 id="4ã€æ‹‰å–é•œåƒ">4ã€æ‹‰å–é•œåƒ</h5>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo docker image pull é•œåƒåç§°:ç‰ˆæœ¬å· <span class="comment"># ä¸æŒ‡å®šç‰ˆæœ¬é»˜è®¤ä¸ºæœ€æ–°ç‰ˆ</span></span><br><span class="line"><span class="comment">#ä¸¾ä¾‹</span></span><br><span class="line">sudo docker image pull library/hello-world</span><br></pre></td></tr></table></figure>
<h5 id="5ã€åˆ é™¤é•œåƒ">5ã€åˆ é™¤é•œåƒ</h5>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo docker image rm é•œåƒåç§°/é•œåƒID</span><br></pre></td></tr></table></figure>
<h5 id="6ã€åˆ›å»ºå®¹å™¨-å¿…é¡»ç°æœ‰é•œåƒï¼Œæ‰èƒ½åˆ›å»ºè¿è¡Œå®¹å™¨">6ã€åˆ›å»ºå®¹å™¨(å¿…é¡»ç°æœ‰é•œåƒï¼Œæ‰èƒ½åˆ›å»ºè¿è¡Œå®¹å™¨)</h5>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo docker run [option] é•œåƒå [å‘å¯åŠ¨å®¹å™¨ä¸­ä¼ å…¥çš„å‘½ä»¤] <span class="comment"># åˆ›å»ºå®¹å™¨</span></span><br></pre></td></tr></table></figure>
<p>å¸¸ç”¨å¯é€‰å‚æ•°è¯´æ˜ï¼š</p>
<ul>
<li>-i è¡¨ç¤ºä»¥â€œäº¤äº’æ¨¡å¼â€è¿è¡Œå®¹å™¨</li>
<li>-t è¡¨ç¤ºå®¹å™¨å¯åŠ¨åä¼šè¿›å…¥å…¶å‘½ä»¤è¡Œã€‚åŠ å…¥è¿™ä¸¤ä¸ªå‚æ•°åï¼Œå®¹å™¨åˆ›å»ºå°±èƒ½ç™»å½•è¿›å»ã€‚å³ åˆ†é…ä¸€ä¸ªä¼ªç»ˆç«¯ã€‚</li>
<li>â€“name ä¸ºåˆ›å»ºçš„å®¹å™¨å‘½å</li>
<li>-v è¡¨ç¤ºç›®å½•æ˜ å°„å…³ç³»(å‰è€…æ˜¯å®¿ä¸»æœºç›®å½•ï¼Œåè€…æ˜¯æ˜ å°„åˆ°å®¿ä¸»æœºä¸Šçš„ç›®å½•ï¼Œå³ å®¿ä¸»æœºç›®å½•:å®¹å™¨ä¸­ç›®å½•)ï¼Œå¯ä»¥ä½¿ ç”¨å¤šä¸ª-v åšå¤šä¸ªç›®å½•æˆ–æ–‡ä»¶æ˜ å°„ã€‚æ³¨æ„:æœ€å¥½åšç›®å½•æ˜ å°„ï¼Œåœ¨å®¿ä¸»æœºä¸Šåšä¿®æ”¹ï¼Œç„¶å å…±äº«åˆ°å®¹å™¨ä¸Šã€‚</li>
<li>-d åœ¨runåé¢åŠ ä¸Š-då‚æ•°,åˆ™ä¼šåˆ›å»ºä¸€ä¸ªå®ˆæŠ¤å¼å®¹å™¨åœ¨åå°è¿è¡Œ(è¿™æ ·åˆ›å»ºå®¹å™¨åä¸ ä¼šè‡ªåŠ¨ç™»å½•å®¹å™¨ï¼Œå¦‚æœåªåŠ -i -t ä¸¤ä¸ªå‚æ•°ï¼Œåˆ›å»ºåå°±ä¼šè‡ªåŠ¨è¿›å»å®¹å™¨)ã€‚</li>
<li>-p è¡¨ç¤ºç«¯å£æ˜ å°„ï¼Œå‰è€…æ˜¯å®¿ä¸»æœºç«¯å£ï¼Œåè€…æ˜¯å®¹å™¨å†…çš„æ˜ å°„ç«¯å£ã€‚å¯ä»¥ä½¿ç”¨å¤šä¸ª-p åšå¤šä¸ªç«¯å£æ˜ å°„</li>
<li>-e ä¸ºå®¹å™¨è®¾ç½®ç¯å¢ƒå˜é‡</li>
<li>â€“network=host è¡¨ç¤ºå°†ä¸»æœºçš„ç½‘ç»œç¯å¢ƒæ˜ å°„åˆ°å®¹å™¨ä¸­ï¼Œå®¹å™¨çš„ç½‘ç»œä¸ä¸»æœºç›¸åŒ</li>
<li>-it åˆ›å»ºä¸€ä¸ªä¼ªç»ˆç«¯äº¤äº’ç•Œé¢ï¼ŒnameæŒ‡å®šå®¹å™¨åç§°</li>
</ul>
<h5 id="7ã€æŸ¥çœ‹æ‰€æœ‰å®¹å™¨">7ã€æŸ¥çœ‹æ‰€æœ‰å®¹å™¨</h5>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo docker container ls <span class="comment">#æŸ¥çœ‹æ‰€æœ‰æ­£åœ¨è¿è¡Œçš„å®¹å™¨</span></span><br><span class="line">sodu docker ps</span><br><span class="line">sudo docker container ls --all <span class="comment"># æŸ¥çœ‹æ‰€æœ‰å·²åˆ›å»ºçš„å®¹å™¨</span></span><br><span class="line">sudo docker ps -a</span><br></pre></td></tr></table></figure>
<p>æŸ¥çœ‹å®¹å™¨</p>
<ul>
<li>container id å®¹å™¨id</li>
<li>image é•œåƒåç§°</li>
<li>command åˆ›å»ºåè¿è¡Œçš„å‘½ä»¤</li>
<li>created åˆ›å»ºæ—¶é—´</li>
<li>status å…³é—­æ—¶é—´</li>
<li>ports ç»‘å®šçš„ç«¯å£</li>
<li>names å®¹å™¨åç§°</li>
</ul>
<h5 id="8ã€åˆ›å»ºä¸€ä¸ªå®ˆæŠ¤å¼å®¹å™¨">8ã€åˆ›å»ºä¸€ä¸ªå®ˆæŠ¤å¼å®¹å™¨</h5>
<p>å¦‚æœå¯¹äºä¸€ä¸ªéœ€è¦é•¿æœŸè¿è¡Œçš„å®¹å™¨æ¥è¯´ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªå®ˆæŠ¤å¼å®¹å™¨ã€‚åœ¨å®¹å™¨å†…éƒ¨exité€€å‡ºæ—¶ï¼Œå®¹å™¨ä¹Ÿä¸ä¼šåœæ­¢ã€‚å³æ­£å¸¸æ¥è¯´ï¼Œè¿›å…¥äº¤äº’ä¼ªç»ˆç«¯åè¾“å…¥exitå®¹å™¨ä¹Ÿä¼šå¯¹åº”å…³é—­ï¼Œä½†æ˜¯åŠ äº†-d å†…éƒ¨ä½¿ç”¨exitä¹Ÿä¸ä¼šç»“æŸè¿è¡Œ</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">sudo docker run -dit --name&#x3D;ubuntu2 ubuntu &#x2F;bin&#x2F;bash</span><br></pre></td></tr></table></figure>
<h5 id="9ã€è¿è¡Œå·²ç»å¼€å¯çš„å®¹å™¨">9ã€è¿è¡Œå·²ç»å¼€å¯çš„å®¹å™¨</h5>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo docker container <span class="built_in">exec</span> -it &lt;å®¹å™¨å/id&gt; &lt;è¿è¡Œåä½¿ç”¨çš„ç¬¬ä¸€ä¸ªå‘½ä»¤&gt;</span><br><span class="line"><span class="comment"># è¿è¡Œä½¿ç”¨çš„ç¬¬ä¸€ä¸ªå‘½ä»¤ä¸€èˆ¬é»˜è®¤ä¸º /bin/bash å¦åˆ™æ— æ³•è¿›å…¥äº¤äº’ç•Œé¢</span></span><br></pre></td></tr></table></figure>
<h5 id="10ã€åœæ­¢ä¸å¯åŠ¨å®¹å™¨">10ã€åœæ­¢ä¸å¯åŠ¨å®¹å™¨</h5>
<p>Container å¯ä»¥çœç•¥</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># åœæ­¢ä¸€ä¸ªå·²ç»åœ¨è¿è¡Œçš„å®¹å™¨</span></span><br><span class="line">sudo docker container stop å®¹å™¨åæˆ–å®¹å™¨id</span><br><span class="line"><span class="comment"># å¯åŠ¨ä¸€ä¸ªå·²ç»åœæ­¢çš„å®¹å™¨</span></span><br><span class="line">sudo docker container start å®¹å™¨åæˆ–å®¹å™¨id</span><br><span class="line"><span class="comment"># killæ‰ä¸€ä¸ªå·²ç»åœ¨è¿è¡Œçš„å®¹å™¨</span></span><br><span class="line">sudo docker container <span class="built_in">kill</span> å®¹å™¨å</span><br></pre></td></tr></table></figure>
<h5 id="11ã€åˆ é™¤å®¹å™¨">11ã€åˆ é™¤å®¹å™¨</h5>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo docker container rm å®¹å™¨åæˆ–å®¹å™¨id</span><br></pre></td></tr></table></figure>
<h2 id="å››ã€å…¥é—¨ï¼ˆåˆ›å»ºè‡ªå·±çš„dockerï¼‰">å››ã€å…¥é—¨ï¼ˆåˆ›å»ºè‡ªå·±çš„dockerï¼‰</h2>
<h5 id="1ã€å»ºç«‹ä¸€ä¸ªCæ–‡ä»¶ï¼Œå¦‚ä¸‹ï¼š">1ã€å»ºç«‹ä¸€ä¸ªCæ–‡ä»¶ï¼Œå¦‚ä¸‹ï¼š</h5>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#include &lt;stdio.h&gt;</span></span><br><span class="line">void <span class="function"><span class="title">main</span></span>() &#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"Hello World, this is my first docker image!\n"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="2ã€ç¼–è¯‘">2ã€ç¼–è¯‘</h5>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gcc demo.c -o demo -static</span><br></pre></td></tr></table></figure>
<p>ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶demo <strong>ä¸€å®šè¦é™æ€ç¼–è¯‘ï¼Œå¦åˆ™ä¼šæ‰¾ä¸åˆ°å¯¹åº”çš„åº“ï¼ŒæŠ¥é”™</strong></p>
<h5 id="3ã€ç¼–è¾‘ä¸€ä¸ªDockerfile">3ã€ç¼–è¾‘ä¸€ä¸ªDockerfile</h5>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">FROM scratch</span><br><span class="line"></span><br><span class="line">ADD demo /</span><br><span class="line"></span><br><span class="line">CMD [<span class="string">"/demo"</span>]</span><br></pre></td></tr></table></figure>
<p>ç„¶åæŠŠdemoå’ŒDockerfileéƒ½æ”¾åœ¨ä¸€ä¸ªç›®å½•ä¸‹</p>
<h5 id="4ã€è¿›è¡Œdockerçš„ç”Ÿæˆ">4ã€è¿›è¡Œdockerçš„ç”Ÿæˆ</h5>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo docker build -t hello:0.1 .</span><br></pre></td></tr></table></figure>
<p>hello:0.1æ˜¯åç§°å’ŒTagï¼Œåé¢çš„ã€€.ã€€è¡¨ç¤ºå½“å‰ç›®å½•</p>
<h5 id="5ã€è¿è¡Œ">5ã€è¿è¡Œ</h5>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">docker run hello:0.1</span><br></pre></td></tr></table></figure>
<h2 id="äº”ã€ä¸¾ä¾‹ï¼ˆåŸºäºubuntuåˆ›å»ºpython3-8é•œåƒï¼‰">äº”ã€ä¸¾ä¾‹ï¼ˆåŸºäºubuntuåˆ›å»ºpython3.8é•œåƒï¼‰</h2>
<h5 id="1ã€ä¸‹è½½ubuntu16-04åŸºç¡€é•œåƒ">1ã€ä¸‹è½½ubuntu16.04åŸºç¡€é•œåƒ</h5>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">docker pull ubuntu:16.04</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/20201114131659809.png#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h5 id="2ã€è¿è¡Œå®¹å™¨">2ã€è¿è¡Œå®¹å™¨</h5>
<p>è¿™é‡Œiæ˜¯æŒ‡è¿›å…¥äº¤äº’ç¯å¢ƒï¼ŒtæŒ‡è¿›å…¥ç»ˆç«¯ ï¼Œ væŒ‡çš„æ˜¯å®¹å™¨å†…è·¯å¾„æ˜ å°„åˆ°å®¿ä¸»æœºçš„æŸä¸€è·¯å¾„ ï¼Œæ­¤æ—¶PWDæˆ‘çš„å½“å‰ç›®å½•å·²ç»æŒ‚è½½åˆ°å®¹å™¨çš„/home/root123ç›®å½•ä¸‹äº†</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">docker run -it -v <span class="variable">$PWD</span>:/home/root123 ubuntu:16.04 /bin/bash</span><br></pre></td></tr></table></figure>
<h5 id="3ã€å®‰è£…åŸºæœ¬ç»„ä»¶">3ã€å®‰è£…åŸºæœ¬ç»„ä»¶</h5>
<p>åœ¨è¿™é‡Œæœ‰å¯èƒ½è‡ªå¸¦çš„aptæºè¿˜æ˜¯å›½å¤–çš„ï¼Œè€Œä¸”æ²¡æœ‰vi/vimå¯ç¼–è¾‘è½¯ä»¶ï¼Œæ‰€ä»¥è¿™é‡Œç”¨äº†echoç›´æ¥æ›´æ–°æº</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mv /etc/apt/sources.list /etc/apt/sources.list.bak</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"deb http://mirrors.163.com/debian/ jessie main non-free contrib"</span> &gt;&gt; /etc/apt/sources.list</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"deb http://mirrors.163.com/debian/ jessie-proposed-updates main non-free contrib"</span> &gt;&gt;/etc/apt/sources.list</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"deb-src http://mirrors.163.com/debian/ jessie main non-free contrib"</span> &gt;&gt;/etc/apt/sources.list</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"deb-src http://mirrors.163.com/debian/ jessie-proposed-updates main non-free contrib"</span> &gt;&gt;/etc/apt/sources.list</span><br></pre></td></tr></table></figure>
<p>åœ¨è¿™é‡Œå¯èƒ½å­˜åœ¨æºçš„é—®é¢˜(æˆ‘åœ¨è¿™é‡Œå¡äº†å¥½ä¹…ï¼Œå“­)ï¼Œå¯ä»¥è¿›å…¥/etc/apt/sources.listè¿›è¡Œæºçš„æ›´æ¢</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#é˜¿é‡Œäº‘</span></span><br><span class="line">deb http://mirrors.aliyun.com/ubuntu/ xenial main restricted universe multiverse</span><br><span class="line">deb http://mirrors.aliyun.com/ubuntu/ xenial-updates main restricted universe multiverse</span><br><span class="line">deb http://mirrors.aliyun.com/ubuntu/ xenial-backports main restricted universe multiverse</span><br><span class="line">deb http://mirrors.aliyun.com/ubuntu/ xenial-security main restricted universe multiverse</span><br></pre></td></tr></table></figure>
<p>ä¹‹åä¾æ¬¡æ‰§è¡Œ</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">apt update</span><br><span class="line"></span><br><span class="line">apt install vim	<span class="comment">#å®‰è£…vim</span></span><br><span class="line"></span><br><span class="line">apt install gcc</span><br></pre></td></tr></table></figure>
<p>å®‰è£…pythonè¦çš„åŸºç¡€åŒ…</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">apt-get install zlib1g-dev libbz2-dev libssl-dev libncurses5-dev libsqlite3-dev libreadline-dev tk-dev libgdbm-dev libdb-dev libpcap-dev xz-utils libexpat1-dev</span><br><span class="line"></span><br><span class="line">apt-get install liblzma-dev libffi-dev libc6-dev</span><br></pre></td></tr></table></figure>
<p>è§£å‹pythonæºç åŒ…ï¼Œå¯ä»¥å»å®˜ç½‘ä¸Šä¸‹è½½ï¼Œè¿™é‡Œè¿›è¡Œç¼–è¯‘å®‰è£…</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tar -zxvf Python-3.8.1.tgz</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">./configure -â€“with-ssl --prefix=/usr/<span class="built_in">local</span>/python3 --<span class="built_in">enable</span>-optimizations</span><br><span class="line"></span><br><span class="line">make</span><br><span class="line"></span><br><span class="line">make install</span><br></pre></td></tr></table></figure>
<p>è¿›è¡Œé“¾æ¥ï¼Œç›¸å½“äºwindowsçš„å¿«æ·æ–¹å¼</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ln -s /usr/<span class="built_in">local</span>/python3/bin/python3.8 /usr/bin/python3</span><br><span class="line"></span><br><span class="line">ln -s /usr/<span class="built_in">local</span>/python3/bin/pip3.8 /usr/bin/pip3</span><br></pre></td></tr></table></figure>
<h5 id="4ã€å®šåˆ¶æˆ‘ä»¬çš„å®¹å™¨é•œåƒ">4ã€å®šåˆ¶æˆ‘ä»¬çš„å®¹å™¨é•œåƒ</h5>
<figure class="highlight dockerfile"><table><tr><td class="code"><pre><span class="line">docker container ls -a   <span class="comment">#æŸ¥çœ‹æ‰€æœ‰å®¹å™¨</span></span><br></pre></td></tr></table></figure>
<p>docker commit [OPTIONS] CONTAINER [REPOSITORY[:TAG]]</p>
<p>OPTIONSè¯´æ˜ï¼š</p>
<p>-a :æäº¤çš„é•œåƒä½œè€…ï¼›</p>
<p>-c :ä½¿ç”¨DockerfileæŒ‡ä»¤æ¥åˆ›å»ºé•œåƒï¼›</p>
<p>-m :æäº¤æ—¶çš„è¯´æ˜æ–‡å­—ï¼›</p>
<p>-p :åœ¨commitæ—¶ï¼Œå°†å®¹å™¨æš‚åœã€‚</p>
<figure class="highlight dockerfile"><table><tr><td class="code"><pre><span class="line">docker commit -m <span class="string">"add vim&amp;source"</span> -a <span class="string">"author"</span> <span class="number">1</span>db56d541f2c python:<span class="number">1.0</span></span><br><span class="line"><span class="comment">#å®Œæˆåè¾“å…¥ä¸€ä¸‹å³å¯çœ‹è§æ–°çš„é•œåƒ</span></span><br><span class="line">docker images</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/20201114131730155.png#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h5 id="5ã€ä¿å­˜imageå’Œcontainerå®¹å™¨">5ã€ä¿å­˜imageå’Œcontainerå®¹å™¨</h5>
<p>imageä¿å­˜ä¸ºæ–‡ä»¶</p>
<figure class="highlight dockerfile"><table><tr><td class="code"><pre><span class="line">docker save -o python.tar python:<span class="number">1.0</span></span><br></pre></td></tr></table></figure>
<p>imageè£…è½½</p>
<figure class="highlight dockerfile"><table><tr><td class="code"><pre><span class="line">docker load -input python.tar</span><br></pre></td></tr></table></figure>
<p>å®¹å™¨å¯¼å‡ºï¼š</p>
<figure class="highlight dockerfile"><table><tr><td class="code"><pre><span class="line">docker export -o python-export.tar c70bf6d6ca45 <span class="comment">#è¿™æ˜¯å®¹å™¨çš„id</span></span><br></pre></td></tr></table></figure>
<p>å®¹å™¨å¯¼å…¥ï¼š</p>
<figure class="highlight dockerfile"><table><tr><td class="code"><pre><span class="line">docker import python-export.tar python:v1.<span class="number">0</span></span><br></pre></td></tr></table></figure>
<h6 id="æ³¨æ„ï¼šsaveå’Œloadæ˜¯ä¸€å¯¹ï¼Œexportå’Œimportæ˜¯ä¸€å¯¹">æ³¨æ„ï¼šsaveå’Œloadæ˜¯ä¸€å¯¹ï¼Œexportå’Œimportæ˜¯ä¸€å¯¹</h6>
]]></content>
      <categories>
        <category>äº‘è®¡ç®—</category>
      </categories>
      <tags>
        <tag>docker</tag>
      </tags>
  </entry>
  <entry>
    <title>ä½¿ç”¨ideaæ­å»ºspringboot initializeræœåŠ¡å™¨</title>
    <url>/posts/55d4cd20.html</url>
    <content><![CDATA[<h3 id="é—®é¢˜æè¿°">é—®é¢˜æè¿°</h3>
<p>æœ€è¿‘æˆ‘åœ¨æ­å»ºspringbooté¡¹ç›®æ—¶ï¼Œè¿æ¥å…¬å¸ç½‘çº¿æ—¶å‘ç°ideaä¸€ç›´æ–°å»ºä¸äº†é¡¹ç›®ï¼Œæµè§ˆå™¨è®¿é—®<a href="https://start.spring.io/" target="_blank" rel="noopener">https://start.spring.io</a>ä¹Ÿè®¿é—®ä¸äº†ï¼Œä½†æ˜¯è‡ªå·±æ‰‹æœºçƒ­ç‚¹æ˜¯å¯ä»¥æ­£å¸¸è®¿é—®çš„ï¼ŒçŒœæƒ³æ˜¯è¢«æ‹¦æˆªäº†ï¼Œæ‰€ä»¥ä¸ºäº†æ–¹ä¾¿ï¼Œå‚è€ƒç½‘ä¸Šæ•™ç¨‹ï¼Œæˆ‘æ‰“ç®—åœ¨è‡ªå·±çš„æœåŠ¡å™¨ä¸Šæ­å»ºæœåŠ¡ï¼Œåœ¨è¿™é‡Œæˆ‘çš„æœåŠ¡å™¨æ˜¯Centos7.6</p>
<a id="more"></a>
<h3 id="æ­å»ºè¿‡ç¨‹">æ­å»ºè¿‡ç¨‹</h3>
<p>é¦–å…ˆä¸‹è½½é¡¹ç›®ï¼Œç»ˆç«¯æ‰§è¡Œ</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git clone https:&#x2F;&#x2F;github.com&#x2F;spring-io&#x2F;initializr.git</span><br></pre></td></tr></table></figure>
<p>å¦‚æœæ²¡æœ‰git ï¼Œé‚£ä¹ˆéœ€è¦å…ˆè¿›è¡Œå®‰è£…</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">sudo yum install git</span><br></pre></td></tr></table></figure>
<p>å¦å¤–é¡¹ç›®ä¾èµ–mavenï¼Œæ‰€ä»¥è¦é¦–å…ˆç¡®ä¿è®¡ç®—æœºä¸Šå®‰è£…æœ‰mavenç¯å¢ƒã€‚å¦‚æœæ²¡æœ‰mavenï¼Œåˆ™æ‰§è¡Œ</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">wget http:&#x2F;&#x2F;mirrors.tuna.tsinghua.edu.cn&#x2F;apache&#x2F;maven&#x2F;maven-3&#x2F;3.5.4&#x2F;binaries&#x2F;apache-maven-3.5.4-bin.tar.gz</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">tar -zxvf apache-maven-3.5.4-bin.tar.gz</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">sudo update-alternatives --install &#x2F;usr&#x2F;bin&#x2F;mvn mvn &#x2F;root&#x2F;apache-maven-3.5.4&#x2F;bin&#x2F;mvn 1000</span><br></pre></td></tr></table></figure>
<p>ç„¶åè¿›å…¥ä¸‹è½½çš„æ–‡ä»¶å¤¹</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cd initializr</span><br></pre></td></tr></table></figure>
<p>æ‰§è¡Œæ„å»ºå‘½ä»¤ï¼Œè¿™ä¸€å—å¯èƒ½ä¼šå¾ˆæ…¢ï¼Œåæ­£æˆ‘èŠ±äº†å¥½ä¹…</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">.&#x2F;mvnw clean install</span><br></pre></td></tr></table></figure>
<p>ä¹‹åè¿›å…¥initializr-serviceæ–‡ä»¶å¤¹ï¼Œå¹¶æ‰§è¡Œ</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cd initializr-service</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">..&#x2F;mvnw package</span><br></pre></td></tr></table></figure>
<p>æ„å»ºæˆåŠŸåä¼šåœ¨initializr-serviceæ–‡ä»¶å¤¹ä¸­ç”Ÿæˆä¸€ä¸ªtargetæ–‡ä»¶å¤¹ï¼Œè¿›å…¥targetæ–‡ä»¶å¤¹ï¼Œåœ¨è¿™é‡Œæˆ‘æŒ‡å®šäº†ç«¯å£å·ä¸º8082ï¼Œå½“ç„¶è‡ªå·±å¯ä»¥æ ¹æ®éœ€è¦ä¿®æ”¹ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cd target</span><br><span class="line">nohup java -jar initializr-service.jar --server.port&#x3D;8082</span><br></pre></td></tr></table></figure>
<hr>
<p>æœ€ååœ¨è¿›è¡Œspringbootåˆå§‹åŒ–æ—¶é€‰æ‹©customï¼Œç„¶åæŠŠä½ çš„<code>http://ip:port</code>è¾“å…¥å°±å¯ã€‚</p>
]]></content>
      <categories>
        <category>Java</category>
      </categories>
      <tags>
        <tag>springboot</tag>
      </tags>
  </entry>
  <entry>
    <title>springbooté›†ç¾¤ä½“ç³»æ¶æ„å…¥é—¨</title>
    <url>/posts/895833a0.html</url>
    <content><![CDATA[<p><a href="https://zaomianbao.com/blog/2018/08/22/10" target="_blank" rel="noopener">springbootä½“ç³»ç»“æ„</a></p>
]]></content>
      <categories>
        <category>Java</category>
      </categories>
      <tags>
        <tag>springboot</tag>
        <tag>é«˜å¹¶å‘</tag>
      </tags>
  </entry>
  <entry>
    <title>è™šæ‹Ÿæœºå®‰è£…å¤šä¸ªcentos7è¿›è¡Œé›†ç¾¤</title>
    <url>/posts/a9664e3.html</url>
    <content><![CDATA[<h4 id="1-è™šæ‹Ÿæœºé•œåƒçš„é€‰æ‹©">1 è™šæ‹Ÿæœºé•œåƒçš„é€‰æ‹©</h4>
<p>åšé¡¹ç›®æ—¶éœ€è¦è€ƒè™‘é«˜å¹¶å‘åœºæ™¯ï¼Œæœ€å…ˆæƒ³åˆ°çš„å°±æ˜¯æ­å»ºä¸€ä¸ªé›†ç¾¤è¿›è¡Œè´Ÿè½½å‡è¡¡ï¼Œæœ¬æ¥æƒ³ç›´æ¥åœ¨æœåŠ¡å™¨ä¸Šè¿›è¡Œè¯•éªŒï¼Œåæ¥å‘ç°è¦å¤šå°æœåŠ¡å™¨è€Œä¸”é›†ç¾¤è²Œä¼¼éœ€è¦åœ¨å†…ç½‘æ®µè¿›è¡Œï¼Œæ‰€ä»¥é€‰æ‹©äº†è™šæ‹Ÿæœºè¿›è¡Œé›†ç¾¤ã€‚å› ä¸ºç”µè„‘å†…å­˜æœ‰é™ï¼Œæ‰€ä»¥é€‰æ‹©äº†centos7æœ€å°é•œåƒè¿›è¡Œæ­å»ºï¼Œminimalç‰ˆæœ¬çš„iosé•œåƒï¼Œè¿™æ˜¯æˆ‘é€‰æ‹©çš„é•œåƒä¸‹è½½åœ°å€<a href="http://mirrors.aliyun.com/centos/7/isos/x86_64/" target="_blank" rel="noopener">Centos7ä¸‹è½½</a></p>
<p>æˆ‘è¿™é‡Œä½¿ç”¨äº†virtualBoxä½œä¸ºæˆ‘çš„è™šæ‹Ÿæœºè½¯ä»¶ï¼Œå› ä¸ºå®ƒç›¸æ¯”VMæ¶ˆè€—çš„èµ„æºæ›´å°‘ï¼Œå®‰è£…è¿‡ç¨‹å°±ä¸è¯¦ç»†å±•è¿°äº†ï¼Œè¿™é‡Œè¦æ³¨æ„çš„æ˜¯ç½‘ç»œçš„é€‰æ‹©ï¼Œéœ€è¦é€‰æ‹©ä¸¤ä¸ªç½‘å¡ï¼š</p>
<p>NATâ€”ç”¨æ¥è¿æ¥å¤–ç½‘ï¼Œä¸‹è½½è½¯ä»¶(è¯¥é•œåƒæ˜¯æ²¡æœ‰ä»»ä½•ä¸œè¥¿çš„)</p>
<p>Host-Onlyâ€”ç”¨æ¥å’Œä¸»æœºè¿›è¡Œé€šä¿¡</p>
<a id="more"></a>
<h4 id="2-è™šæ‹Ÿæœºçš„é…ç½®">2 è™šæ‹Ÿæœºçš„é…ç½®</h4>
<p>centos minimalç³»ç»Ÿå®‰è£…å¥½åé»˜è®¤æ˜¯ä¸å¯åŠ¨ç½‘ç»œçš„ï¼Œæ— æ³•è®¿é—®å¤–ç½‘ï¼Œå¹¶ä¸”centos7 é»˜è®¤ä¸æ”¯æŒipconfigå‘½ä»¤ï¼Œé€šè¿‡ â€œip addrâ€è¿›è¡Œç½‘ç›˜ä¿¡æ¯æŸ¥è¯¢ï¼Œå¯ä»¥çœ‹åˆ°ä¸¤ä¸ªç½‘å¡åˆ†åˆ«å˜æˆäº†enp0s3å’Œenp0s8ã€‚</p>
<p>åœ¨è¿™é‡Œæ³¨æ„ä¸€ä¸‹ï¼Œç™»å½•çš„ç”¨æˆ·åæ˜¯rootã€‚</p>
<ul>
<li>
<p>å¼€å¯ç½‘ç»œè®¿é—®</p>
<p>é…ç½®æ–¹å¼ä¸ºå°†/etc/sysconfig/network-scripts/ifcfg-enp0s3æ–‡ä»¶ä»¥åŠifcfg-enp0s8çš„ONBOOT=no æ”¹ä¸º ONBOOT=yesã€‚</p>
<p>è¾“å…¥ä»¥ä¸‹å‘½ä»¤ä¹‹åå°±å¯ä»¥ä¸Šç½‘äº†ï¼Œè€Œä¸”å¯ä»¥ç›´æ¥ç”¨SSHè¿æ¥(å…ˆæŸ¥çœ‹æœ¬åœ°åœ°å€ï¼Œç„¶åä½¿ç”¨finalshellè¿›è¡Œè¿æ¥)</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">service network restart</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>å®‰è£…ifconfigåŠŸèƒ½ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yum install net-tools</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>å®‰è£…å…¶ä½™å¸¸ç”¨å·¥å…·</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yum install gcc gcc-c++ vim make gdb wget</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>é‡å‘½åenp0s3ä¸ºeth0</p>
<p>å¯¹/etc/default/grubæ–‡ä»¶è¿›è¡Œç¼–è¾‘ï¼Œå¹¶åœ¨GRUB_CMDLINE_LINUXçš„æœ€åï¼ŒåŠ ä¸Š net.ifnames=0 biosdevname=0 çš„å‚æ•°,ç„¶åä¾æ¬¡æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">grub2-mkconfig -o /boot/grub2/grub.cfg</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mv /etc/sysconfig/network-scripts/ifcfg-enp0s3 /etc/sysconfig/network-scripts/ifcfg-eth0</span><br></pre></td></tr></table></figure>
<p>æœ€årebootè¿›è¡Œé‡å¯</p>
</li>
</ul>
<h4 id="3-è®¾ç½®tomcatå¼€æœºè‡ªå¯">3 è®¾ç½®tomcatå¼€æœºè‡ªå¯</h4>
<p>æ€ä¹ˆå®‰è£…tomcatä»¥åŠjdkåœ¨è¿™é‡Œå°±ä¸å±•è¿°äº†ï¼Œç½‘ä¸Šæœ‰å¾ˆå¤šæ•™ç¨‹ï¼Œåœ¨è¿™é‡Œæˆ‘ç½—åˆ—ä¸€ç§å¼€æœºè‡ªå¯tomcatçš„æ–¹æ³•ï¼Œæˆ‘çš„</p>
<p>tomcatç›®å½•ä¸º<code>/root/down/apache-tomcat-8.5.45</code></p>
<p>JDKç›®å½•ä¸º<code>/root/down/jdk1.8.0_221/</code></p>
<p>1ã€ä¸ºTomcatæ·»åŠ å¯åŠ¨å‚æ•°</p>
<p>catalina.shåœ¨æ‰§è¡Œçš„æ—¶å€™ä¼šè°ƒç”¨åŒçº§è·¯å¾„ä¸‹çš„setenv.shæ¥è®¾ç½®é¢å¤–çš„ç¯å¢ƒå˜é‡ï¼Œå› æ­¤åœ¨<code>/root/down/apache-tomcat-8.5.45/bin</code>è·¯å¾„ä¸‹åˆ›å»ºsetenv.shæ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#JAVA_HOME </span></span><br><span class="line"><span class="built_in">export</span> JAVA_HOME=/root/down/jdk1.8.0_221/</span><br><span class="line"><span class="built_in">export</span> JRE_HOME=<span class="variable">$JAVA_HOME</span>/jre</span><br><span class="line"><span class="built_in">export</span> CLASSPATH=<span class="variable">$JAVA_HOME</span>/lib:<span class="variable">$JRE_HOME</span>/lib:<span class="variable">$CLASSPATH</span></span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$JAVA_HOME</span>/bin:<span class="variable">$JRE_HOME</span>/bin:<span class="variable">$PATH</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">export</span> CATALINA_HOME=/root/down/apache-tomcat-8.5.45</span><br><span class="line"><span class="built_in">export</span> CATALINA_BASE=/root/down/apache-tomcat-8.5.45</span><br><span class="line"><span class="comment"># è®¾ç½®Tomcatçš„PIDæ–‡ä»¶</span></span><br><span class="line">CATALINA_PID=<span class="string">"<span class="variable">$CATALINA_BASE</span>/tomcat.pid"</span></span><br><span class="line"><span class="comment"># æ·»åŠ JVMé€‰é¡¹</span></span><br><span class="line">JAVA_OPTS=<span class="string">"-server -XX:PermSize=256M -XX:MaxPermSize=1024m -Xms512M -Xmx1024M -XX:MaxNewSize=256m"</span></span><br></pre></td></tr></table></figure>
<p>2ã€åœ¨/usr/lib/systemd/systemè·¯å¾„ä¸‹æ·»åŠ tomcat.serviceæ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line">[Unit]</span><br><span class="line">Description=tomcat</span><br><span class="line">After=syslog.target network.target remote-fs.target nss-lookup.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">Type=forking</span><br><span class="line">PIDFile=<span class="regexp">/root/down</span><span class="regexp">/apache-tomcat-8.5.45/tomcat</span>.pid</span><br><span class="line">ExecStart=<span class="regexp">/root/down</span><span class="regexp">/apache-tomcat-8.5.45/bin</span><span class="regexp">/startup.sh</span></span><br><span class="line"><span class="regexp">ExecReload=/bin</span><span class="regexp">/kill -s HUP $MAINPID</span></span><br><span class="line"><span class="regexp">ExecStop=/bin</span><span class="regexp">/kill -s QUIT $MAINPID</span></span><br><span class="line"><span class="regexp">PrivateTmp=true</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">[Install]</span></span><br><span class="line"><span class="regexp">WantedBy=multi-user.target</span></span><br></pre></td></tr></table></figure>
<p>3ã€æŠŠtomcatåŠ å…¥å¼€æœºè‡ªå¯åŠ¨<br>
<code>systemctl enable tomcat.service</code></p>
<p>4ã€é‡å¯æœåŠ¡å™¨<br>
<code>reboot</code></p>
<p>5ã€å†æ¬¡è¿æ¥åï¼ŒæŸ¥çœ‹æœåŠ¡çŠ¶æ€<br>
<code>systemctl status tomcat.service</code></p>
<p>åœ¨è¿™é‡Œæœ‰ä¸ªå‘ï¼Œå°±æ˜¯æµè§ˆå™¨è®¿é—®æ—¶ä¼šä¸€ç›´è½¬åœˆï¼Œæˆ‘ä¼°è®¡æ˜¯æœºå™¨æ€§èƒ½çš„ç¼˜æ•…</p>
<p>å®‰è£…ä¸Šæ–‡çš„å‚è€ƒæ–‡ç« è¿›è¡Œå¤šä¸ªè™šæ‹Ÿæœºçš„æ­å»ºï¼Œç„¶åé…ç½®å¥½jdkå’Œtomcatï¼Œåœ¨è¿™é‡Œè¦æ³¨æ„çš„æ˜¯é˜²ç«å¢™çš„ä½¿ç”¨ï¼Œè™šæ‹Ÿæœºçš„è¯å¯ä»¥ç›´æ¥å…³é—­é˜²ç«å¢™</p>
<hr>
<p>1ã€firewalldçš„åŸºæœ¬ä½¿ç”¨<br>
å¯åŠ¨ï¼š systemctl start firewalld</p>
<p>æŸ¥çœ‹çŠ¶æ€ï¼š systemctl status firewalld / firewall-cmd --state è¿™ä¸ªå‘½ä»¤ä¹Ÿå¯ä»¥ï¼Œåªæ˜¯ä¿¡æ¯ä¼šç®€å•ç‚¹</p>
<p>åœæ­¢ï¼š systemctl disable firewalld</p>
<p>ç¦ç”¨ï¼š systemctl stop firewalld</p>
<p>æ€ä¹ˆå¼€å¯ä¸€ä¸ªç«¯å£</p>
<p>æ·»åŠ </p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">firewall-cmd --zone=public --add-port=8080/tcp --permanent  ï¼ˆ--permanentæ°¸ä¹…ç”Ÿæ•ˆï¼Œæ²¡æœ‰æ­¤å‚æ•°é‡å¯åå¤±æ•ˆï¼‰</span><br></pre></td></tr></table></figure>
<p>æ·»åŠ ç«¯å£å¤–éƒ¨è®¿é—®æƒé™ï¼ˆè¿™æ ·å¤–éƒ¨æ‰èƒ½è®¿é—®ï¼‰</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">firewall-cmd --add-port=8080/tcp</span><br></pre></td></tr></table></figure>
<p>é‡æ–°è½½å…¥ï¼Œæ·»åŠ ç«¯å£åé‡æ–°è½½å…¥æ‰èƒ½èµ·ä½œç”¨</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">firewall-cmd --reload</span><br></pre></td></tr></table></figure>
<p>è¿™äº›ä¹‹åï¼Œç«¯å£æ˜¯å¼€å¯æˆåŠŸçš„ï¼Œå¦‚æœæ²¡æœ‰æˆåŠŸï¼Œé‡å¯ç³»ç»Ÿè¯•è¯•ã€‚</p>
<p>æŸ¥çœ‹ç«¯å£</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">firewall-cmd --zone=public --query-port=80/tcp</span><br></pre></td></tr></table></figure>
<p>åˆ é™¤ç«¯å£</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">firewall-cmd --zone=public --remove-port=80/tcp --permanent</span><br></pre></td></tr></table></figure>
<p>æŸ¥çœ‹firewallæ˜¯å¦è¿è¡Œ,ä¸‹é¢ä¸¤ä¸ªå‘½ä»¤éƒ½å¯ä»¥</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">systemctl status firewalld</span><br><span class="line"></span><br><span class="line">firewall-cmd --state</span><br></pre></td></tr></table></figure>
<p>æŸ¥çœ‹å½“å‰å¼€äº†å“ªäº›ç«¯å£</p>
<p>å…¶å®ä¸€ä¸ªæœåŠ¡å¯¹åº”ä¸€ä¸ªç«¯å£ï¼Œæ¯ä¸ªæœåŠ¡å¯¹åº”/usr/lib/firewalld/servicesä¸‹é¢ä¸€ä¸ªxmlæ–‡ä»¶ã€‚</p>
<p>æŸ¥çœ‹å¼€å¯äº†å“ªäº›æœåŠ¡</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">firewall-cmd --list-services</span><br></pre></td></tr></table></figure>
<p>æŸ¥çœ‹å¼€å¯äº†å“ªäº›ç«¯å£</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">firewall-cmd --list-ports</span><br></pre></td></tr></table></figure>
<p>æŸ¥çœ‹è¿˜æœ‰å“ªäº›æœåŠ¡å¯ä»¥æ‰“å¼€</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">firewall-cmd --get-services</span><br></pre></td></tr></table></figure>
<p>æŸ¥çœ‹æ‰€æœ‰æ‰“å¼€çš„ç«¯å£ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">firewall-cmd --zone=public --list-ports</span><br></pre></td></tr></table></figure>
<p>æ›´æ–°é˜²ç«å¢™è§„åˆ™ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">firewall-cmd --reload</span><br></pre></td></tr></table></figure>
<h3 id="å‚è€ƒæ–‡ç« "><a href="https://blog.csdn.net/su83362368/article/details/78502545" target="_blank" rel="noopener">å‚è€ƒæ–‡ç« </a></h3>
]]></content>
      <tags>
        <tag>è™šæ‹Ÿæœº</tag>
        <tag>é«˜å¹¶å‘</tag>
      </tags>
  </entry>
  <entry>
    <title>Nginxçš„å…¥é—¨ä¸é…ç½®</title>
    <url>/posts/45652.html</url>
    <content><![CDATA[<h2 id="1Nginxç®€ä»‹">1	Nginxç®€ä»‹</h2>
<p>Nginxæ˜¯ä¸€æ¬¾è½»é‡çº§çš„WebæœåŠ¡å™¨ã€åå‘ä»£ç†æœåŠ¡å™¨ï¼Œç”±äºå®ƒçš„å†…å­˜å ç”¨å°‘ï¼Œå¯åŠ¨æå¿«ï¼Œé«˜å¹¶å‘èƒ½åŠ›å¼ºï¼Œåœ¨äº’è”ç½‘é¡¹ç›®ä¸­å¹¿æ³›åº”ç”¨ã€‚åœ¨å­¦ä¹ Nginxå‰ï¼Œé¦–å…ˆè¦æ˜ç¡®Nginxçš„ä¸€äº›ç‰¹ç‚¹ï¼ŒåŒ…æ‹¬</p>
<ul>
<li>åå‘ä»£ç†</li>
<li>è´Ÿè½½å‡è¡¡</li>
<li>åŠ¨é™åˆ†ç¦»</li>
</ul>
<p><img src="https://pic1.zhimg.com/v2-e1826bab1d07df8e97d61aa809b94a10_r.jpg" alt=""></p>
<p>ä¸Šå›¾åŸºæœ¬ä¸Šè¯´æ˜äº†å½“ä¸‹æµè¡Œçš„æŠ€æœ¯æ¶æ„ã€‚</p>
<a id="more"></a>
<h3 id="1-1-åå‘ä»£ç†">1.1 åå‘ä»£ç†</h3>
<p>å†è®²åå‘ä»£ç†ä¹‹å‰é¦–å…ˆè¦çŸ¥é“ä»€ä¹ˆå«æ­£å‘ä»£ç†ï¼Œæ­£å‘ä»£ç†ç›¸å½“äºå½“ä½ è¦è®¿é—®ä¸€ä¸ªèµ„æºæ—¶ï¼Œä½ éœ€è¦ä¸€ä¸ªä»£ç†æœåŠ¡å™¨è¿›è¡Œèµ„æºè®¿é—®</p>
<p><img src="https://pic4.zhimg.com/80/v2-c8ac111c267ae0745f984e326ef0c47f_hd.jpg" alt=""></p>
<p>åå‘ä»£ç†ï¼Œå®¢æˆ·ç«¯å¯¹ä»£ç†æ˜¯æ— æ„ŸçŸ¥çš„ï¼Œå› ä¸ºå®¢æˆ·ç«¯ä¸éœ€è¦ä»»ä½•é…ç½®å°±å¯ä»¥è®¿é—®ï¼Œæˆ‘ä»¬åªéœ€è¦å°†è¯·æ±‚å‘é€åˆ°åå‘ä»£ç†æœåŠ¡å™¨ï¼Œç”±åå‘ä»£ç†æœåŠ¡å™¨å»é€‰æ‹©ç›®æ ‡æœåŠ¡å™¨è·å–æ•°æ®åï¼Œåœ¨è¿”å›ç»™å®¢æˆ·ç«¯ï¼Œæ­¤æ—¶åå‘ä»£ç†æœåŠ¡å™¨å’Œç›®æ ‡æœåŠ¡å™¨å¯¹å¤–å°±æ˜¯ä¸€ä¸ªæœåŠ¡å™¨ï¼Œæš´éœ²çš„æ˜¯ä»£ç†æœåŠ¡å™¨çš„åœ°å€ï¼Œéšè—äº†çœŸå®æœåŠ¡å™¨çš„ip</p>
<p><img src="https://pic2.zhimg.com/80/v2-4787a512240b238ebf928cd0651e1d99_hd.jpg" alt=""></p>
<h3 id="1-2-è´Ÿè½½å‡è¡¡">1.2 è´Ÿè½½å‡è¡¡</h3>
<p>ç®€å•æ¥è¯´ï¼Œæˆ‘ä»¬å¢åŠ æœåŠ¡å™¨çš„æ•°é‡ï¼Œç„¶åå°†è¯·æ±‚åˆ†å‘åˆ°å„ä¸ªæœåŠ¡å™¨ä¸Šï¼Œå°†åŸå…ˆè¯·æ±‚é›†ä¸­åˆ°å•ä¸ªæœåŠ¡å™¨ä¸Šçš„æƒ…å†µæ”¹ä¸ºå°†è¯·æ±‚åˆ†å‘åˆ°å¤šä¸ªæœåŠ¡å™¨ä¸Šï¼Œå°†è´Ÿè½½åˆ†å‘åˆ°ä¸åŒçš„æœåŠ¡å™¨ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬æ‰€è¯´çš„è´Ÿè½½å‡è¡¡</p>
<h3 id="1-3-åŠ¨é™åˆ†ç¦»">1.3 åŠ¨é™åˆ†ç¦»</h3>
<p>è¿™ä¸ªä¹Ÿå¾ˆå¥½ç†è§£ï¼Œå°±æ˜¯è®²åŠ¨æ€èµ„æºå’Œé™æ€èµ„æºç›¸äº’åˆ†ç¦»ï¼ŒæŠŠåŠ¨æ€é¡µé¢å’Œé™æ€é¡µé¢ç”±ä¸åŒçš„æœåŠ¡å™¨æ¥è§£æï¼ŒåŠ å¿«è§£æé€Ÿåº¦ã€‚é™ä½åŸæ¥å•ä¸ªæœåŠ¡å™¨çš„å‹åŠ›ã€‚</p>
<h2 id="2-Nginxçš„å®‰è£…">2 Nginxçš„å®‰è£…</h2>
<p>è¿›å…¥å®˜ç½‘ä¸‹è½½http://nginx.org/ ,è¿™é‡Œè‡ªè¡Œæ›¿æ¢ç‰ˆæœ¬</p>
<p><code>pcre-8.37.tar.gz</code>    <code>openssl-1.0.1t.tar.gz</code>   <code>zlib-1.2.8.tar.gz</code>   <code>nginx-1.11.1.tar.gz</code></p>
<p>ç¬¬ä¸€æ­¥ï¼Œå®‰è£…pcre<br>
wget <a href="http://downloads.sourceforge.net/project/pcre/pcre/8.37/pcre-8.37.tar.gz" target="_blank" rel="noopener">http://downloads.sourceforge.net/project/pcre/pcre/8.37/pcre-8.37.tar.gz</a></p>
<p>ä¸‹è½½å®Œæˆåè¾“å…¥å‘½ä»¤è¿›è¡Œè§£å‹</p>
<p><code>tar -xvf pcre-8.37.tar.gz </code></p>
<p>åœ¨è¿™é‡Œæœ‰äº›ç³»ç»Ÿä¼šè‡ªå¸¦ï¼Œæ‰€ä»¥ä¸å®‰è£…ä¹Ÿæ²¡äº‹</p>
<p>./configure å®Œæˆåï¼Œå›åˆ° pcre ç›®å½•ä¸‹æ‰§è¡Œ<code>make</code>ï¼Œ</p>
<p>å†æ‰§è¡Œ<code>make install </code><br>
ç¬¬äºŒæ­¥ï¼Œå®‰è£…openssl<br>
ç¬¬ä¸‰æ­¥ï¼Œå®‰è£…zlib<br>
<code>yum -y install make zlib zlib-devel gcc-c++ libtool  openssl openssl-devel</code></p>
<p>æœ€åå®‰è£…Nginx</p>
<p><code>wget  http://nginx.org/download/nginx-1.16.1.tar.gz   </code></p>
<p>ä¹‹åè¿›è¡Œå’Œä¸Šè¿°ä¸€æ ·çš„æ“ä½œå°±è¡Œäº†ã€‚</p>
<br/>
<br/>
<p><font color=red>éœ€è¦æ³¨æ„çš„æ˜¯ç«¯å£çš„å¼€æ”¾</font></p>
<p>æŸ¥çœ‹å¼€æ”¾çš„ç«¯å£å· firewall-cmd --list-all</p>
<p>è®¾ç½®å¼€æ”¾çš„ç«¯å£å·<br>
firewall-cmd --add-service=http --permanent<br>
sudo firewall-cmd --add-port=80/tcp --permanent<br>
é‡å¯é˜²ç«å¢™<br>
firewall-cmd --reload</p>
<hr>
<p>å½“ç„¶Nginxå®‰è£…å¦‚æœä¸æƒ³è¿™ä¹ˆéº»çƒ¦ï¼Œå¯ä»¥ç›´æ¥åœ¨å®å¡”é¢æ¿è¿›è¡Œå¿«é€Ÿå®‰è£…(å‚»ç“œå¼å®‰è£…ï¼Œä¸è¿‡æˆ‘è£…äº†æœ‰ç‚¹é—®é¢˜ï¼ŒæŠ˜è…¾äº†å¥½ä¹…è¿˜æ˜¯é€‰æ‹©äº†å®‰è£…åŒ…å®‰è£…)</p>
<h2 id="3-Nginxå¸¸ç”¨å‘½ä»¤">3 Nginxå¸¸ç”¨å‘½ä»¤</h2>
<p><code>æŸ¥çœ‹ç‰ˆæœ¬å·</code></p>
<p>./nginx -v</p>
<p><code>å¯åŠ¨</code></p>
<p>åœ¨/usr/local/nginx/sbin ç›®å½•ä¸‹æ‰§è¡Œ ./nginx</p>
<p><code>å…³é—­</code></p>
<p>åœ¨/usr/local/nginx/sbin ç›®å½•ä¸‹æ‰§è¡Œ ./nginx -s  stop</p>
<p><code>é‡æ–°åŠ è½½</code></p>
<p>åœ¨/usr/local/nginx/sbin ç›®å½•ä¸‹æ‰§è¡Œ ./nginx -s  reload</p>
<h2 id="4-Nginxç‰¹ç‚¹è¯¦ç»†è¯´æ˜">4 Nginxç‰¹ç‚¹è¯¦ç»†è¯´æ˜</h2>
<h3 id="4-1-åå‘ä»£ç†">4.1 åå‘ä»£ç†</h3>
<p>é¦–å…ˆå‡†å¤‡ä¸¤å°tomcatæœåŠ¡å™¨ï¼Œä¿®æ”¹ç«¯å£å·(æœ‰ä¸‰å¤„éœ€è¦ä¿®æ”¹ï¼Œæ–‡ä»¶ä½ç½®åœ¨conf/server.xml)ï¼Œä¸€ä¸ªä¿®æ”¹æˆ8081ï¼Œå¦ä¸€ä¸ª8082ï¼Œç„¶ååˆ†åˆ«åœ¨Webappä¸­åˆ›å»ºæ–‡ä»¶å¤¹eduå’Œudpå¹¶åœ¨ç›®å½•ä¸‹åˆ›å»ºa.htmlï¼Œé‡Œé¢éšä¾¿å¯ä»¥å†™ä»»ä½•ä¸œè¥¿ã€‚ç„¶åä¿®æ”¹nginxçš„é…ç½®æ–‡ä»¶(æ–‡ä»¶ä½ç½®åœ¨/usr/local/nginx/conf/nginx.conf) serveréƒ¨åˆ†å¦‚ä¸‹ï¼Œæµè§ˆå™¨è¾“å…¥</p>
<p><code>æœåŠ¡å™¨ip/udp/a.html</code> åå°±ä¼šè‡ªåŠ¨è®¿é—®ï¼Œå¹¶ä¸éœ€è¦è¾“å…¥ç«¯å£å·ã€‚</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">location ~ /edu/ &#123;</span><br><span class="line">proxy_pass   http://127.0.0.1:8081;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">location ~ /udp/ &#123;</span><br><span class="line">proxy_pass   http://127.0.0.1:8082;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>locationæŒ‡ä»¤è¯­æ³•å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">location [ &#x3D; | ~ |~* |^~] uri&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>1ã€= ï¼šç”¨äºä¸å«æ­£åˆ™è¡¨è¾¾å¼çš„ uri å‰ï¼Œè¦æ±‚è¯·æ±‚å­—ç¬¦ä¸²ä¸ uri ä¸¥æ ¼åŒ¹é…ï¼Œå¦‚æœåŒ¹é…æˆåŠŸï¼Œå°±åœæ­¢ç»§ç»­å‘ä¸‹æœç´¢å¹¶ç«‹å³å¤„ç†è¯¥è¯·æ±‚ã€‚</p>
<p>2ã€~ï¼šç”¨äºè¡¨ç¤º uri åŒ…å«æ­£åˆ™è¡¨è¾¾å¼ï¼Œå¹¶ä¸”åŒºåˆ†å¤§å°å†™ã€‚</p>
<p>3ã€~*ï¼šç”¨äºè¡¨ç¤º uri åŒ…å«æ­£åˆ™è¡¨è¾¾å¼ï¼Œå¹¶ä¸”ä¸åŒºåˆ†å¤§å°å†™ã€‚</p>
<p>4ã€^~ï¼šç”¨äºä¸å«æ­£åˆ™è¡¨è¾¾å¼çš„ uri å‰ï¼Œè¦æ±‚ Nginx æœåŠ¡å™¨æ‰¾åˆ°æ ‡è¯† uri å’Œè¯·æ±‚å­—ç¬¦ä¸²åŒ¹é…åº¦æœ€é«˜çš„ location åï¼Œç«‹å³ä½¿ç”¨æ­¤ location å¤„ç†è¯·æ±‚ï¼Œè€Œä¸å†ä½¿ç”¨ location å—ä¸­çš„æ­£åˆ™ uri å’Œè¯·æ±‚å­—ç¬¦ä¸²åšåŒ¹é…ã€‚</p>
<p><font color=red>æ³¨æ„ï¼šå¦‚æœ uri åŒ…å«æ­£åˆ™è¡¨è¾¾å¼ï¼Œåˆ™å¿…é¡»è¦æœ‰ ~ æˆ–è€… ~* æ ‡è¯†ã€‚</font></p>
<h3 id="4-2-è´Ÿè½½å‡è¡¡">4.2 è´Ÿè½½å‡è¡¡</h3>
<p>è´Ÿè½½å‡è¡¡æŒ‡çš„æ˜¯å½“è®¿é—®ç›¸åŒè·¯å¾„çš„èµ„æºï¼ŒnginxæŒ‰ç…§è®¾ç½®å¥½çš„åˆ†é…ç­–ç•¥ï¼Œè‡ªåŠ¨è¿›è¡ŒæŸä¸€ä¸ªtomcatçš„è®¿é—®ï¼Œæ¯”å¦‚æˆ‘ç›´æ¥è¾“å…¥</p>
<p><code>æœåŠ¡å™¨ip/edu/a.html</code></p>
<p>æˆ‘æœåŠ¡å™¨ä¸­æœ‰ä¸¤å°tomcatå¹¶ä¸”åŒæ—¶æœ‰è·¯å¾„/edu/a.htmlï¼Œå½“è®¿é—®æ—¶ä¼šæŒ‰ç…§å›ºå®šåˆ†é…ç­–ç•¥é€‰æ‹©ä¸€å°tomcatè¿›è¡ŒæœåŠ¡ï¼Œè‹¥å…¶ä¸­ä¸€å°æŒ‚äº†ï¼Œå¦ä¸€å°è¿˜å¯ä»¥æ­£å¸¸å·¥ä½œã€‚</p>
<p>æˆ‘çš„nginxä¸€éƒ¨åˆ†é…ç½®å¦‚ä¸‹</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">http&#123;</span><br><span class="line">	...</span><br><span class="line">	<span class="comment">#è´Ÿè½½å‡è¡¡</span></span><br><span class="line">   upstream myserver &#123;</span><br><span class="line">    <span class="comment">#ip_hash</span></span><br><span class="line">server	æœåŠ¡å™¨ip:8081 weight=5;</span><br><span class="line">server	æœåŠ¡å™¨ip:8082 weight=10;</span><br><span class="line"><span class="comment">#fair  </span></span><br><span class="line">   &#125;</span><br><span class="line">...</span><br><span class="line">   server &#123;</span><br><span class="line">	<span class="comment">#listen       80;        #ç«¯å£</span></span><br><span class="line">       server_name  _;   <span class="comment">#æœåŠ¡å</span></span><br><span class="line"></span><br><span class="line">       charset utf-8,gbk;</span><br><span class="line">       root    /data/download;  <span class="comment">#æ˜¾ç¤ºçš„æ ¹ç´¢å¼•ç›®å½•</span></span><br><span class="line">       autoindex on;             <span class="comment">#å¼€å¯ç´¢å¼•åŠŸèƒ½</span></span><br><span class="line">       <span class="comment">#autoindex_exact_size off; # å…³é—­è®¡ç®—æ–‡ä»¶ç¡®åˆ‡å¤§å°ï¼ˆå•ä½bytesï¼‰ï¼Œåªæ˜¾ç¤ºå¤§æ¦‚å¤§å°ï¼ˆå•ä½kbã€mbã€gbï¼‰</span></span><br><span class="line">       <span class="comment">#autoindex_localtime on;   # æ˜¾ç¤ºæœ¬æœºæ—¶é—´è€Œé GMT æ—¶é—´</span></span><br><span class="line">   <span class="comment">#è´Ÿè½½å‡è¡¡</span></span><br><span class="line">       location / &#123;</span><br><span class="line">           proxy_pass   http://myserver;</span><br><span class="line">           root	html;</span><br><span class="line">           index	index.html	index.html;</span><br><span class="line">       &#125;</span><br><span class="line">       ...</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è€Œåˆ†é…ç­–ç•¥æœ‰ä»¥ä¸‹å‡ ç‚¹</p>
<p>1ã€è½®è¯¢ï¼ˆé»˜è®¤ï¼‰<br>
æ¯ä¸ªè¯·æ±‚æŒ‰æ—¶é—´é¡ºåºé€ä¸€åˆ†é…åˆ°ä¸åŒçš„åç«¯æœåŠ¡å™¨ï¼Œå¦‚æœåç«¯æœåŠ¡å™¨downæ‰ï¼Œèƒ½è‡ªåŠ¨å‰”é™¤ã€‚<br>
2ã€weight<br>
weightweight weightweightä»£è¡¨æƒ ä»£è¡¨æƒ ,é‡é»˜è®¤ä¸º é‡é»˜è®¤ä¸º é‡é»˜è®¤ä¸º 1, æƒé‡è¶Šé«˜è¢«åˆ†é…çš„å®¢æˆ·ç«¯å¤š æƒé‡è¶Šé«˜è¢«åˆ†é…çš„å®¢æˆ·ç«¯å¤š æƒé‡è¶Šé«˜è¢«åˆ†é…çš„å®¢æˆ·ç«¯å¤š æƒé‡è¶Šé«˜è¢«åˆ†é…çš„å®¢æˆ·ç«¯å¤š æƒé‡è¶Šé«˜è¢«åˆ†é…çš„å®¢æˆ·ç«¯å¤š æƒé‡è¶Šé«˜è¢«åˆ†é…çš„å®¢æˆ·ç«¯å¤š<br>
æŒ‡å®šè½®è¯¢å‡ ç‡ï¼Œweightå’Œè®¿é—®æ¯”ç‡æˆæ­£æ¯”ï¼Œç”¨äºåç«¯æœåŠ¡å™¨æ€§èƒ½ä¸å‡çš„æƒ…å†µ</p>
<p>3ã€ip_hash<br>
æ¯ä¸ªè¯·æ±‚æŒ‰è®¿é—®ipçš„hashç»“æœåˆ†é…ï¼Œè¿™æ ·æ¯ä¸ªè®¿å®¢å›ºå®šè®¿é—®ä¸€ä¸ªåç«¯æœåŠ¡å™¨ï¼Œå¯ä»¥è§£å†³sessionçš„é—®é¢˜ã€‚</p>
<p>4ã€fairï¼ˆç¬¬ä¸‰æ–¹ï¼‰<br>
æŒ‰åç«¯æœåŠ¡å™¨çš„å“åº”æ—¶é—´æ¥åˆ†é…è¯·æ±‚ï¼Œå“åº”æ—¶é—´çŸ­çš„ä¼˜å…ˆåˆ†é…ã€‚</p>
<h3 id="4-3-åŠ¨é™åˆ†ç¦»">4.3 åŠ¨é™åˆ†ç¦»</h3>
<p>é€šè¿‡ location æŒ‡å®šä¸åŒçš„åç¼€åå®ç°ä¸åŒçš„è¯·æ±‚è½¬å‘ã€‚é€šè¿‡ expires å‚æ•°è®¾ç½®ï¼Œå¯ä»¥ä½¿æµè§ˆå™¨ç¼“å­˜è¿‡æœŸæ—¶é—´ï¼Œå‡å°‘ä¸æœåŠ¡å™¨ä¹‹å‰çš„è¯·æ±‚å’Œæµé‡ã€‚å…·ä½“ Expires å®šä¹‰ï¼šæ˜¯ç»™ä¸€ä¸ªèµ„æºè®¾å®šä¸€ä¸ªè¿‡æœŸæ—¶é—´ï¼Œä¹Ÿå°±æ˜¯è¯´æ— éœ€å»æœåŠ¡ç«¯éªŒè¯ï¼Œç›´æ¥é€šè¿‡æµè§ˆå™¨è‡ªèº«ç¡®è®¤æ˜¯å¦è¿‡æœŸå³å¯ï¼Œæ‰€ä»¥ä¸ä¼šäº§ç”Ÿé¢å¤–çš„æµé‡ã€‚</p>
<p>æˆ‘åœ¨æˆ‘çš„æ–‡ä»¶å¤¹dataä¸‹åˆ†åˆ«åˆ›å»ºäº†wwwå’Œimageæ–‡ä»¶å¤¹ï¼Œé‡Œé¢åˆ†åˆ«å­˜æ”¾äº†å›¾ç‰‡å’Œä¸€ä¸ªhtmlï¼Œå½“æµè§ˆå™¨è®¿é—®æ—¶å°±ä¼šè‡ªåŠ¨å¯»æ‰¾å¯¹åº”çš„é™æ€èµ„æºï¼ˆexpireså‚æ•°ä¹Ÿå¯é…ç½®ï¼‰,éƒ¨åˆ†é…ç½®å¦‚ä¸‹</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">server&#123;</span><br><span class="line">	...</span><br><span class="line">		<span class="comment">#è´Ÿè½½å‡è¡¡</span></span><br><span class="line">		location / &#123;</span><br><span class="line">            proxy_pass   http://myserver;</span><br><span class="line">            root	html;</span><br><span class="line">            index	index.html	index.html;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">#åŠ¨é™åˆ†ç¦»</span></span><br><span class="line">		location /www/&#123;</span><br><span class="line">            root	/contest/data/;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        location /image/&#123;</span><br><span class="line">            root	/contest/data/;</span><br><span class="line">            <span class="comment">#åˆ—å‡ºå½“å‰æ–‡ä»¶å¤¹æ–‡ä»¶</span></span><br><span class="line">            autoindex on;</span><br><span class="line">        &#125;</span><br><span class="line">        ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="4-4-nginxå…¶ä»–æƒ…å†µ">4.4 nginxå…¶ä»–æƒ…å†µ</h3>
<p>ä½¿ç”¨Nginxåšä»£ç†çš„æ—¶å€™ï¼Œæœ‰æ—¶éœ€è¦æŠŠè¯·æ±‚åŸå°ä¸åŠ¨çš„è½¬å‘ç»™ä¸‹ä¸€ä¸ªæœåŠ¡ã€‚</p>
<p>æ¯”å¦‚ï¼Œ<a href="http://xn--shawn-6u8oj48c.com/test/a/b.html" target="_blank" rel="noopener">è®¿é—®shawn.com/test/a/b.html</a>, è¦æ±‚è½¬å‘åˆ°localhost:8088/test/a/b.html</p>
<p>ç®€å•é…ç½®å¦‚ä¸‹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">upstream one &#123;</span><br><span class="line">  server localhost:8088 weight=5;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">server &#123;</span><br><span class="line">    listen              80;</span><br><span class="line">    server_name         shawn.com;</span><br><span class="line">    access_log  <span class="string">"pipe:rollback /data/log/nginx/access.log interval=1d baknum=7 maxsize=1G"</span>  main;</span><br><span class="line"></span><br><span class="line">    location / &#123;</span><br><span class="line">        proxy_set_header Host <span class="variable">$host</span>;</span><br><span class="line">        proxy_set_header  X-Real-IP        <span class="variable">$remote_addr</span>;</span><br><span class="line">        proxy_set_header  X-Forwarded-For  <span class="variable">$proxy_add_x_forwarded_for</span>;</span><br><span class="line">        proxy_set_header X-NginX-Proxy <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">        proxy_pass http://one;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å³ï¼Œè®¾ç½®<code>proxy_pass</code>å³å¯ã€‚è¯·æ±‚åªä¼šæ›¿æ¢åŸŸåã€‚</p>
<p>ä½†å¾ˆå¤šæ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦æ ¹æ®urlçš„å‰ç¼€è½¬å‘åˆ°ä¸åŒçš„æœåŠ¡ã€‚</p>
<p>æ¯”å¦‚</p>
<p><a href="http://shawn.com/user/profile.html%E8%BD%AC%E5%8F%91%E5%88%B0" target="_blank" rel="noopener">shawn.com/user/profile.htmlè½¬å‘åˆ°</a> <strong>ç”¨æˆ·æœåŠ¡</strong>localhost:8089/profile.html</p>
<p><a href="http://shawn.com/order/details.html%E8%BD%AC%E5%8F%91%E5%88%B0" target="_blank" rel="noopener">shawn.com/order/details.htmlè½¬å‘åˆ°</a> <strong>è®¢å•æœåŠ¡</strong> localhost:8090/details.html</p>
<p>å³ï¼Œurlçš„å‰ç¼€å¯¹ä¸‹æ¸¸çš„æœåŠ¡æ˜¯ä¸éœ€è¦çš„ï¼Œé™¤éä¸‹æ¸¸æœåŠ¡æ·»åŠ context-path, ä½†å¾ˆå¤šæ—¶å€™æˆ‘ä»¬å¹¶ä¸å–œæ¬¢åŠ è¿™ä¸ªã€‚å¦‚æœNginxè½¬å‘çš„æ—¶å€™ï¼ŒæŠŠè¿™ä¸ªå‰ç¼€å»æ‰å°±å¥½äº†ã€‚</p>
<p><strong>ä¸€ä¸ªç§æ–¹æ¡ˆæ˜¯proxy_passåé¢åŠ æ ¹è·¯å¾„<code>/</code>.</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen              80;</span><br><span class="line">    server_name         shawn.com;</span><br><span class="line">    access_log  <span class="string">"pipe:rollback /data/log/nginx/access.log interval=1d baknum=7 maxsize=1G"</span>  main;</span><br><span class="line"></span><br><span class="line">    location ^~/user/ &#123;</span><br><span class="line">        proxy_set_header Host <span class="variable">$host</span>;</span><br><span class="line">        proxy_set_header  X-Real-IP        <span class="variable">$remote_addr</span>;</span><br><span class="line">        proxy_set_header  X-Forwarded-For  <span class="variable">$proxy_add_x_forwarded_for</span>;</span><br><span class="line">        proxy_set_header X-NginX-Proxy <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">        proxy_pass http://user/;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    location ^~/order/ &#123;</span><br><span class="line">        proxy_set_header Host <span class="variable">$host</span>;</span><br><span class="line">        proxy_set_header  X-Real-IP        <span class="variable">$remote_addr</span>;</span><br><span class="line">        proxy_set_header  X-Forwarded-For  <span class="variable">$proxy_add_x_forwarded_for</span>;</span><br><span class="line">        proxy_set_header X-NginX-Proxy <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">        proxy_pass http://order/;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>^~/user/</code>è¡¨ç¤ºåŒ¹é…å‰ç¼€æ˜¯<code>user</code>çš„è¯·æ±‚ï¼Œproxy_passçš„ç»“å°¾æœ‰<code>/</code>ï¼Œ åˆ™ä¼šæŠŠ<code>/user/*</code>åé¢çš„è·¯å¾„ç›´æ¥æ‹¼æ¥åˆ°åé¢ï¼Œå³ç§»é™¤user.</p>
<p><strong>å¦ä¸€ç§æ–¹æ¡ˆæ˜¯ä½¿ç”¨<code>rewrite</code></strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">upstream user &#123;</span><br><span class="line">  server localhost:8089 weight=5;</span><br><span class="line">&#125;</span><br><span class="line">upstream order &#123;</span><br><span class="line">  server localhost:8090 weight=5;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">server &#123;</span><br><span class="line">    listen              80;</span><br><span class="line">    server_name         abc.com;</span><br><span class="line">    access_log  <span class="string">"pipe:rollback /data/log/nginx/access.log interval=1d baknum=7 maxsize=1G"</span>  main;</span><br><span class="line"></span><br><span class="line">    location ^~/user/ &#123;</span><br><span class="line">        proxy_set_header Host <span class="variable">$host</span>;</span><br><span class="line">        proxy_set_header  X-Real-IP        <span class="variable">$remote_addr</span>;</span><br><span class="line">        proxy_set_header  X-Forwarded-For  <span class="variable">$proxy_add_x_forwarded_for</span>;</span><br><span class="line">        proxy_set_header X-NginX-Proxy <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">        rewrite ^/user/(.*)$ /<span class="variable">$1</span> <span class="built_in">break</span>;</span><br><span class="line">        proxy_pass http://user;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    location ^~/order/ &#123;</span><br><span class="line">        proxy_set_header Host <span class="variable">$host</span>;</span><br><span class="line">        proxy_set_header  X-Real-IP        <span class="variable">$remote_addr</span>;</span><br><span class="line">        proxy_set_header  X-Forwarded-For  <span class="variable">$proxy_add_x_forwarded_for</span>;</span><br><span class="line">        proxy_set_header X-NginX-Proxy <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">        rewrite ^/order/(.*)$ /<span class="variable">$1</span> <span class="built_in">break</span>;</span><br><span class="line">        proxy_pass http://order;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ³¨æ„åˆ°proxy_passç»“å°¾æ²¡æœ‰<code>/</code>ï¼Œ <code>rewrite</code>é‡å†™äº†urlã€‚</p>
<p><strong>aliasä¸rootçš„åŒºåˆ«</strong></p>
<blockquote>
<p>root å®é™…è®¿é—®æ–‡ä»¶è·¯å¾„ä¼šæ‹¼æ¥URLä¸­çš„è·¯å¾„<br>
alias å®é™…è®¿é—®æ–‡ä»¶è·¯å¾„ä¸ä¼šæ‹¼æ¥URLä¸­çš„è·¯å¾„</p>
</blockquote>
<p><strong>last å’Œ breakå…³é”®å­—çš„åŒºåˆ«</strong></p>
<blockquote>
<p>åªç”¨åˆ°äº†breakï¼Œå³åŒ¹é…åˆ°æ­¤å¤„åä¸ä¼šç»§ç»­è·³ã€‚</p>
</blockquote>
<p><strong>permanent å’Œ redirectå…³é”®å­—çš„åŒºåˆ«</strong></p>
<blockquote>
<p>rewrite â€¦ permanent æ°¸ä¹…æ€§é‡å®šå‘ï¼Œè¯·æ±‚æ—¥å¿—ä¸­çš„çŠ¶æ€ç ä¸º301</p>
<p>rewrite â€¦ redirect ä¸´æ—¶é‡å®šå‘ï¼Œè¯·æ±‚æ—¥å¿—ä¸­çš„çŠ¶æ€ç ä¸º302</p>
</blockquote>
<h2 id="5-Nginxé…ç½®é«˜å¯ç”¨é›†ç¾¤">5 Nginxé…ç½®é«˜å¯ç”¨é›†ç¾¤</h2>
<p><a href="https://imgchr.com/i/lfxtfO" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2020/01/10/lfxtfO.jpg" alt="lfxtfO.jpg"></a></p>
<p>åŸç†å¦‚ä¸Šï¼Œç›¸ä¿¡å¤§å®¶çš„æ°´å¹³åº”è¯¥éƒ½èƒ½çœ‹æ‡‚ï¼Œåœ¨é…ç½®æ—¶éœ€è¦ä¸€äº›å‡†å¤‡å·¥ä½œ</p>
<ol>
<li>ä¸¤å°æœåŠ¡å™¨</li>
<li>ä¸¤å°æœåŠ¡å™¨éƒ½éœ€è¦å®‰è£…å¥½Nginx</li>
<li>ä¸¤å°æœåŠ¡å™¨éœ€è¦å®‰è£…keepalived</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#å®‰è£…å‘½ä»¤</span></span><br><span class="line">yum install keepalived -y</span><br><span class="line"><span class="comment">#æ£€æŸ¥æ˜¯å¦å®‰è£…å¥½</span></span><br><span class="line">rpm -q -a keepalived</span><br></pre></td></tr></table></figure>
<p>å®‰è£…å®‰æˆååœ¨/etc/keepalivedä¸‹æœ‰é…ç½®æ–‡ä»¶ï¼ŒåŸç†è¯¦çœ‹<a href="https://baike.baidu.com/item/Keepalived/10346758?fr=aladdin" target="_blank" rel="noopener">keepalivedåŸç†</a></p>
<h5 id="ä¸»ä»é…ç½®-è¿˜æœ‰åŒä¸»æ¨¡å¼è‡ªè¡Œå­¦ä¹ ">ä¸»ä»é…ç½®(è¿˜æœ‰åŒä¸»æ¨¡å¼è‡ªè¡Œå­¦ä¹ )</h5>
<p><img src="https://s2.ax1x.com/2020/01/10/lfx1mR.jpg" alt="lfx1mR.jpg"></p>
<p>1ã€ä¿®æ”¹keepalivedé…ç½®æ–‡ä»¶</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">global_defs &#123;</span><br><span class="line">   ...</span><br><span class="line">   <span class="comment">#åœ¨/etc/hostsä¸­ä¿®æ”¹</span></span><br><span class="line">   router_id LVS_DEVEL    <span class="comment">#ä¸»æœºåå­—</span></span><br><span class="line">   ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">#æ£€æµ‹è„šæœ¬å’Œæƒé‡å‚æ•°</span></span><br><span class="line">vrrp_script chk_http_port &#123;</span><br><span class="line">	script <span class="string">"/usr/local/src/nginx_check.sh"</span></span><br><span class="line">	interval 2   <span class="comment">#æ£€æµ‹é—´éš”</span></span><br><span class="line">	weight -2	<span class="comment">#æƒé‡</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">#è™šæ‹ŸIPé…ç½®</span></span><br><span class="line">vrrp_instance VI_1 &#123;</span><br><span class="line">    state MASTER       <span class="comment">#å¤‡ä»½æ”¹æˆBACKUP</span></span><br><span class="line">    interface eth0			<span class="comment">#ç½‘å¡  ifconfigå¯ä»¥æŸ¥çœ‹</span></span><br><span class="line">    virtual_router_id 51    <span class="comment">#ä¸»å¤‡æœºå¿…é¡»ç›¸åŒ</span></span><br><span class="line">    priority 100      <span class="comment">#ä¼˜å…ˆçº§ ä¸»æœºè¾ƒå¤§ï¼Œå¤‡ä»½æœºè¾ƒå°</span></span><br><span class="line">    advert_int 1		<span class="comment">#å¿ƒè·³åŒ…é—´éš”</span></span><br><span class="line">    authentication &#123;     <span class="comment">#æ ¡éªŒæ–¹å¼</span></span><br><span class="line">        auth_type PASS</span><br><span class="line">        auth_pass 1111</span><br><span class="line">    &#125;</span><br><span class="line">    virtual_ipaddress &#123;		<span class="comment">#å¯ä»¥ç»‘å®šå¤šä¸ªè™šæ‹Ÿip</span></span><br><span class="line">       åœ¨è¿™é‡Œæ·»åŠ è™šæ‹Ÿipåœ°å€</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>2ã€åœ¨/usr/local/srcæ·»åŠ æ£€æµ‹è„šæœ¬</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line">A=`ps -C nginx â€“no-header |wc -l` </span><br><span class="line"><span class="keyword">if</span> [ <span class="variable">$A</span> -eq 0 ];<span class="keyword">then</span></span><br><span class="line">	/usr/<span class="built_in">local</span>/nginx/sbin/nginx</span><br><span class="line">	sleep 2</span><br><span class="line">	<span class="keyword">if</span> [ `ps -C nginx --no-header |wc -l` -eq 0 	];<span class="keyword">then</span></span><br><span class="line">		killall keepalived</span><br><span class="line">	<span class="keyword">fi</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>
<p>3ã€å¯åŠ¨ä¸¤å°æœåŠ¡å™¨çš„nginxå’Œkeepalivedï¼Œå…¶ä¸­å¤‡ä»½æœºçš„keepalivedé…ç½®éœ€è¦ç®€å•ä¿®æ”¹ï¼Œæ ¹æ®æ³¨é‡Šåº”è¯¥èƒ½çœ‹æ‡‚äº†ã€‚</p>
<p><font color=red>æ³¨æ„ï¼škeepalivedä¸€èˆ¬æ˜¯åœ¨å†…ç½‘æ®µè¿›è¡Œï¼Œè¦å…¬ç½‘æœåŠ¡å™¨è¿›è¡Œçš„è¯ï¼Œéœ€è¦è‡³å°‘ä¸‰ä¸ªå…¬ç½‘ip</font>ï¼ˆç°é˜¶æ®µæ²¡è¿™ä¹ˆå¤šèµ„é‡‘äºæ˜¯å°±æ²¡è¯•éªŒäº†ï¼‰ï¼Œè¿˜æœ‰å¦‚æœæ˜¯è™šæ‹Ÿæœºè¿›è¡Œè¯•éªŒçš„è¯é˜²ç«å¢™éœ€è¦æ³¨æ„</p>
<h2 id="6-Nginxçš„åŸç†">6 Nginxçš„åŸç†</h2>
<p><img src="https://s2.ax1x.com/2020/01/10/lfxJk6.jpg" alt="lfxJk6.jpg"></p>
<p>å¤šä¸ªworkerå¯ä»¥è¿›è¡Œçƒ­éƒ¨ç½²ï¼Œè€Œä¸”æé«˜äº†æœåŠ¡çš„å¯é æ€§ï¼Œå¦å¤–workeræ•°ä¸€èˆ¬å’Œcpuæ ¸å¿ƒæ•°ç›¸ç­‰ï¼Œè¿™æ ·èƒ½æœ€å¤§é™åº¦å‘æŒ¥æ€§èƒ½ã€‚å¯¹äºè¿æ¥æ•°worker_connectionï¼Œè®¿é—®é™æ€èµ„æºå ç”¨2ä¸ª(è¯·æ±‚å’Œè¿”å›)ï¼ŒåŠ¨æ€èµ„æºå ç”¨4ä¸ª(å¦å¤–å†åŠ ä¸Štomcatçš„è¯·æ±‚)ã€‚</p>
<p><br/>å‚è€ƒï¼š</p>
<p><a href="https://www.cnblogs.com/woshimrf/p/nginx-config-location.html" target="_blank" rel="noopener">https://www.cnblogs.com/woshimrf/p/nginx-config-location.html</a></p>
<p><a href="http://www.gulixueyuan.com/my/course/332" target="_blank" rel="noopener">å°šç¡…è°·nginxå­¦ä¹ è§†é¢‘</a></p>
<br/>]]></content>
      <categories>
        <category>Java</category>
      </categories>
      <tags>
        <tag>é«˜å¹¶å‘</tag>
        <tag>Nginx</tag>
      </tags>
  </entry>
  <entry>
    <title>githubPageå’Œhexoè¿›è¡Œä¸ªäººåšå®¢æ­å»º</title>
    <url>/posts/1f66eb4d.html</url>
    <content><![CDATA[<p>å‚è€ƒå¦‚ä¸‹</p>
<h4 id="åšå®¢æ­å»º"><a href="https://blog.csdn.net/sinat_37781304/article/details/82729029" target="_blank" rel="noopener">åšå®¢æ­å»º</a></h4>
<h4 id="åšå®¢æ­å»º-v2"><a href="https://blog.csdn.net/qq_37513473/article/details/88617281" target="_blank" rel="noopener">åšå®¢æ­å»º</a></h4>
<h4 id="åšå®¢ç¾åŒ–"><a href="http://xxty.fun/2019/08/14/hexo%E5%8D%9A%E5%AE%A2%EF%BC%9Ayilia%E4%B8%BB%E9%A2%98%E7%BE%8E%E5%8C%96/" target="_blank" rel="noopener">åšå®¢ç¾åŒ–</a></h4>
<hr>
<p>å¦å¤–å› ä¸ºyiliaé»˜è®¤çš„æ–‡ç« æœç´¢æ˜¯æŒ‰ç…§/å¹´/æœˆ/æ—¥/æ–‡ç«  æ¥è¿›è¡Œæœç´¢çš„ï¼Œè¿™ç§æœç´¢æ–¹å¼ä¸åˆ©äºè¢«æ£€ç´¢åˆ°ï¼Œè€Œä¸”å½“é¢˜ç›®æ˜¯ä¸­æ–‡çš„æ—¶å€™ï¼Œä¸­æ–‡ä¼šå˜æˆå¾ˆé•¿çš„ç¼–ç ï¼Œçœ‹èµ·æ¥ä¹Ÿå¾ˆä¸çˆ½ï¼Œåœ¨ç½‘ä¸Šæ‰¾äº†å¾ˆä¹…ï¼Œæœ€ç»ˆé‡‡ç”¨<code>hexo-abbrlink</code>è¿™ä¸ªæ’ä»¶ï¼Œä¸‹é¢ç®€å•è¯´ä¸€ä¸‹å®‰è£…æ­¥éª¤ï¼Œå› ä¸ºç½‘ä¸Šè¯´çš„è¿˜æ˜¯æœ‰äº›å‘</p>
<br/>
<a id="more"></a>
<p>é¦–å…ˆå®‰è£…æ’ä»¶ï¼Œåœ¨æ ¹ç›®å½•ä¸‹å®‰è£…</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install hexo-abbrlink --save</span><br></pre></td></tr></table></figure>
<p>ç„¶åé…ç½®æ ¹ç›®å½•çš„_config.ymlï¼Œæ‰¾åˆ°ä»¥ä¸‹æ–‡ä»¶å¹¶ä¿®æ”¹</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">permalink: post/:abbrlink.html     <span class="comment"># æ­¤å¤„å¯ä»¥è‡ªå·±è®¾ç½®ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨ :/abbrlink</span></span><br><span class="line">abbrlink:  </span><br><span class="line">	alg: crc32  <span class="comment"># ç®—æ³•ï¼šcrc16(default) and crc32  </span></span><br><span class="line">	rep: hex    <span class="comment"># è¿›åˆ¶ï¼šdec(default) and hex</span></span><br></pre></td></tr></table></figure>
<p>åœ¨è¿™é‡Œæˆ‘è¦è¯´ä¸€è¯´æ³¨æ„å†’å·ï¼Œä¸å†™çš„è¯å°±ä¸ä¼šè¿›è¡ŒåŒ¹é…äº†ï¼Œè¿˜æœ‰å¦‚æœä¸æƒ³æŠŠæ–‡ç« éƒ½å‘åˆ°æ ¹ç›®å½•ä¸‹ï¼Œä¹Ÿå°±æ˜¯åƒæˆ‘ä¸€æ ·æœ‰ä¸ªpostsæ–‡ä»¶å¤¹çš„è¯ï¼Œé¦–å…ˆè¦è¿›è¡Œæ–‡ä»¶ç›®å½•çš„åˆ›å»ºï¼Œå³</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hexo new page posts</span><br></pre></td></tr></table></figure>
<p>ç„¶ååˆ é™¤index.mdæ–‡ä»¶ï¼Œæœ€åè¿›è¡Œæ¸…é™¤å’Œæ„å»ºï¼Œæ¯ç¯‡æ–‡ç« å°±ä¼šè‡ªåŠ¨æ„å»ºä¸€ä¸ªabbrlinkï¼Œè¿™æ ·å°±å¯ä»¥æŒ‰ç…§                <code>ä½ çš„åŸŸå/posts/xxx.html</code>è¿›è¡Œè®¿é—®äº†</p>
<p>å¦å¤–è¿™ç¯‡ç¾åŒ–hexoçš„å¾ˆä¸é”™</p>
<p><a href="http://yansheng836.coding.me/article/e9d1b881.html" target="_blank" rel="noopener">é«˜çº§yiliaç¾åŒ–</a></p>
]]></content>
      <categories>
        <category>hexoçš„æ­å»ºå’Œç¾åŒ–</category>
      </categories>
      <tags>
        <tag>åšå®¢</tag>
      </tags>
  </entry>
  <entry>
    <title>Hello World</title>
    <url>/posts/4a17b156.html</url>
    <content><![CDATA[<p>Welcome to <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="noopener">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="noopener">GitHub</a>.</p>
<h2 id="Quick-Start">Quick Start</h2>
<h3 id="Create-a-new-post">Create a new post</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p>
<h3 id="Run-server">Run server</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></p>
<h3 id="Generate-static-files">Generate static files</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></p>
<h3 id="Deploy-to-remote-sites">Deploy to remote sites</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/one-command-deployment.html" target="_blank" rel="noopener">Deployment</a></p>
]]></content>
  </entry>
</search>
